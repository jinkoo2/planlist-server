(this["webpackJsonpplanq-client1"]=this["webpackJsonpplanq-client1"]||[]).push([[0],{136:function(e,t,a){e.exports=a(164)},141:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){},149:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},153:function(e,t,a){},154:function(e,t,a){},155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){},164:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(12),r=a.n(o),c=(a(141),a(32)),i=a(13),s=a(14),u=a(65),m=a(60),p=a(66),d=(a(142),a(21)),f=a(6),h=a(201),g=a(4),_=a(206),E=a(207),v=a(57),b=a(208),k=a(109),y=a(102),C=a.n(y),j=a(219),w=a(237),O=a(204),N=a(36),S=a.n(N),D=a(211),P=a(165),x=a(209),M=a(212),A=a(92),I=a.n(A),L=a(210),Y=a(23),q=a(231),U=a(63),T=(a(143),Object(h.a)((function(e){return{root:{},menuButton:{marginRight:2},textField_DateTime:{marginLeft:1,marginRight:1,width:180,textAlign:"center",color:"white"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}))),R=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function Q(e){return e instanceof Date&&!isNaN(e)}function F(e){var t=T(),a=e.filter,n=e.handleClose,o=l.a.useState(a.newstart_from),r=Object(f.a)(o,2),c=r[0],i=r[1],s=l.a.useState(a.newstart_to),u=Object(f.a)(s,2),m=u[0],p=u[1],d=l.a.useState(a.keyword),h=Object(f.a)(d,2),g=h[0],y=(h[1],function(){n(null)});return l.a.createElement(Y.a,{utils:U.a},l.a.createElement(w.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:R},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:y,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Filters"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){n({newstart_from:c,newstart_to:m,keyword:g})}},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:y},"Close"))),l.a.createElement(x.a,null,l.a.createElement(P.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(D.a,{primary:"New Start From"}),l.a.createElement(M.a,null,l.a.createElement(q.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_from",value:c,onChange:function(e){Q(e)?i(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(j.a,null),l.a.createElement(P.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(D.a,{primary:"New Start To"}),l.a.createElement(M.a,null,l.a.createElement(q.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_to",value:m,onChange:function(e){Q(e)?p(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(j.a,null))))}var B=a(27),H=a.n(B),z=a(41),W=a(85),G=a.n(W),J=["SUN","MON","TUE","WED","THR","FRI","SAT"];function V(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var Z=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"MM_DD_YYYY",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)}},{key:"MM_DD",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2);return"".concat(t,"/").concat(a)}},{key:"MM_DD_DAY",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2),n=J[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")}},{key:"HH_MM_AMPM",value:function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)}},{key:"HH_MM",value:function(e){var t=V(e.getHours(),2),a=V(e.getMinutes(),2);return"".concat(t,":").concat(a)}},{key:"YYYY_MM_DD",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)}},{key:"YYYY_MM_DDTHH_MM",value:function(e){return this.YYYY_MM_DD(e)+"T"+this.HH_MM(e)}}]),e}(),K=(a(149),["SUN","MON","TUE","WED","THR","FRI","SAT"]);function $(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var X=function e(){var t=this;Object(i.a)(this,e),this.MM_DD_YYYY=function(e){var t=e.getFullYear(),a=$(e.getMonth()+1,2),n=$(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)},this.MM_DD=function(e){var t=$(e.getMonth()+1,2),a=$(e.getDate(),2);return"".concat(t,"/").concat(a)},this.MM_DD_DAY=function(e){var t=$(e.getMonth()+1,2),a=$(e.getDate(),2),n=K[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")},this.HH_MM_AMPM=function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)},this.HH_MM=function(e){var t=$(e.getHours(),2),a=$(e.getMinutes(),2);return"".concat(t,":").concat(a)},this.YYYY_MM_DD=function(e){var t=e.getFullYear(),a=$(e.getMonth()+1,2),n=$(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)},this.YYYY_MM_DDTHH_MM=function(e){return t.YYYY_MM_DD(e)+"T"+t.HH_MM(e)}};a(150);function ee(e){var t=new X,a=e.txItem,n=t.MM_DD_DAY(new Date(a.ScheduledStartTime));return l.a.createElement("div",{className:"tx-item"},l.a.createElement("div",{className:"tx-start-time"},n),l.a.createElement("div",{className:"tx-activity-code"},a.ActivityCode),l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",id:"vehicle1",name:"vehicle1",onChange:function(t){console.dir(t.target),e.selectionChange(a,t.target.checked)}})))}var te=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"log",value:function(e,t){console.log(e,t)}},{key:"log",value:function(e){console.log(e)}}]),e}(),ae=a(238),ne="https://uhmc-ro-1502.uhmc.sbuh.stonybrook.edu:1005/api",le="UHMC",oe=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/aria/scheduled_activities",this.token=t}return Object(s.a)(e,[{key:"getScheduledActivitiesPerResourceSer",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerResourceSer/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}},{key:"getAllScheduledActivitiesPerPatientId",value:function(e){var t="".concat(this.url,"/ScheduledActivitiesPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}},{key:"getScheduledActivitiesPerPatientId",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerPatientId/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}}]),e}(),re=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),ce=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function ie(e){te.log("ScheduledActivityList()");var t=re(),a=e.open,o=e.handleClose,r=e.user,c=e.simItem,i=l.a.useState([]),s=Object(f.a)(i,2),u=s[0],m=s[1],p=function(){var t=Object(z.a)(H.a.mark((function t(a,n){var l,o,c,i,s,u,p,d;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("ScheduledActivityList - fetchList()"),r.userid){t.next=4;break}return console.log("fetchList -> User not logged in. Returing...."),t.abrupt("return");case 4:return l=new oe(e.user.token),o=new Date(n),(c=new Date).setDate(o.getDate()+365),i="".concat(o.getMonth()+1,"-").concat(o.getDate(),"-").concat(o.getFullYear()),s="".concat(c.getMonth()+1,"-").concat(c.getDate(),"-").concat(c.getFullYear()),t.next=12,l.getScheduledActivitiesPerPatientId(a,i,s);case 12:return u=t.sent,t.next=15,u.json();case 15:p=t.sent,d=p.filter((function(e){return e.ActivityCategoryCode.toLowerCase().includes("treatment")})),m(d);case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){console.log("useEffect"),p(c.PatientId,c.ScheduledStartTime)}),[c.PatientId]);var d=[],h=function(e,t){t?d.push(e):d=d.filter((function(t){return t!==e}))};return l.a.createElement(w.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:ce},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Treatment List"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("adding a case!"),0!==d.length?(d.forEach((function(t){var a=new Date(t.ScheduledStartTime.replace("Z","")),n={case_name:"".concat(c.LastName,"-").concat(c.PatientId),sim:new Date(c.ScheduledStartTime.replace("Z","")),status:"Sim Completed",newstart:a,plan_name:"",planners:"",doctors:"",tx_site:"",note:c.ActivityNote,logs:[]};e.addplan(n)})),alert("".concat(d.length," items havev been added to PlanQ")),d=[],o()):alert("Please select items to add to the plan Q")}},"ADD TO PLANQ"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleClose},"CANCEL"))),u.map((function(e){return l.a.createElement(ee,{key:Object(ae.a)(),txItem:e,selectionChange:h})})))}function se(e){var t=e.scheduleItem,a=t.ScheduledStartTime,o=t.LastName,r=t.PatientId,c=t.ActivityCode,i=t.ScheduledActivityCode,s=t.ActivityNote,u=Object(n.useState)(!1),m=Object(f.a)(u,2),p=m[0],d=m[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"item"},l.a.createElement("ul",{className:"schedule_item"},l.a.createElement("li",{className:"ScheduledStartTime"},Z.MM_DD_DAY(new Date(a.replace("Z","")))),l.a.createElement("li",{className:"LastName"},o),l.a.createElement("li",{className:"PatientId"},r),l.a.createElement("li",{className:"ActivityCode"},c),l.a.createElement("li",{className:"ScheduledActivityCode"},i),l.a.createElement("li",{className:"ActivityNote"},s)),l.a.createElement(b.a,{variant:"outlined",color:"primary",size:"small",className:"add_button",endIcon:l.a.createElement(G.a,null),onClick:function(){d(!0)}},"PlanQ"),l.a.createElement(ie,{open:p,handleClose:function(){d(!1)},user:e.user,simItem:e.scheduleItem,addplan:e.addplan})),l.a.createElement(j.a,null))}var ue=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/enums",this.token=t}return Object(s.a)(e,[{key:"getEnums",value:function(){var e="".concat(this.url,"?token=").concat(this.token);return fetch(e)}},{key:"getEnums_prop",value:function(e){var t="".concat(this.url,"/").concat(e,"?token=").concat(this.token);return fetch(t)}}]),e}(),me=a(218),pe=a(234),de=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),fe=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function he(e,t){var a=new Date(e);return a.setDate(a.getDate()+t),a}function ge(e){return l.a.createElement("h1",null,e.msg)}function _e(e){var t=e.list,a=e.addplan,n=e.user;return l.a.createElement(x.a,null,t.map((function(e,t){return l.a.createElement(se,{key:Object(ae.a)(),scheduleItem:e,addplan:a,user:n})})))}function Ee(e){var t=e.open,a=e.handleClose,o=e.addplan,r=e.user;te.log("SimSchedule()");var c=de(),i=Object(n.useState)([]),s=Object(f.a)(i,2),u=s[0],m=s[1];Object(n.useEffect)((function(){console.log("SimSchedule->useEffect- fetching simResourceList"),new ue(r.token).getEnums_prop("sim_list").then((function(e){return e.json()})).then((function(e){m(e),e&&e.length>0&&g(e[0].aria_resourceser)})).catch((function(e){console.error("SimSchedule - fetching simResourceList failed"),console.error(e)}))}),[r]);for(var p=l.a.useState(null),d=Object(f.a)(p,2),h=d[0],g=d[1],y=l.a.useState(""),C=Object(f.a)(y,2),j=(C[0],C[1]),O=new Date,N=[],D=0;D<7;D++){var P=new Date;P.setDate(O.getDate()-D);var x="".concat(P.getMonth()+1,"-").concat(P.getDate(),"-").concat(P.getFullYear());N.push(x)}var M=l.a.useState(N[0]),A=Object(f.a)(M,2),I=A[0],L=A[1],q=l.a.useState([]),T=Object(f.a)(q,2),R=T[0],Q=T[1],F=function(){return!!r.userid},B=function(){var e=Object(z.a)(H.a.mark((function e(){var t,a,n,l,o,c,i,s,u,m,p,d;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("SimSchedule--\x3efetchList()"),F()){e.next=4;break}return console.log("fetchList -> User not logged in. Returing...."),e.abrupt("return");case 4:return t=new oe(r.token),a=h,n=I.split("-"),l=parseInt(n[2]),o=parseInt(n[0]),c=parseInt(n[1]),i=new Date(l,o-1,c),s=he(i,1),u="".concat(i.getMonth()+1,"-").concat(i.getDate(),"-").concat(i.getFullYear()),m="".concat(s.getMonth()+1,"-").concat(s.getDate(),"-").concat(s.getFullYear()),e.next=16,t.getScheduledActivitiesPerResourceSer(a,u,m);case 16:if(401!==(p=e.sent).status){e.next=21;break}j("Please login"),e.next=26;break;case 21:return e.next=23,p.json();case 23:d=e.sent,Q(d),j("");case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){console.log("useEffect()"),B()}),[h,I,t,u]);return l.a.createElement(Y.a,{utils:U.a},l.a.createElement(w.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:fe},l.a.createElement(me.a,{className:c.formControl},l.a.createElement(_.a,{className:c.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:c.title},"CT Sim"),l.a.createElement(me.a,{className:c.formControl},l.a.createElement(pe.a,{native:!0,value:h,onChange:function(e){g(e.target.value)},inputProps:{name:"resourceSer",id:"resourceSer-native-simple"}},u.map((function(e){return l.a.createElement("option",{value:e.aria_resourceser,key:Object(ae.a)()},e.name)})))),l.a.createElement(me.a,{className:c.formControl},l.a.createElement(pe.a,{native:!0,value:I,onChange:function(e){L(e.target.value)},inputProps:{name:"simDate",id:"simDate-native-simple"}},N.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){B()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),F()?l.a.createElement(_e,{list:R,user:r,addplan:o}):l.a.createElement(ge,{msg:"please login"})))}var ve=a(241),be=a(239),ke=a(233);a(151);function ye(e){return l.a.createElement(ke.a,Object.assign({elevation:6,variant:"filled"},e))}var Ce=Object(h.a)((function(e){return{root:{},appBar:{position:"relative"},title:{flex:1},formControl:{margin:e.spacing(1)},button:{margin:e.spacing(1)},alert:{width:"100%","& > * + *":{marginTop:e.spacing(0)}}}}));function je(e){te.log("Login()");var t=Ce(),a=l.a.useState(""),n=Object(f.a)(a,2),o=n[0],r=n[1],c=l.a.useState(""),i=Object(f.a)(c,2),s=i[0],u=i[1],m=l.a.useState(""),p=Object(f.a)(m,2),d=p[0],h=p[1],g=l.a.useState(!1),k=Object(f.a)(g,2),y=k[0],C=k[1],j=function(e,t){"clickaway"!==t&&C(!1)},O=function(){var t={userid:o,password:s},a=ne+"/users/authenticate",n=new XMLHttpRequest;n.open("POST",a,!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var t=JSON.parse(n.responseText);e.setUser(t),e.handleLoginClose(),u(""),C(!1)}else{h("Login Failed. Try again. Use your computer login ID and PW."),C(!0),u("")}},n.send(JSON.stringify(t))};return l.a.createElement(w.a,{className:"login-dialog",open:e.loginOpen,onClose:e.handleLoginClose},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(v.a,{variant:"h6",className:t.title},"Login"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleLoginClose},"CLOSE")))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{id:"textfield_userid",className:t.textField,label:"User Id",value:o,onChange:function(e){r(e.target.value)}})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{id:"textfield_password",className:t.textField,label:"Password",type:"password",value:s,onKeyUp:function(e){13===e.keyCode&&O()},onChange:function(e){u(e.target.value)}})),l.a.createElement(be.a,{open:y,autoHideDuration:6e3,onClose:j},l.a.createElement(ye,{onClose:j,severity:"error"},d)),l.a.createElement(b.a,{variant:"contained",color:"primary",className:t.button,onClick:O},"Submit"))}var we=a(104),Oe=a.n(we),Ne=a(103),Se=a.n(Ne),De=a(105),Pe=a.n(De),xe=a(107),Me=a(224),Ae=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/qalist",this.token=t}return Object(s.a)(e,[{key:"getQAs",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getPendingQAs",value:function(){return fetch(this.url+"/notcompleted?token=".concat(this.token))}},{key:"getCompletedQAs",value:function(){return fetch(this.url+"/completed?token=".concat(this.token))}},{key:"getQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getPendingQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/notcompleted/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getCompletedQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/completed/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getPendingQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/notcompleted/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getCompletedQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/completed/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"addQA",value:function(e){return fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updateQA",value:function(e,t){var a=this.url+"/"+e._id+"?token=".concat(this.token);return t&&(a+=t),console.log("url==>",a),fetch(a,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deleteQA",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),Ie=a(232),Le=(a(152),a(153),a(214)),Ye=a(220),qe=a(213),Ue=a(221);a(154);function Te(e){var t=e.open,a=e.handleClose,n=e.title,o=e.msg,r=e.buttons,c=e.error?"simple-dlg-error-title":"simple-dlg-info-title";return l.a.createElement(w.a,{open:t,className:"simple-dlg"},l.a.createElement(Ye.a,{className:c},n),o&&l.a.createElement(qe.a,null,l.a.createElement(Ue.a,{id:"alert-dialog-msg"},o)),l.a.createElement(Le.a,null,r.includes("Yes")&&l.a.createElement(b.a,{onClick:function(){a("Yes")},color:"primary"},"Yes"),r.includes("No")&&l.a.createElement(b.a,{onClick:function(){a("No")},color:"primary"},"No"),r.includes("Ok")&&l.a.createElement(b.a,{onClick:function(){a("Ok")},color:"primary"},"Ok"),r.includes("Cancel")&&l.a.createElement(b.a,{onClick:function(){a("Cancel")},color:"primary"},"Cancel")))}a(155);function Re(e){var t=e.open,a=e.handleClose,o=function(e){var t=Object(n.useState)(e),a=Object(f.a)(t,2),l=a[0],o=a[1];return[l,function(e){o(Object(d.a)({},l,Object(c.a)({},e.target.name,e.target.value)))}]}({PD:3,DTA:2,G:95}),r=Object(f.a)(o,2),i=r[0],s=r[1];return l.a.createElement(w.a,{open:t},l.a.createElement("div",{className:"gamma-title"},"Gamma Result"),l.a.createElement(qe.a,null,l.a.createElement("div",{className:"gamma-wrapper"},"Gamma: [",l.a.createElement("select",{id:"PD",name:"PD",onChange:s,value:i.PD},l.a.createElement("option",{value:"1"},"1 %"),l.a.createElement("option",{value:"2"},"2 %"),l.a.createElement("option",{value:"3"},"3 %"),l.a.createElement("option",{value:"4"},"4 %"),l.a.createElement("option",{value:"5"},"5 %")),"/",l.a.createElement("select",{id:"DTA",name:"DTA",onChange:s,value:i.DTA},l.a.createElement("option",{value:"1"},"1 mm"),l.a.createElement("option",{value:"2"},"2 mm"),l.a.createElement("option",{value:"3"},"3 mm"),l.a.createElement("option",{value:"4"},"4 mm"),l.a.createElement("option",{value:"5"},"5 mm")),"] =>",l.a.createElement("input",{id:"G",name:"G",onChange:s,value:i.G}),"%")),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(i)},color:"primary",autoFocus:!0},"OK"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}function Qe(e){console.log("QAListItem()");var t=e.qaitem,a=e.user,o=e.save_qa,r=e.delete_qa,c=t.qa,i=(t.dirty,c.due_on),s=c.plan_case_name,u=c.plan,m=c.type,p=c.result,h=c.machine,g=c.requested_by,_=(c.requested_on,c.completed_by),E=(c.completed_on,c.notes),v=new X,b=Object(n.useState)({result:p,notes:E}),k=Object(f.a)(b,2),y=k[0],C=k[1],j=Object(n.useState)(!1),w=Object(f.a)(j,2),O=w[0],N=w[1],S=Object(n.useState)(""===c.completed_by.trim()&&""!==c.result.trim()),D=Object(f.a)(S,2),P=D[0],x=D[1],M=Object(n.useState)(!1),A=Object(f.a)(M,2),I=A[0],L=A[1],Y=Object(n.useState)(!1),q=Object(f.a)(Y,2),U=q[0],T=q[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"qa_item"},l.a.createElement("div",{className:"qa-due"},v.MM_DD_DAY(new Date(i))),l.a.createElement("div",{className:"qa-plan_case_name"},s),l.a.createElement("div",{className:"qa-plan"},u),l.a.createElement("div",{className:"qa-type"},m),l.a.createElement("div",{className:"qa-machine"},h),l.a.createElement("div",{className:"qa-requested_by"},g.split("|")[0]),l.a.createElement("div",{className:"qa-result-wrapper"},l.a.createElement("div",{className:"qa-result"},y.result),l.a.createElement("button",{className:"open-gamma-dlg",onClick:function(){T(!0)}},"...")),l.a.createElement("div",null,l.a.createElement("input",{name:"notes",value:y.notes,onChange:function(e){"notes"===e.target.name&&(C(Object(d.a)({},y,{notes:e.target.value})),N(!0))},placeholder:"Notes"})),l.a.createElement("div",{className:"qa-completed_by"},_.split("|")[0]),l.a.createElement("div",{className:"button-container"},l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.result=y.result,c.notes=y.notes,o(c),N(!1)},disabled:!O}," Save ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.completed_on=new Date,c.completed_by="".concat(a.name,"|").concat(a.email,"|").concat(a.userid),c.result=y.result,c.notes=y.notes,o(c,"&action=completed"),N(!1),x(!1)},disabled:!P}," Complete ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){L(!0)}},"x")))),l.a.createElement(Te,{id:"delete_confirm_dialog",open:I,title:"Are you sure?",buttons:"Yes|no",handleClose:function(e){"Yes"===e&&r(t.qa),L(!1)}}),l.a.createElement(Re,{id:"gamma_dialog",open:U,handleClose:function(e){if(e){var t="G(".concat(e.PD,"%,").concat(e.DTA,"mm)=").concat(e.G,"%");C(Object(d.a)({},y,{result:t})),N(!0),x(!0)}T(!1)}}))}var Fe=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),Be=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function He(e){return l.a.createElement("h1",null,e.msg)}function ze(e){var t=e.list,a=e.delete_qa,n=e.save_qa,o=e.user;return l.a.createElement(x.a,null,t.map((function(e,t){return l.a.createElement(Qe,{key:Object(ae.a)(),qaitem:e,delete_qa:a,save_qa:n,user:o})})))}function We(e){var t=Fe(),a=e.open,o=e.handleClose,r=e.user,c=Object(n.useState)([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=["Pending","Completed","All"],p=Object(n.useState)(m[0]),d=Object(f.a)(p,2),h=d[0],g=d[1],y=Object(n.useState)(1),C=Object(f.a)(y,2),j=C[0],O=C[1],N=Object(n.useState)(0),D=Object(f.a)(N,2),P=D[0],x=D[1],M=r&&r.settings&&r.settings.qalist_num_of_cases_per_page?r.settings.qalist_num_of_cases_per_page:10,A=P%M>0?Math.floor(P/M)+1:Math.floor(P/M),I=function(){r&&r.userid?function(e,t,a){var n=(t-1)*a,l=a;if(r&&r.token){var o=new Ae(r.token);if(r.settings&&r.settings.my_machines&&""!==r.settings.my_machines.trim())switch(e){case"All":return o.getQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Pending":return o.getPendingQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Completed":return o.getCompletedQAs_machines_skip_limit(r.settings.my_machines,n,l);default:console.error("Unknown status")}else switch(e){case"All":return o.getQAs_skip_limit(n,l);case"Pending":return o.getPendingQAs_skip_limit(n,l);case"Completed":return o.getCompletedQAs_skip_limit(n,l);default:console.error("Unknown status")}}}(h,j,M).then((function(e){return e.json()})).then((function(e){var t=e.list.map((function(e){return{qa:e,dirty:!1}}));u(t),x(e.totalCount)})).catch((function(e){return console.log(e)})):console.log("user not logged in yet")};Object(n.useEffect)((function(){I()}),[a,r,h,j]);var L=function(){return!!r.userid};return l.a.createElement(Y.a,{utils:U.a},l.a.createElement(w.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:Be},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:o,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"QA List"),l.a.createElement("div",{className:"qa-status-wrapper"},l.a.createElement("label",{htmlFor:"qa-status"},"STATUS:"),l.a.createElement("select",{id:"qa-status",onChange:function(e){console.log("status",e.target.value),g(e.target.value)},value:h},m.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){I()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:o},"close")))),L()?l.a.createElement(ze,{list:s,delete_qa:function(e){L()&&new Ae(r.token).deleteQA(e).then((function(e){return e.json()})).then((function(t){if(1===t.deletedCount){var a=s.filter((function(t){return t.qa._id!==e._id}));u(a),x(P-1)}else console.error("delete qa failed. Either none deleted or more than 1 QAs deleted.")})).catch((function(e){return console.log(e)}))},save_qa:function(e,t){r&&r.token&&new Ae(r.token).updateQA(e,t).then((function(e){return e.json()})).then((function(e){1===e.nModified?u(s):console.error("save qa failed. Either none saved or more than 1 QAs saved.")})).catch((function(e){return console.log(e)}))},user:r}):l.a.createElement(He,{msg:"please login"}),l.a.createElement("div",{className:"qalist-pagenation"},l.a.createElement(Ie.a,{count:A,page:j,onChange:function(e,t){O(t)}}),l.a.createElement("div",{className:"total-count"},"N=",P))))}var Ge=a(223),Je=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/users",this.token=t}return Object(s.a)(e,[{key:"getAllUsers",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getUserByUserId",value:function(e){var t="".concat(this.url,"/userid/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"updateUser",value:function(e){console.log("updating a user",e);var t="".concat(this.url,"/userid/").concat(e.userid,"?token=").concat(this.token);return console.log("url==>",t),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}]),e}(),Ve=a(222),Ze=a(167),Ke=a(236),$e=Object(h.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3)}}}));function Xe(e,t){var a={};return e.forEach((function(e){a[e]=t.indexOf(e)>-1})),a}function et(e){console.log("CheckBoxSelectorDlg()");var t=e.open,a=e.handleClose,o=e.title,r=e.list,i=e.selected,s=$e(),u=l.a.useState(Xe(r,i)),m=Object(f.a)(u,2),p=m[0],h=m[1];Object(n.useEffect)((function(){h(Xe(r,i))}),[r,i,t]);var g=function(e){h(Object(d.a)({},p,Object(c.a)({},e.target.name,e.target.checked)))};return l.a.createElement(w.a,{open:t,className:"checkbox-selector-dlg"},l.a.createElement(Ye.a,{className:"checkbox-selector-dlg-title"},o),l.a.createElement(qe.a,null,l.a.createElement("div",{className:s.root},l.a.createElement(me.a,{component:"fieldset",className:s.formControl},l.a.createElement(Ze.a,null,Object.keys(p).map((function(e){return l.a.createElement(Ve.a,{key:e,control:l.a.createElement(Ke.a,{checked:p[e],onChange:g,name:e}),label:e})})))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){var e=[];Object.keys(p).forEach((function(t){p[t]&&e.push(t)})),a(e)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(156);var tt=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),at=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function nt(e,t){return!!function(e,t){if(console.log("label===>",e),console.log("value===>",t),console.log("typeof value===>",typeof t),!t||"string"===typeof t&&""===t.trim())return alert('"'.concat(e,'" field cannot be empty')),!1;if(isNaN(t))return alert('"'.concat(e,'" is not a number')),!1;var a=Number(t);return!!Number.isInteger(a)||(alert('"'.concat(e,'" is not an integer number')),!1)}(e,t)&&(!(parseInt(t)<1)||(alert('"'.concat(e,'" is not a positive integer number')),!1))}function lt(e){var t=e.open,a=e.handleClose,o=e.user,r=e.enumList;te.log("UseSettings()");var i=tt(),s=function(){return!!o.userid},u=function(){a(null)},m={notify_planq_list:!1,planq_num_of_cases_per_page:10,qalist_num_of_cases_per_page:10,notify_qa_new:!1,notify_qa_completed_all:!1,notify_aria_rx_change:!1,notify_aria_plan_change:!1,notify_aria_structure_change:!1,notify_for_all_patients:!1,planner:!1,doctor:!1,aria_userid:"",my_machines:r?r.machine_list.join(","):""},p=Object(n.useState)(m),h=Object(f.a)(p,2),g=h[0],y=h[1],C=Object(n.useState)(!1),O=Object(f.a)(C,2),N=O[0],D=O[1],P=function(e){"checkbox"===e.target.type?y(Object(d.a)({},g,Object(c.a)({},e.target.name,e.target.checked))):y(Object(d.a)({},g,Object(c.a)({},e.target.name,e.target.value))),D(!0)},x=Object(n.useCallback)(Object(z.a)(H.a.mark((function t(){var a,n,l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("UserSettingsDlg - fetchList()"),s()){t.next=4;break}return console.log("fetchData -> User not logged in. Returing...."),t.abrupt("return");case 4:return a=new Je(e.user.token),t.next=7,a.getUserByUserId(e.user.userid);case 7:return n=t.sent,t.next=10,n.json();case 10:(l=t.sent)&&l.settings&&(l.settings.my_machines&&""!==l.settings.my_machines.trim()||r&&(l.settings.my_machines=r.machine_list.join(",")),y(Object(d.a)({},g,{},l.settings))),D(!1);case 13:case"end":return t.stop()}}),t)}))),[o,t]);Object(n.useEffect)((function(){console.log("UserSettingsDlg--\x3euseEffect()"),x()}),[t,o,x]);var M=Object(n.useState)(!1),A=Object(f.a)(M,2),I=A[0],L=A[1];return l.a.createElement(w.a,{fullScreen:!0,open:t,onClose:u,TransitionComponent:at},l.a.createElement(me.a,{className:i.formControl},l.a.createElement(_.a,{className:i.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:u,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:i.title},"Use Settings"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("handleApply"),nt("PlanQ - Number of cases per page",g.planq_num_of_cases_per_page)&&nt("QA - Number of cases per page",g.qalist_num_of_cases_per_page)&&(console.log("setting dirty to false"),D(!1),console.log("settings========>",g),a(g))},disabled:!N},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:u},"Cancel")))),l.a.createElement("div",{className:"user-settings-content"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"About Me"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Email: ",o.email),l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Name: ",o.name),l.a.createElement("div",{className:"item-helper-text"},"(If the email/name above is not correct, please contact the administrator)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a planner"),l.a.createElement(Ge.a,{name:"planner",checked:g.planner,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a doctor"),l.a.createElement(Ge.a,{name:"doctor",checked:g.doctor,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Machines"),l.a.createElement("div",{className:"item-input"},l.a.createElement("span",null,g.my_machines),l.a.createElement("button",{onClick:function(){return L(!0)}},"..."))),l.a.createElement("div",{className:"item-helper-text"},"(If blank, it means I am interested in all machines)"),l.a.createElement(et,{open:I,handleClose:function(e){if(e){var t=e.join(",");y(Object(d.a)({},g,{my_machines:t})),D(!0)}L(!1)},title:"Select Machines",list:r?r.machine_list:[],selected:g.my_machines.split(",")})),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"PlanQ"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Send me PlanQ list every morning"),l.a.createElement(Ge.a,{name:"notify_planq_list",checked:g.notify_planq_list,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of cases per page"),l.a.createElement("input",{name:"planq_num_of_cases_per_page",value:g.planq_num_of_cases_per_page,className:"item-input",onChange:P}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"QA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all new QA creations"),l.a.createElement(Ge.a,{name:"notify_qa_new",checked:g.notify_qa_new,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all QA completions"),l.a.createElement(Ge.a,{name:"notify_qa_completed_all",checked:g.notify_qa_completed_all,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of QA items per page"),l.a.createElement("input",{name:"qalist_num_of_cases_per_page",value:g.qalist_num_of_cases_per_page,className:"item-input",onChange:P}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"ARIA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Aria User Id"),l.a.createElement("input",{name:"aria_userid",value:g.aria_userid,className:"item-input",onChange:P})),l.a.createElement("div",{className:"item-helper-text"},"(If ARIA User Id is not entered or incorrect, no ARIA notifiation will be sent)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Prescription")," changes"),l.a.createElement(Ge.a,{name:"notify_aria_rx_change",checked:g.notify_aria_rx_change,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Plan")," changes"),l.a.createElement(Ge.a,{name:"notify_aria_plan_change",checked:g.notify_aria_plan_change,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Structure")," changes"),l.a.createElement(Ge.a,{name:"notify_aria_structure_change",checked:g.notify_aria_structure_change,className:"item-input",size:"small",onChange:P})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for the changes in ",l.a.createElement("u",null,"all monitored patients")),l.a.createElement(Ge.a,{name:"notify_for_all_patients",checked:g.notify_for_all_patients,className:"item-input",size:"small",onChange:P}),l.a.createElement("div",{className:"item-helper-text"},"(Monitored patients are those in the PlanQ with its newstart date is today or later)"))),"  ")," ",l.a.createElement(j.a,null)))}a(157);var ot=Object(h.a)((function(e){return{root:{},menuButton:{marginRight:2},title:{marginLeft:e.spacing(2),flex:1}}})),rt=Object(g.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return l.a.createElement(xe.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),ct=Object(g.a)((function(e){return{root:{}}}))(Me.a);function it(e){te.log("Header()");var t=ot(),a=e.user,o=e.update_planlist,r=e.setUser,c=e.set_filter,i=e.enumList,s=function(){return!(!a||!a.userid)},u=Object(n.useState)(!1),m=Object(f.a)(u,2),p=m[0],h=m[1],g=Object(n.useState)(!1),y=Object(f.a)(g,2),j=y[0],w=y[1],O=Object(n.useState)(!1),N=Object(f.a)(O,2),S=N[0],P=N[1],x=function(){P(!0)},M=Object(n.useState)(!1),A=Object(f.a)(M,2),I=A[0],Y=A[1],q=l.a.useState(null),U=Object(f.a)(q,2),T=U[0],R=U[1],Q=function(){R(null)},B=function(){console.log("add a case"),e.onclick_addplan(),Q()},H=function(){w(!0),Q()},z=function(e){console.log("updating user settings============>",e),new Je(e.token).updateUser({userid:e.userid,settings:e.settings}).then((function(e){})).catch((function(e){console.error(e)}))},W=Object(n.useState)(!1),J=Object(f.a)(W,2),V=J[0],Z=J[1];Object(n.useEffect)((function(){var e=a&&a.settings&&a.settings.planq_search_keyword?a.settings.planq_search_keyword:"";ee(e)}),[a]);var K=Object(n.useState)(""),$=Object(f.a)(K,2),X=$[0],ee=$[1];return l.a.createElement("div",{className:t.root},l.a.createElement(_.a,{position:"static"},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(e){R(e.currentTarget)},disabled:!s()},l.a.createElement(C.a,null)),l.a.createElement(rt,{id:"customized-menu",anchorEl:T,keepMounted:!0,open:Boolean(T),onClose:Q},l.a.createElement(ct,{onClick:B},l.a.createElement(L.a,null,l.a.createElement(G.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Add Case"})),l.a.createElement(ct,{onClick:function(){console.log("email list to me"),e.onclick_email_planq_list_to_me(),Q()}},l.a.createElement(L.a,null,l.a.createElement(Se.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Email List to Me"})),l.a.createElement(ct,{onClick:H},l.a.createElement(L.a,null,l.a.createElement(Oe.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Sim List"})),l.a.createElement(Ee,{open:j,handleClose:function(){w(!1)},addplan:e.addplan,user:e.user,enumList:i}),l.a.createElement(ct,{onClick:x},l.a.createElement(L.a,null,l.a.createElement(Pe.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"QA List"})),l.a.createElement(We,{open:S,handleClose:function(){P(!1),Q()},user:a})),l.a.createElement(v.a,{variant:"h6",className:t.title},"PlanQ"),l.a.createElement("div",{className:"search-wriapper"},l.a.createElement("input",{className:"search-box",placeholder:"",value:X,onChange:function(e){ee(e.target.value)},disabled:!s()}),l.a.createElement(b.a,{color:"inherit",onClick:function(){a.settings.planq_search_keyword=X,z(a),r(a),console.log("handleSearch===============>")},disabled:!s()},"Search")),l.a.createElement(b.a,{color:"inherit",onClick:B,disabled:!s()},"Add"),l.a.createElement(b.a,{color:"inherit",onClick:H,disabled:!s()},"Sim"),l.a.createElement(b.a,{color:"inherit",onClick:x,disabled:!s()},"QA"),l.a.createElement(b.a,{id:"button_filter",color:"inherit",onClick:function(){h(!0)},disabled:!s()},"FILTERS"),l.a.createElement(F,{open:p,handleClose:function(e){e&&c(e),h(!1)},set_filter:e.set_filter,filter:e.filter}),l.a.createElement(b.a,{color:"inherit",onClick:function(){o()},disabled:!s()},"REFRESH"),s()?l.a.createElement("div",null,l.a.createElement(b.a,{color:"inherit",onClick:function(){Z(!0)}},"Settings"),l.a.createElement(lt,{open:V,handleClose:function(e){e&&(a.settings=Object(d.a)({},a.settings,{},e),z(a),r(a)),Z(!1)},user:a,enumList:i}),l.a.createElement(b.a,{color:"inherit",onClick:function(){console.log("Logout!"),r({})}},"LOGOUT[",e.user.userid,"]")):l.a.createElement(b.a,{id:"button_login",color:"inherit",onClick:function(){Y(!0)}},"LOGIN"),l.a.createElement(je,{loginOpen:I,handleLoginClose:function(){Y(!1)},user:a,setUser:r}))))}var st=a(108),ut={root:{margin:0,padding:10,textAlign:"center"}},mt=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement(st.a,{style:ut.root},l.a.createElement(v.a,{component:"p"},"Confidential. Version 1.0.0 (May 2020)"))}}]),t}(n.Component),pt=a(228),dt=a(240),ft=a(225),ht=a(226),gt=a(229),_t=a(106),Et=a.n(_t),vt=a(69),bt=(a(158),Object(g.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(dt.a)),kt=Object(g.a)({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:56,"&$expanded":{minHeight:56}},content:{"&$expanded":{margin:"12px 0"}},expanded:{}})(ft.a),yt=Object(g.a)((function(e){return{root:{padding:e.spacing(2)}}}))(ht.a);function Ct(e){var t=l.a.useState(""),a=Object(f.a)(t,2),n=a[0],o=a[1],r=e.log,c=r.msg.trim(),i=c.substring(1,c.length-1).split(","),s=[];i.forEach((function(e){var t=e.split(" by ");if(2===t.length){var a=t[1].split(" ")[0];s.push(a)}}));var u=Object(vt.a)(new Set(s)).join("/"),m=[];i.forEach((function(e){var t=e.split(" at ");if(2===t.length){var a=t[1].trim();m.push(a)}}));var p=Object(vt.a)(new Set(m)).join("/"),d=[];r.title.toLowerCase().includes("status changed")&&i.forEach((function(e){var t=e.split("->");if(2===t.length){var a=t[1].trim().split(" ")[0];d.push(a)}}));var h,g=Object(vt.a)(new Set(d)).join("/");return 0===g.length?[u,p].join(","):[].join(","),l.a.createElement(bt,{square:!0,expanded:"panel1"===n,onChange:(h="panel1",function(e,t){o(!!t&&h)})},l.a.createElement(kt,{"aria-controls":"panel1d-content",id:"panel1d-header"},l.a.createElement("ul",{className:"log-heading"},l.a.createElement("li",{className:"log-title"},r.title),l.a.createElement("li",{className:"log-who"},u),l.a.createElement("li",{className:"log-status"},g),l.a.createElement("li",{className:"log-time"},p))),l.a.createElement(yt,null,l.a.createElement("ul",null,i.map((function(e){return l.a.createElement("li",{key:Object(ae.a)()},e)})))))}var jt=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/logs",this.token=t}return Object(s.a)(e,[{key:"getLogsOfObject",value:function(e){var t="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"addLogOfObject",value:function(e,t){var a="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:t})}}]),e}(),wt=Object(h.a)((function(e){return{list:{width:"100%",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),Ot=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function Nt(e){var t=e.open,a=e.handleClose;te.log("AriaActivityList()");var o=wt(),r=e.object_id,c=l.a.useState([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=function(){var t=Object(z.a)(H.a.mark((function t(){var a,n,l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return te.log("AriaActivityList()->fetchList()->props.user",e.user),a=new jt(e.user.token),t.next=4,a.getLogsOfObject(e.object_id);case 4:return n=t.sent,t.next=7,n.json();case 7:l=t.sent,u(l);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){m()}),[r,t]);return l.a.createElement(w.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:Ot},l.a.createElement(me.a,{className:o.formControl},l.a.createElement(_.a,{className:o.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:o.title},"Activities"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){m()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),l.a.createElement("div",null,s.map((function(e){return l.a.createElement(Ct,{key:e._id,log:e})}))))}var St={root:{width:"100%"},list:{width:"100%"},LogTextField:{width:"100%"},logToolbar:{width:"100%",borderWidth:1},listitem:{margin:0,padding:0}},Dt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).change_handler=function(e){a.setState({input_text:e.target.value})},a.keyup=function(e){if(13===e.keyCode){var t=e.target.value;a.props.addlog(a.props.planitem,t),a.setState({input_text:""})}},a.state={input_text:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=new X;return l.a.createElement("div",{style:St.root},l.a.createElement(ve.a,{fullWidth:!0,style:St.LogTextField,label:"Log",margin:"normal",variant:"outlined",value:this.state.input_text,placeholder:"Type your log & hit Enter key",InputLabelProps:{shrink:!0},onChange:this.change_handler,onKeyUp:this.keyup}),l.a.createElement("div",{style:St.list},l.a.createElement(x.a,{component:"nav","aria-label":"main mailbox folders"},this.props.planitem.plan.logs&&this.props.planitem.plan.logs.map((function(a){return l.a.createElement(P.a,{button:!0,style:St.listitem,key:a.at},l.a.createElement(D.a,{primary:"[".concat(t.MM_DD(new Date(a.at)),"] ").concat(a.msg)}),l.a.createElement(b.a,{onClick:function(){e.props.removelog(e.props.planitem,a)}},"X"))})))))}}]),t}(n.Component),Pt=a(235),xt=a(227),Mt=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/aria/plansetups",this.token=t}return Object(s.a)(e,[{key:"getAllPlanSetupsPerPatientId",value:function(e){var t="".concat(this.url,"/PlanSetupsPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}}]),e}();a(159);function At(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=Object(n.useState)([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=Object(n.useState)(null),p=Object(f.a)(m,2),d=p[0],h=p[1];Object(n.useEffect)((function(){console.log("useEffect()"),g(r)}),[r,t]);var g=function(){var t=Object(z.a)(H.a.mark((function t(a){var n,l,r;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("PlanSetupSelector - fetchList()"),o.userid){t.next=4;break}return console.log("fetchList -> User not logged in. Returing...."),t.abrupt("return");case 4:return n=new Mt(e.user.token),t.next=7,n.getAllPlanSetupsPerPatientId(a);case 7:return l=t.sent,t.next=10,l.json();case 10:r=t.sent,u(r);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return l.a.createElement(w.a,{open:t,className:"plan-setup-selector-dlg"},l.a.createElement(Ye.a,{className:"plan-setup-selector-dlg-title"},"Select Plan"),l.a.createElement(qe.a,null,l.a.createElement(me.a,{component:"fieldset"},l.a.createElement(xt.a,{className:"plansetupselector-radiogroup","aria-label":"plansetuplist",name:"plansetuplist",value:d,onChange:function(e){h(e.target.value)}},s.map((function(e){var t=e.CourseId+"/"+e.PlanSetupId;return l.a.createElement(Ve.a,{key:Object(ae.a)(),value:t,control:l.a.createElement(Pt.a,null),label:t})}))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(d)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(160);function It(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=["PD","MapCheck","Film"],i=l.a.useState(c[0]),s=Object(f.a)(i,2),u=s[0],m=s[1],p=l.a.useState(""),d=Object(f.a)(p,2),h=d[0],g=d[1],_=Object(n.useState)(!1),E=Object(f.a)(_,2),v=E[0],k=E[1],y=Object(n.useState)({open:!1,title:"",msg:"",error:!1}),C=Object(f.a)(y,2),j=C[0],O=C[1],N=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];O({open:!0,title:e,msg:t,error:a})};return l.a.createElement("div",null,l.a.createElement(w.a,{open:t,className:"add-qa-dlg"},l.a.createElement(Ye.a,{className:"add-qa-dlg-title"},"New QA"),l.a.createElement(qe.a,null,l.a.createElement(me.a,{component:"fieldset"},l.a.createElement("label",{className:"qa-type-label"}," QA Type:"),l.a.createElement(xt.a,{className:"radiogroup-qa-type",value:u,onChange:function(e){m(e.target.value)}},c.map((function(e){return l.a.createElement(Ve.a,{value:e,key:Object(ae.a)(),control:l.a.createElement(Pt.a,null),label:e})}))),l.a.createElement("label",{className:"qa-plan-label"},"QA Plan:"),l.a.createElement(ve.a,{className:"text-field-qa-plan-name",value:h,InputLabelProps:{shrink:!0},onClick:function(){k(!0)},helperText:"Click to select a QA plan"}),l.a.createElement(At,{open:v,handleClose:function(e){console.log("handlePlanSetupSelectorDlgClose()",e),e&&g(e),k(!1)},user:o,PatientId:r}))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){""!==h?a({type:u,plan:h}):N("Error","Please select a QA plan",!0)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel"))),l.a.createElement(Te,{open:j.open,handleClose:function(){return O({open:!1,title:"",msg:"",error:!1})},title:j.title,msg:j.msg,buttons:"Ok",error:j.error}))}var Lt=l.a.createContext();function Yt(e,t){var a=t.type,n=t.data,l=t.user;switch(a){case"set-list":return n;case"add-item":if(console.log("add-item",n),!l||!l.token)return;new Ae(l.token).addQA(n).then((function(e){return e.json()})).then((function(t){var a={qa:t,dirty:!1};return[].concat(Object(vt.a)(e),[a])})).catch((function(e){return console.log(e)}))}}var qt=function(e){var t=e.user,a=Object(n.useReducer)(Yt,[]),o=Object(f.a)(a,2),r=o[0],c=o[1];return Object(n.useEffect)((function(){!function(e){e&&e.token&&new Ae(e.token).getQAs().then((function(e){return e.json()})).then((function(e){var t=e.map((function(e){return{qa:e,dirty:!1}}));c({type:"set-list",data:t})})).catch((function(e){return console.log(e)}))}(t)}),[t]),l.a.createElement(Lt.Provider,{value:{qaList:r,qaListDispatch:c}},e.children)};a(161),a(162);function Ut(e){var t=e.open,a=e.handleClose,o=e.title,r=e.initialValue,c=e.searchList,i=Object(n.useState)(r),s=Object(f.a)(i,2),u=s[0],m=s[1],p=l.a.useState([]),d=Object(f.a)(p,2),h=d[0],g=d[1],_=function(e){console.log("item clicked",e.target);var t=e.target.innerText;m(t)};return l.a.createElement(w.a,{open:t},l.a.createElement(Ye.a,{id:"alert-dialog-title"},o),l.a.createElement(qe.a,null,l.a.createElement("div",{className:"search-wrapper"},l.a.createElement("div",{className:"search-input-wrapper"},l.a.createElement("input",{className:"search-input",type:"text",placeholder:"Search",value:u,onChange:function(e){var t=e.target.value;m(t);var a=c.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())}));g(a)}})),l.a.createElement("div",{className:"matched-list"},h.map((function(e){return l.a.createElement("div",{key:e,onClick:_},e)}))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(u)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}var Tt=a(216),Rt=a(243),Qt=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/email",this.token=t}return Object(s.a)(e,[{key:"send",value:function(e){return console.log("sending an email",e),fetch("".concat(this.url,"?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"send_dailydigest",value:function(){return fetch("".concat(this.url,"/dailydigest?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})}}]),e}(),Ft={PaperProps:{style:{maxHeight:224,width:250}}};function Bt(e){return e&&""!==e.trim()?e.split(",").filter((function(e){return""!==e.trim()})).map((function(e){return e.split("|")[0]})).map((function(e){return function(e){if(!e.includes("."))return e;var t=e.split(".");return(t[0][0]+t[1][0]).toUpperCase()}(e)})).join(","):""}function Ht(e){return e.filter((function(e){return""!==e.trim()}))}var zt=Object(h.a)((function(e){return{root:{width:"100%"},heading:{fontSize:15},expensionPanelSummary:{backgroundColor:"#f1f1f1",borderWidth:1},PlanLogList:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120}}}));function Wt(e){var t=zt(),a=e.user,o=e.planitem,r=e.enumList,i=Object(n.useContext)(Lt).qaListDispatch,s=Object(n.useState)(o.plan),u=Object(f.a)(s,2),m=u[0],p=u[1],h=Object(n.useState)(!1),g=Object(f.a)(h,2),_=g[0],E=g[1],v=function(e){k(e.target.name,e.target.value)},k=function(e,t){p(Object(d.a)({},m,Object(c.a)({},e,t))),E(!0)},y=Object(n.useState)(!1),C=Object(f.a)(y,2),w=C[0],O=C[1],N=function(){O(!w)},S=Object(n.useState)(!1),P=Object(f.a)(S,2),x=P[0],M=P[1],A=Object(n.useState)(!1),I=Object(f.a)(A,2),L=I[0],Y=I[1],q=(Date.parse(m.newstart)-new Date)/1e3/60/60/24/30,U=Object(n.useState)(!1),T=Object(f.a)(U,2),R=T[0],Q=T[1],F=Object(n.useState)(!1),B=Object(f.a)(F,2),H=B[0],z=B[1],W=Object(n.useState)(!1),G=Object(f.a)(W,2),J=G[0],V=G[1],K=m&&m.doctors&&a&&a.email&&m.doctors.toLowerCase().includes(a.email.toLowerCase())?"doctors highlight":"doctors",$=m&&m.planners&&a&&a.email&&m.planners.toLowerCase().includes(a.email.toLowerCase())?"planners highlight":"doctors";return l.a.createElement(dt.a,{expanded:w},l.a.createElement(ft.a,{expandIcon:l.a.createElement(Et.a,null),"aria-controls":m._id+"content",id:m._id+"header",className:t.expensionPanelSummary,onClick:N},l.a.createElement("ul",{className:"heading"},l.a.createElement("li",{className:"newstart"},q<6?Z.MM_DD_DAY(new Date(m.newstart)):"TBD"),l.a.createElement("li",{className:"lastname"},m.case_name.split("-")[0]),l.a.createElement("li",{className:"status"},m.status),l.a.createElement("li",{className:K},Bt(m.doctors)),l.a.createElement("li",{className:$},Bt(m.planners)),l.a.createElement("li",{className:"tx_site"},m.tx_site),l.a.createElement("li",{className:"tx_modality"},m.modality),l.a.createElement("li",{className:"tx_machine"},m.machine),l.a.createElement("li",{className:"note"},m.note))),l.a.createElement(ht.a,null,l.a.createElement(pt.a,{container:!0,direction:"row",justify:"center",alignItems:"center"},l.a.createElement("form",{className:"plan-form",noValidate:!0},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-casename",label:"Case",name:"case_name",value:m.case_name,InputLabelProps:{shrink:!0},onChange:v})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-newstart",type:"datetime-local",label:"New Start",name:"newstart",defaultValue:Z.YYYY_MM_DDTHH_MM(new Date(m.newstart)),InputLabelProps:{shrink:!0},onChange:v})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-plan-status",select:!0,name:"status",label:"Status",value:m.status,onChange:v,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"status_not_selected",value:""}),r&&r.plan_status_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-plan-name",label:"Plan Name",value:m.plan_name,InputLabelProps:{shrink:!0},onClick:function(){Q(!0)}})),l.a.createElement(At,{open:R,handleClose:function(e){e&&k("plan_name",e),Q(!1)},user:a,PatientId:m.case_name.split("-")[1]}),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-tx-modality",select:!0,label:"Modality",name:"modality",value:m.modality,onChange:v,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"modality_not_selected",value:""}),r&&r.tx_modality_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(Rt.a,{id:"doctors-label"},"Doctors"),l.a.createElement(pe.a,{labelId:"doctors-label",id:"doctors-checkbox-list",multiple:!0,value:m.doctors.split(","),onChange:function(e){return k("doctors",Ht(e.target.value).join(","))},input:l.a.createElement(Tt.a,null),renderValue:function(e){return Bt(e.join(","))},MenuProps:Ft},r.doctor_list.map((function(e){return l.a.createElement(Me.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:m.doctors.split(",").indexOf(e)>-1}),l.a.createElement(D.a,{primary:e.split("|")[0]}))})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(Rt.a,{id:"planners-label"},"Planners"),l.a.createElement(pe.a,{labelId:"planners-label",id:"planners-checkbox-list",multiple:!0,value:m.planners.split(","),onChange:function(e){return k("planners",Ht(e.target.value).join(","))},input:l.a.createElement(Tt.a,null),renderValue:function(e){return Bt(e.join(","))},MenuProps:Ft},r.planner_list.map((function(e){return l.a.createElement(Me.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:m.planners.split(",").indexOf(e)>-1}),l.a.createElement(D.a,{primary:e.split("|")[0]}))})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-tx-site",label:"Tx Site",name:"tx_site",value:m.tx_site,onChange:v,onClick:function(){return V(!0)},InputLabelProps:{shrink:!0},InputProps:{disabled:!0}})),l.a.createElement(Ut,{open:J,handleClose:function(e){e&&k("tx_site",e),V(!1)},title:"Treatment Site",initialValue:m.tx_site,searchList:r.tx_site_list}),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-sim-date",type:"date",label:"Sim",name:"sim",defaultValue:Z.YYYY_MM_DD(new Date(m.sim.replace("Z",""))),InputLabelProps:{shrink:!0},onChange:v})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-machine",select:!0,name:"machine",label:"Machine",value:m.machine,onChange:v,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"machine_not_selected",value:""}),r&&r.machine_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl,fullWidth:!0},l.a.createElement(ve.a,{className:"text-field-note",label:"Short Comment",name:"note",value:m.note,fullWidth:!0,variant:"outlined",onChange:v,InputLabelProps:{shrink:!0}}))),l.a.createElement(Dt,{className:t.PlanLogList,planitem:e.planitem,addlog:function(t,a){e.addlog(t,a),E(!0)},removelog:function(t,a){e.removelog(t,a),E(!0)}}))),l.a.createElement(j.a,null),l.a.createElement(gt.a,null,l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",disabled:!_,onClick:function(){e.saveplan_handler({plan:m,dirty:!0}),N()}},"Save"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){e.duplicateplan_handler(e.planitem),N()}},"Duplicate"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){Y(!0)}},"Delete"),l.a.createElement(Te,{id:"delete_dialog",open:L,title:"Are you sure?",buttons:"Yes|No",handleClose:function(t){"Yes"===t&&e.deleteplan_handler(e.planitem),Y(!1)}}),l.a.createElement(b.a,{id:"button_add_qa",size:"small",color:"primary",variant:"outlined",onClick:function(){z(!0)}},"Add QA"),l.a.createElement(It,{open:H,handleClose:function(e){if(e){var t={id:Object(ae.a)(),type:e.type,plan:e.plan,result:"",requested_by:"".concat(a.name,"|").concat(a.email,"|").concat(a.userid),requested_on:new Date,completed_by:"",completed_on:null,due_on:new Date(m.newstart),plan_case_name:m.case_name,plan_case_id:m._id,machine:m.machine,notes:""};i({type:"add-item",data:t,user:a})}z(!1)},user:a,PatientId:m.case_name.split("-")[1]}),l.a.createElement(b.a,{id:"button_email_group",size:"small",color:"primary",variant:"outlined",onClick:function(){!function(e,t){console.log("plan====>",e);var a=(Date.parse(e.newstart)-new Date)/1e3/60/60/24/30<6?Z.MM_DD_DAY(new Date(e.newstart)):"TBD",n=e.case_name,l=e.status,o=e.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),r=e.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=e.tx_site,i=e.modality,s=e.machine,u=e.note,m=[];m.push("Patient = "+n),m.push("Start Date = "+a),m.push("Status = "+l),m.push("Doctors="+o),m.push("Planners = "+r),m.push("Tx Site = "+c),m.push("Modality = "+i),m.push("Machine = "+s),m.push("Notes = "+u);var p=m.join("\n"),d={from:"radonc.physics@stonybrookmedicine.edu",to:t.email,subject:n.split("-")[0],text:p};new Qt(t.token).send(d)}(o.plan,a)}},"Email Me"),l.a.createElement(b.a,{id:"button_view_auto_activities",size:"small",color:"primary",variant:"outlined",onClick:function(){return M(!0)}},"Activities"),l.a.createElement(Nt,{open:x,handleClose:function(){return M(!1)},object_id:m.case_name.split("-")[1],user:e.user})))}a(163);function Gt(e){var t=e.pagenation,a=e.setPage,n=t.page,o=t.totalCount,r=t.itemsPerPage,c=o%r>0?Math.floor(o/r)+1:Math.floor(o/r);return l.a.createElement(st.a,{className:"planlist-wrapper"},l.a.createElement("div",{className:"planlist"},e.planitems.map((function(t){return l.a.createElement(Wt,{key:t.plan._id,planitem:t,date_change_handler:e.date_change_handler,deleteplan_handler:e.deleteplan_handler,saveplan_handler:e.saveplan_handler,duplicateplan_handler:e.duplicateplan_handler,addlog:e.addlog,removelog:e.removelog,user:e.user,set_planitems_state:e.set_planitems_state,enumList:e.enumList})}))),l.a.createElement("div",{className:"planlist-pagenation"},l.a.createElement(Ie.a,{count:c,page:n,onChange:function(e,t){a(t)}}),l.a.createElement("div",{className:"total-count"},"N=",o)))}var Jt=function(){function e(t){Object(i.a)(this,e),this.url=ne+"/plans",this.token=t}return Object(s.a)(e,[{key:"getAllPlans",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getAllPlans_newstart_gt",value:function(e){e=encodeURIComponent(e);var t="".concat(this.url,"/newstart/gt/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"getAllPlans_newstart_gt_lt",value:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);var a="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"?token=").concat(this.token);return fetch(a)}},{key:"getAllPlans_newstart_gt_lt_skip_limit",value:function(e,t,a,n){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n);var l="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/skip/").concat(a,"/limit/").concat(n,"?token=").concat(this.token);return fetch(l)}},{key:"getAllPlans_newstart_gt_lt_keyword_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_machines_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/machines/").concat(a,"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_keyword_machines_skip_limit",value:function(e,t,a,n,l,o){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l),o=encodeURIComponent(o);var r="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/machines/").concat(n,"/skip/").concat(l,"/limit/").concat(o,"?token=").concat(this.token);return fetch(r)}},{key:"getAllPlans_keyword_skip_limit",value:function(e,t,a){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a);var n="".concat(this.url,"/keyword/").concat(e.trim().toLowerCase(),"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token);return fetch(n)}},{key:"addPlan",value:function(e){return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updatePlan",value:function(e){var t=this.url+"/"+e._id+"?token=".concat(this.token);return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deletePlan",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),Vt=a(230);var Zt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).showMsg=function(e,t){var n,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.setState({msgBox:(n={open:!0,title:e,msg:t},Object(c.a)(n,"msg",t),Object(c.a)(n,"error",l),n)})},a.setPage=function(e){e!==a.pagenation.page&&(a.pagenation.page=e,a.update_planlist())},a.update_planlist_internal=function(e){var t=a.state.user;if(te.log("App--\x3eupdate_planlist()"),!t||!t.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});a.setState({showProgress:!0}),t.settings&&t.settings.planq_num_of_cases_per_page&&(a.pagenation.itemsPerPage=t.settings.planq_num_of_cases_per_page),new ue(a.state.user.token).getEnums().then((function(e){return e.json()})).then((function(t){a.enumList=t,a.enumList.tx_site_list.sort(),e().then((function(e){return e.json()})).then((function(e){a.pagenation.totalCount=e.totalCount;var t=e.list.map((function(e){return{plan:e,dirty:!1}}));a.setState({planitems:t,showProgress:!1})})).catch((function(e){console.error("getAllPlans failed",e),a.showMsg("Error","Failed getting planning data. Please contact the administrator.",!0)}))})).catch((function(e){console.error(),a.showMsg("Error","Failed getting the enumeration data. Please contact the administrator.",!0)}))},a.update_planlist=function(){console.log("update_planlist================>");var e=a.state.user;if(!e||!e.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});var t,n,l=!1;a.enumList?e.settings&&e.settings.my_machines&&(t=e.settings.my_machines.split(","),n=a.enumList.machine_list,t.length!==n.length||t.map((function(e){return e.trim()})).sort().join("")!==n.map((function(e){return e.trim()})).sort().join(""))&&(l=!0):e.settings&&e.settings.my_machines&&(l=!0);var o=e.settings&&e.settings.planq_search_keyword&&""!==e.settings.planq_search_keyword.trim()?e.settings.planq_search_keyword.trim():"";if(""!==o||l)if(""===o&&l){a.update_planlist_internal((function(){var t=Z.YYYY_MM_DD(a.filter.newstart_from),n=Z.YYYY_MM_DD(a.filter.newstart_to),l=e.settings.my_machines,o=a.pagenation,r=o.page,c=o.itemsPerPage,i=(r-1)*c,s=c;return new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_machines_skip_limit(t,n,l,i,s)}))}else if(""===o||l)if(""!==o&&l){a.update_planlist_internal((function(){var t=a.pagenation,n=t.page,l=t.itemsPerPage,r=(n-1)*l,c=l,i=Z.YYYY_MM_DD(a.filter.newstart_from),s=Z.YYYY_MM_DD(a.filter.newstart_to),u=e.settings.my_machines;return console.log("keyword===>",o),console.log("machines===>",u),new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_machines_skip_limit(i,s,o,u,r,c)}))}else console.log("Code should not reach this code block!!!");else{a.update_planlist_internal((function(){var e=a.pagenation,t=e.page,n=e.itemsPerPage,l=(t-1)*n,r=n,c=Z.YYYY_MM_DD(a.filter.newstart_from),i=Z.YYYY_MM_DD(a.filter.newstart_to);return console.log("keyword===>",o),new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_skip_limit(c,i,o,l,r)}))}else{a.update_planlist_internal((function(){var e=Z.YYYY_MM_DD(a.filter.newstart_from),t=Z.YYYY_MM_DD(a.filter.newstart_to),n=a.pagenation,l=n.page,o=n.itemsPerPage,r=(l-1)*o,c=o;return new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_skip_limit(e,t,r,c)}))}},a.onclick_addplan=function(){if(a.state.user.userid){var e=new Date,t={case_name:"NA",sim:e,status:"",newstart:e,plan_name:"",planners:"",doctors:"",tx_site:"",note:"",logs:[]};a.addplan(t)}else console.log("onclick_addplan=> User not Logged In")},a.addplan=function(e){a.state.user&&a.state.user.userid?new Jt(a.state.user.token).addPlan(e).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})):console.log("onclick_addplan=> User not Logged In")},a.onclick_email_planq_list_to_me=function(){if(a.state.user.userid){var e=[];a.state.planitems.forEach((function(t){var a=t.plan,n=(Date.parse(a.newstart)-new Date)/1e3/60/60/24/30<6?Z.MM_DD_DAY(new Date(a.newstart)):"TBD",l=a.case_name,o=a.status,r=a.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=a.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),i=a.tx_site,s="".concat(n,"\t").concat(l,"\t").concat(o,"\t").concat(r,"\t").concat(c,"\t").concat(i);e.push(s)}));var t={from:"radonc.physics@stonybrookmedicine.edu",to:a.state.user.email,subject:"PlanQ List",text:e.join("\n")};new Qt(a.state.user.token).send(t)}else console.log("onclick_email_planq_list_to_me=> User not Logged In")},a.onclick_deleteplan=function(e){a.state.user.userid?new Jt(a.state.user.token).deletePlan(e.plan).then((function(e){return e.json()})).then((function(t){var n=a.state.planitems.filter((function(t){return t.plan._id!==e.plan._id}));a.setState({planitems:n})})):console.log("onclick_deleteplan=> User not Logged In")},a.onclick_saveplan=function(e){if(a.state.user.userid){var t=new Jt(a.state.user.token);console.log("planitem.plan=",e.plan),t.updatePlan(e.plan).then((function(e){return e.json()})).then((function(t){e.dirty=!1,a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_saveplan=> User not Logged In")},a.onclick_duplicateplan=function(e){if(a.state.user.userid){var t={case_name:e.plan.case_name,sim:e.plan.sim,status:"",newstart:e.plan.newstart,plan_name:e.plan.plan_name,planners:e.plan.planners,doctors:e.plan.doctors,tx_site:e.plan.tx_site,machine:e.plan.machine,modality:e.plan.modality,note:e.plan.note,logs:e.plan.logs};new Jt(a.state.user.token).addPlan(t).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_duplicateplan=> User not Logged In")},a.addlog=function(e,t){if(te.log("addlog()"),a.state.user.userid){var n={msg:t,by:"",at:new Date};e.plan.logs.unshift(n),a.setState({planitems:a.state.planitems})}else console.log("addlog=> User not Logged In")},a.removelog=function(e,t){te.log("removelog()"),a.state.user.userid?(e.plan.logs=e.plan.logs.filter((function(e){return e.at!==t.at})),a.setState({planitems:a.state.planitems})):console.log("removelog=> User not Logged In")},a.set_filter=function(e){e&&(a.filter=e,console.log("set_filter=>",e),a.pagenation.page=1,a.update_planlist())},a.setUser=function(e){console.log("setUser()"),e&&e.token?(a.setState({user:e}),a.update_planlist()):a.setState({user:{},planitems:[]})},a.set_planitems_state=function(){a.setState({planitems:a.state.planitems})},document.querySelector("title").innerHTML="PlanQ - "+le,a.state={planitems:[],user:{},showProgress:!1,msgBox:{open:!1,title:"",msg:"",error:!1}},a.pagenation={itemsPerPage:10,page:1,totalCount:0};var n=new Date,l=new Date(n.getFullYear()+2,n.getMonth(),n.getDate());return a.filter={newstart_from:n,newstart_to:l,keyword:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){te.log("App--\x3ecomponentDidMount()"),this.update_planlist()}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(qt,{user:this.state.user},l.a.createElement(it,{onclick_addplan:this.onclick_addplan,onclick_email_planq_list_to_me:this.onclick_email_planq_list_to_me,set_filter:this.set_filter,addplan:this.addplan,user:this.state.user,setUser:this.setUser,update_planlist:this.update_planlist,filter:this.filter,enumList:this.enumList}),this.state.showProgress&&l.a.createElement(Vt.a,{color:"secondary"}),this.state.user&&this.state.user.userid?l.a.createElement(Gt,{planitems:this.state.planitems,date_change_handler:this.date_change_handler,deleteplan_handler:this.onclick_deleteplan,saveplan_handler:this.onclick_saveplan,duplicateplan_handler:this.onclick_duplicateplan,addlog:this.addlog,removelog:this.removelog,user:this.state.user,set_planitems_state:this.set_planitems_state,enumList:this.enumList,pagenation:this.pagenation,setPage:this.setPage}):l.a.createElement("h3",{className:"please-login"},"Please login (use your computer login id/pw)"),l.a.createElement(mt,null)),l.a.createElement(Te,{open:this.state.msgBox.open,handleClose:function(){return e.setState({msgBox:{open:!1,title:"",msg:"",error:!1}})},title:this.state.msgBox.title,msg:this.state.msgBox.msg,buttons:"Ok",error:this.state.msgBox.error}))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(Zt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[136,1,2]]]);
//# sourceMappingURL=main.8d740317.chunk.js.map
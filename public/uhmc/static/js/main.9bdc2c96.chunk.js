(this["webpackJsonpplanq-client1"]=this["webpackJsonpplanq-client1"]||[]).push([[0],{137:function(e,t,a){e.exports=a(166)},142:function(e,t,a){},143:function(e,t,a){},144:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},153:function(e,t,a){},154:function(e,t,a){},155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){},164:function(e,t,a){},165:function(e,t,a){},166:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(13),r=a.n(o),c=(a(142),a(23)),i=a(14),s=a(15),u=a(65),m=a(60),p=a(66),d=(a(143),a(21)),f=a(6),h=a(203),g=a(4),_=a(208),E=a(209),v=a(57),b=a(210),k=a(113),y=a(106),C=a.n(y),j=a(221),O=a(239),w=a(206),N=a(36),S=a.n(N),P=a(213),D=a(167),A=a(211),M=a(214),x=a(95),I=a.n(x),L=a(212),Y=a(25),U=a(233),q=a(63),T=(a(144),Object(h.a)((function(e){return{root:{},menuButton:{marginRight:2},textField_DateTime:{marginLeft:1,marginRight:1,width:180,textAlign:"center",color:"white"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}))),R=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function F(e){return e instanceof Date&&!isNaN(e)}function Q(e){var t=T(),a=e.filter,n=e.handleClose,o=l.a.useState(a.newstart_from),r=Object(f.a)(o,2),c=r[0],i=r[1],s=l.a.useState(a.newstart_to),u=Object(f.a)(s,2),m=u[0],p=u[1],d=l.a.useState(a.keyword),h=Object(f.a)(d,2),g=h[0],y=(h[1],function(){n(null)});return l.a.createElement(Y.a,{utils:q.a},l.a.createElement(O.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:R},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:y,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Filters"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){n({newstart_from:c,newstart_to:m,keyword:g})}},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:y},"Close"))),l.a.createElement(A.a,null,l.a.createElement(D.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(P.a,{primary:"New Start From"}),l.a.createElement(M.a,null,l.a.createElement(U.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_from",value:c,onChange:function(e){F(e)?i(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(j.a,null),l.a.createElement(D.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(P.a,{primary:"New Start To"}),l.a.createElement(M.a,null,l.a.createElement(U.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_to",value:m,onChange:function(e){F(e)?p(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(j.a,null))))}var B=a(69),H=a.n(B),z=a(85),J=a(86),W=a.n(J),G=["SUN","MON","TUE","WED","THR","FRI","SAT"];function V(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var Z=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"MM_DD_YYYY",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)}},{key:"MM_DD",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2);return"".concat(t,"/").concat(a)}},{key:"MM_DD_DAY",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2),n=G[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")}},{key:"HH_MM_AMPM",value:function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)}},{key:"HH_MM",value:function(e){var t=V(e.getHours(),2),a=V(e.getMinutes(),2);return"".concat(t,":").concat(a)}},{key:"YYYY_MM_DD",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)}},{key:"YYYY_MM_DDTHH_MM",value:function(e){return this.YYYY_MM_DD(e)+"T"+this.HH_MM(e)}}]),e}(),K=(a(150),["SUN","MON","TUE","WED","THR","FRI","SAT"]);function $(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var X=function e(){var t=this;Object(i.a)(this,e),this.MM_DD_YYYY=function(e){var t=e.getFullYear(),a=$(e.getMonth()+1,2),n=$(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)},this.MM_DD=function(e){var t=$(e.getMonth()+1,2),a=$(e.getDate(),2);return"".concat(t,"/").concat(a)},this.MM_DD_DAY=function(e){var t=$(e.getMonth()+1,2),a=$(e.getDate(),2),n=K[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")},this.HH_MM_AMPM=function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)},this.HH_MM=function(e){var t=$(e.getHours(),2),a=$(e.getMinutes(),2);return"".concat(t,":").concat(a)},this.YYYY_MM_DD=function(e){var t=e.getFullYear(),a=$(e.getMonth()+1,2),n=$(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)},this.YYYY_MM_DDTHH_MM=function(e){return t.YYYY_MM_DD(e)+"T"+t.HH_MM(e)}};a(151);function ee(e){var t=new X,a=e.txItem,n=t.MM_DD_DAY(new Date(a.ScheduledStartTime));return l.a.createElement("div",{className:"tx-item"},l.a.createElement("div",{className:"tx-start-time"},n),l.a.createElement("div",{className:"tx-activity-code"},a.ActivityCode),l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",id:"vehicle1",name:"vehicle1",onChange:function(t){console.dir(t.target),e.selectionChange(a,t.target.checked)}})))}var te=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"log",value:function(e,t){console.log(e,t)}},{key:"log",value:function(e){console.log(e)}}]),e}(),ae=a(240),ne=a(8),le=a.n(ne),oe=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/aria/scheduled_activities",this.token=t}return Object(s.a)(e,[{key:"getScheduledActivitiesPerResourceSer",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerResourceSer/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}},{key:"getAllScheduledActivitiesPerPatientId",value:function(e){var t="".concat(this.url,"/ScheduledActivitiesPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}},{key:"getScheduledActivitiesPerPatientId",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerPatientId/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}}]),e}(),re=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),ce=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function ie(e){te.log("ScheduledActivityList()");var t=re(),a=e.open,o=e.handleClose,r=e.user,c=e.simItem,i=l.a.useState([]),s=Object(f.a)(i,2),u=s[0],m=s[1],p=function(t,a){if(console.log("ScheduledActivityList - fetchList()"),r.userid){var n=new oe(e.user.token),l=new Date(a),o=new Date;o.setDate(l.getDate()+365);var c="".concat(l.getMonth()+1,"-").concat(l.getDate(),"-").concat(l.getFullYear()),i="".concat(o.getMonth()+1,"-").concat(o.getDate(),"-").concat(o.getFullYear());n.getScheduledActivitiesPerPatientId(t,c,i).then((function(e){return e.json()})).then((function(e){var t=e.filter((function(e){return e.ActivityCategoryCode.toLowerCase().includes("treatment")}));m(t)})).catch((function(e){alert("Fetching treatment list failed! You may click 'Refresh' button on the browser & try again"),alert(JSON.stringify(e))}))}else console.log("fetchList -> User not logged in. Returing....")};Object(n.useEffect)((function(){console.log("useEffect"),p(c.PatientId,c.ScheduledStartTime)}),[c.PatientId]);var d=[],h=function(e,t){t?d.push(e):d=d.filter((function(t){return t!==e}))};return l.a.createElement(O.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:ce},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Treatment List"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("adding a case!"),0!==d.length?(d.forEach((function(t){var a=new Date(t.ScheduledStartTime.replace("Z","")),n={case_name:"".concat(c.LastName,"-").concat(c.PatientId),sim:new Date(c.ScheduledStartTime.replace("Z","")),status:"Sim Completed",newstart:a,plan_name:"",planners:"",doctors:"",tx_site:"",note:c.ActivityNote,logs:[]};e.addplan(n)})),alert("".concat(d.length," items havev been added to PlanQ")),d=[],o()):alert("Please select items to add to the plan Q")}},"ADD TO PLANQ"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleClose},"CANCEL"))),u.map((function(e){return l.a.createElement(ee,{key:Object(ae.a)(),txItem:e,selectionChange:h})})))}function se(e){var t=e.scheduleItem,a=t.ScheduledStartTime,o=t.LastName,r=t.PatientId,c=t.ActivityCode,i=t.ScheduledActivityCode,s=t.ActivityNote,u=Object(n.useState)(!1),m=Object(f.a)(u,2),p=m[0],d=m[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"item"},l.a.createElement("ul",{className:"schedule_item"},l.a.createElement("li",{className:"ScheduledStartTime"},Z.MM_DD_DAY(new Date(a.replace("Z","")))),l.a.createElement("li",{className:"LastName"},o),l.a.createElement("li",{className:"PatientId"},r),l.a.createElement("li",{className:"ActivityCode"},c),l.a.createElement("li",{className:"ScheduledActivityCode"},i),l.a.createElement("li",{className:"ActivityNote"},s)),l.a.createElement(b.a,{variant:"outlined",color:"primary",size:"small",className:"add_button",endIcon:l.a.createElement(W.a,null),onClick:function(){d(!0)}},"PlanQ"),l.a.createElement(ie,{open:p,handleClose:function(){d(!1)},user:e.user,simItem:e.scheduleItem,addplan:e.addplan})),l.a.createElement(j.a,null))}var ue=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/enums",this.token=t}return Object(s.a)(e,[{key:"getEnums",value:function(){var e="".concat(this.url,"?token=").concat(this.token);return fetch(e)}},{key:"getEnums_prop",value:function(e){var t="".concat(this.url,"/").concat(e,"?token=").concat(this.token);return fetch(t)}}]),e}(),me=a(220),pe=a(236),de=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),fe=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function he(e,t){var a=new Date(e);return a.setDate(a.getDate()+t),a}function ge(e){return l.a.createElement("h1",null,e.msg)}function _e(e){var t=e.list,a=e.addplan,n=e.user;return l.a.createElement(A.a,null,t.map((function(e,t){return l.a.createElement(se,{key:Object(ae.a)(),scheduleItem:e,addplan:a,user:n})})))}function Ee(e){var t=e.open,a=e.handleClose,o=e.addplan,r=e.user;te.log("SimSchedule()");var c=de(),i=Object(n.useState)([]),s=Object(f.a)(i,2),u=s[0],m=s[1];Object(n.useEffect)((function(){console.log("SimSchedule->useEffect- fetching simResourceList"),new ue(r.token).getEnums_prop("sim_list").then((function(e){return e.json()})).then((function(e){m(e),e&&e.length>0&&g(e[0].aria_resourceser)})).catch((function(e){console.error("SimSchedule - fetching simResourceList failed"),console.error(e),alert("Fetching simulation list failed! You may click 'Refresh' button on the browser & try again"),alert(JSON.stringify(e))}))}),[r]);for(var p=l.a.useState(null),d=Object(f.a)(p,2),h=d[0],g=d[1],y=l.a.useState(""),C=Object(f.a)(y,2),j=(C[0],C[1]),w=new Date,N=[],P=0;P<7;P++){var D=new Date;D.setDate(w.getDate()-P);var A="".concat(D.getMonth()+1,"-").concat(D.getDate(),"-").concat(D.getFullYear());N.push(A)}var M=l.a.useState(N[0]),x=Object(f.a)(M,2),I=x[0],L=x[1],U=l.a.useState([]),T=Object(f.a)(U,2),R=T[0],F=T[1],Q=function(){return!!r.userid},B=function(){var e=Object(z.a)(H.a.mark((function e(){var t,a,n,l,o,c,i,s,u,m,p,d;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("SimSchedule--\x3efetchList()"),Q()){e.next=4;break}return console.log("fetchList -> User not logged in. Returing...."),e.abrupt("return");case 4:return t=new oe(r.token),a=h,n=I.split("-"),l=parseInt(n[2]),o=parseInt(n[0]),c=parseInt(n[1]),i=new Date(l,o-1,c),s=he(i,1),u="".concat(i.getMonth()+1,"-").concat(i.getDate(),"-").concat(i.getFullYear()),m="".concat(s.getMonth()+1,"-").concat(s.getDate(),"-").concat(s.getFullYear()),e.next=16,t.getScheduledActivitiesPerResourceSer(a,u,m);case 16:if(401!==(p=e.sent).status){e.next=21;break}j("Please login"),e.next=26;break;case 21:return e.next=23,p.json();case 23:d=e.sent,F(d),j("");case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){console.log("useEffect()"),B()}),[h,I,t,u]);return l.a.createElement(Y.a,{utils:q.a},l.a.createElement(O.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:fe},l.a.createElement(me.a,{className:c.formControl},l.a.createElement(_.a,{className:c.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:c.title},"CT Sim"),l.a.createElement(me.a,{className:c.formControl},l.a.createElement(pe.a,{native:!0,value:h,onChange:function(e){g(e.target.value)},inputProps:{name:"resourceSer",id:"resourceSer-native-simple"}},u.map((function(e){return l.a.createElement("option",{value:e.aria_resourceser,key:Object(ae.a)()},e.name)})))),l.a.createElement(me.a,{className:c.formControl},l.a.createElement(pe.a,{native:!0,value:I,onChange:function(e){L(e.target.value)},inputProps:{name:"simDate",id:"simDate-native-simple"}},N.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){B()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),Q()?l.a.createElement(_e,{list:R,user:r,addplan:o}):l.a.createElement(ge,{msg:"please login"})))}var ve=a(243),be=a(241),ke=a(235);a(152);function ye(e){return l.a.createElement(ke.a,Object.assign({elevation:6,variant:"filled"},e))}var Ce=Object(h.a)((function(e){return{root:{},appBar:{position:"relative"},title:{flex:1},formControl:{margin:e.spacing(1)},button:{margin:e.spacing(1)},alert:{width:"100%","& > * + *":{marginTop:e.spacing(0)}}}}));function je(e){te.log("Login()");var t=Ce(),a=l.a.useState(""),n=Object(f.a)(a,2),o=n[0],r=n[1],c=l.a.useState(""),i=Object(f.a)(c,2),s=i[0],u=i[1],m=l.a.useState(""),p=Object(f.a)(m,2),d=p[0],h=p[1],g=l.a.useState(!1),k=Object(f.a)(g,2),y=k[0],C=k[1],j=function(e,t){"clickaway"!==t&&C(!1)},w=function(){var t={userid:o,password:s},a=le.a.webservice_url+"/users/authenticate",n=new XMLHttpRequest;n.open("POST",a,!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var t=JSON.parse(n.responseText);e.setUser(t),e.handleLoginClose(),u(""),C(!1)}else{h("Login Failed. Try again. Use your computer login ID and PW."),C(!0),u("")}},n.send(JSON.stringify(t))};return l.a.createElement(O.a,{className:"login-dialog",open:e.loginOpen,onClose:e.handleLoginClose},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(v.a,{variant:"h6",className:t.title},"Login"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleLoginClose},"CLOSE")))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{id:"textfield_userid",className:t.textField,label:"User Id",value:o,onChange:function(e){r(e.target.value)}})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{id:"textfield_password",className:t.textField,label:"Password",type:"password",value:s,onKeyUp:function(e){13===e.keyCode&&w()},onChange:function(e){u(e.target.value)}})),l.a.createElement(be.a,{open:y,autoHideDuration:6e3,onClose:j},l.a.createElement(ye,{onClose:j,severity:"error"},d)),l.a.createElement(b.a,{variant:"contained",color:"primary",className:t.button,onClick:w},"Submit"))}var Oe=a(108),we=a.n(Oe),Ne=a(107),Se=a.n(Ne),Pe=a(109),De=a.n(Pe),Ae=a(111),Me=a(226),xe=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/qalist",this.token=t}return Object(s.a)(e,[{key:"getQAs",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getPendingQAs",value:function(){return fetch(this.url+"/notcompleted?token=".concat(this.token))}},{key:"getCompletedQAs",value:function(){return fetch(this.url+"/completed?token=".concat(this.token))}},{key:"getQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getPendingQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/notcompleted/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getCompletedQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/completed/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getPendingQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/notcompleted/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getCompletedQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/completed/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"addQA",value:function(e){return fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updateQA",value:function(e,t){var a=this.url+"/"+e._id+"?token=".concat(this.token);return t&&(a+=t),console.log("url==>",a),fetch(a,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deleteQA",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),Ie=a(234),Le=(a(153),a(154),a(216)),Ye=a(222),Ue=a(215),qe=a(223);a(155);function Te(e){var t=e.open,a=e.handleClose,n=e.title,o=e.msg,r=e.buttons,c=e.error?"simple-dlg-error-title":"simple-dlg-info-title";return l.a.createElement(O.a,{open:t,className:"simple-dlg"},l.a.createElement(Ye.a,{className:c},n),o&&l.a.createElement(Ue.a,null,l.a.createElement(qe.a,{id:"alert-dialog-msg"},o)),l.a.createElement(Le.a,null,r.includes("Yes")&&l.a.createElement(b.a,{onClick:function(){a("Yes")},color:"primary"},"Yes"),r.includes("No")&&l.a.createElement(b.a,{onClick:function(){a("No")},color:"primary"},"No"),r.includes("Ok")&&l.a.createElement(b.a,{onClick:function(){a("Ok")},color:"primary"},"Ok"),r.includes("Cancel")&&l.a.createElement(b.a,{onClick:function(){a("Cancel")},color:"primary"},"Cancel")))}a(156);function Re(e){var t=e.open,a=e.handleClose,o=function(e){var t=Object(n.useState)(e),a=Object(f.a)(t,2),l=a[0],o=a[1];return[l,function(e){o(Object(d.a)({},l,Object(c.a)({},e.target.name,e.target.value)))}]}({PD:3,DTA:2,G:95}),r=Object(f.a)(o,2),i=r[0],s=r[1];return l.a.createElement(O.a,{open:t},l.a.createElement("div",{className:"gamma-title"},"Gamma Result"),l.a.createElement(Ue.a,null,l.a.createElement("div",{className:"gamma-wrapper"},"Gamma: [",l.a.createElement("select",{id:"PD",name:"PD",onChange:s,value:i.PD},l.a.createElement("option",{value:"1"},"1 %"),l.a.createElement("option",{value:"2"},"2 %"),l.a.createElement("option",{value:"3"},"3 %"),l.a.createElement("option",{value:"4"},"4 %"),l.a.createElement("option",{value:"5"},"5 %")),"/",l.a.createElement("select",{id:"DTA",name:"DTA",onChange:s,value:i.DTA},l.a.createElement("option",{value:"1"},"1 mm"),l.a.createElement("option",{value:"2"},"2 mm"),l.a.createElement("option",{value:"3"},"3 mm"),l.a.createElement("option",{value:"4"},"4 mm"),l.a.createElement("option",{value:"5"},"5 mm")),"] =>",l.a.createElement("input",{id:"G",name:"G",onChange:s,value:i.G}),"%")),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(i)},color:"primary",autoFocus:!0},"OK"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}function Fe(e){console.log("QAListItem()");var t=e.qaitem,a=e.user,o=e.save_qa,r=e.delete_qa,c=t.qa,i=(t.dirty,c.due_on),s=c.plan_case_name,u=c.plan,m=c.type,p=c.result,h=c.machine,g=c.requested_by,_=(c.requested_on,c.completed_by),E=(c.completed_on,c.notes),v=new X,b=Object(n.useState)({result:p,notes:E}),k=Object(f.a)(b,2),y=k[0],C=k[1],j=Object(n.useState)(!1),O=Object(f.a)(j,2),w=O[0],N=O[1],S=Object(n.useState)(""===c.completed_by.trim()&&""!==c.result.trim()),P=Object(f.a)(S,2),D=P[0],A=P[1],M=Object(n.useState)(!1),x=Object(f.a)(M,2),I=x[0],L=x[1],Y=Object(n.useState)(!1),U=Object(f.a)(Y,2),q=U[0],T=U[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"qa_item"},l.a.createElement("div",{className:"qa-due"},v.MM_DD_DAY(new Date(i))),l.a.createElement("div",{className:"qa-plan_case_name"},s),l.a.createElement("div",{className:"qa-plan"},u),l.a.createElement("div",{className:"qa-type"},m),l.a.createElement("div",{className:"qa-machine"},h),l.a.createElement("div",{className:"qa-requested_by"},g.split("|")[0]),l.a.createElement("div",{className:"qa-result-wrapper"},l.a.createElement("div",{className:"qa-result"},y.result),l.a.createElement("button",{className:"open-gamma-dlg",onClick:function(){T(!0)}},"...")),l.a.createElement("div",null,l.a.createElement("input",{name:"notes",value:y.notes,onChange:function(e){"notes"===e.target.name&&(C(Object(d.a)({},y,{notes:e.target.value})),N(!0))},placeholder:"Notes"})),l.a.createElement("div",{className:"qa-completed_by"},_.split("|")[0]),l.a.createElement("div",{className:"button-container"},l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.result=y.result,c.notes=y.notes,o(c),N(!1)},disabled:!w}," Save ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.completed_on=new Date,c.completed_by="".concat(a.name,"|").concat(a.email,"|").concat(a.userid),c.result=y.result,c.notes=y.notes,o(c,"&action=completed"),N(!1),A(!1)},disabled:!D}," Complete ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){L(!0)}},"x")))),l.a.createElement(Te,{id:"delete_confirm_dialog",open:I,title:"Are you sure?",buttons:"Yes|no",handleClose:function(e){"Yes"===e&&r(t.qa),L(!1)}}),l.a.createElement(Re,{id:"gamma_dialog",open:q,handleClose:function(e){if(e){var t="G(".concat(e.PD,"%,").concat(e.DTA,"mm)=").concat(e.G,"%");C(Object(d.a)({},y,{result:t})),N(!0),A(!0)}T(!1)}}))}var Qe=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),Be=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function He(e){return l.a.createElement("h1",null,e.msg)}function ze(e){var t=e.list,a=e.delete_qa,n=e.save_qa,o=e.user;return l.a.createElement(A.a,null,t.map((function(e,t){return l.a.createElement(Fe,{key:Object(ae.a)(),qaitem:e,delete_qa:a,save_qa:n,user:o})})))}function Je(e){var t=Qe(),a=e.open,o=e.handleClose,r=e.user,c=Object(n.useState)([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=["Pending","Completed","All"],p=Object(n.useState)(m[0]),d=Object(f.a)(p,2),h=d[0],g=d[1],y=Object(n.useState)(1),C=Object(f.a)(y,2),j=C[0],w=C[1],N=Object(n.useState)(0),P=Object(f.a)(N,2),D=P[0],A=P[1],M=r&&r.settings&&r.settings.qalist_num_of_cases_per_page?r.settings.qalist_num_of_cases_per_page:10,x=D%M>0?Math.floor(D/M)+1:Math.floor(D/M),I=function(){r&&r.userid?function(e,t,a){var n=(t-1)*a,l=a;if(r&&r.token){var o=new xe(r.token);if(r.settings&&r.settings.my_machines&&""!==r.settings.my_machines.trim())switch(e){case"All":return o.getQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Pending":return o.getPendingQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Completed":return o.getCompletedQAs_machines_skip_limit(r.settings.my_machines,n,l);default:console.error("Unknown status")}else switch(e){case"All":return o.getQAs_skip_limit(n,l);case"Pending":return o.getPendingQAs_skip_limit(n,l);case"Completed":return o.getCompletedQAs_skip_limit(n,l);default:console.error("Unknown status")}}}(h,j,M).then((function(e){return e.json()})).then((function(e){var t=e.list.map((function(e){return{qa:e,dirty:!1}}));u(t),A(e.totalCount)})).catch((function(e){return console.log(e)})):console.log("user not logged in yet")};Object(n.useEffect)((function(){I()}),[a,r,h,j]);var L=function(){return!!r.userid};return l.a.createElement(Y.a,{utils:q.a},l.a.createElement(O.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:Be},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:o,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"QA List"),l.a.createElement("div",{className:"qa-status-wrapper"},l.a.createElement("label",{htmlFor:"qa-status"},"STATUS:"),l.a.createElement("select",{id:"qa-status",onChange:function(e){console.log("status",e.target.value),g(e.target.value)},value:h},m.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){I()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:o},"close")))),L()?l.a.createElement(ze,{list:s,delete_qa:function(e){L()&&new xe(r.token).deleteQA(e).then((function(e){return e.json()})).then((function(t){if(1===t.deletedCount){var a=s.filter((function(t){return t.qa._id!==e._id}));u(a),A(D-1)}else console.error("delete qa failed. Either none deleted or more than 1 QAs deleted.")})).catch((function(e){console.log(e),alert('Failed deleting the QA. You may click the "Refresh" button of the brower and try again'),alert(JSON.stringify(e))}))},save_qa:function(e,t){r&&r.token&&new xe(r.token).updateQA(e,t).then((function(e){return e.json()})).then((function(e){1===e.nModified?u(s):console.error("save qa failed. Either none saved or more than 1 QAs saved.")})).catch((function(e){console.log(e),alert(JSON.stringify(e))}))},user:r}):l.a.createElement(He,{msg:"please login"}),l.a.createElement("div",{className:"qalist-pagenation"},l.a.createElement(Ie.a,{count:x,page:j,onChange:function(e,t){w(t)}}),l.a.createElement("div",{className:"total-count"},"N=",D))))}var We=a(225),Ge=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/users",this.token=t}return Object(s.a)(e,[{key:"getAllUsers",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getUserByUserId",value:function(e){var t="".concat(this.url,"/userid/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"updateUser",value:function(e){console.log("updating a user",e);var t="".concat(this.url,"/userid/").concat(e.userid,"?token=").concat(this.token);return console.log("url==>",t),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}]),e}(),Ve=a(224),Ze=a(169),Ke=a(238),$e=Object(h.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3)}}}));function Xe(e,t){var a={};return e.forEach((function(e){a[e]=t.indexOf(e)>-1})),a}function et(e){console.log("CheckBoxSelectorDlg()");var t=e.open,a=e.handleClose,o=e.title,r=e.list,i=e.selected,s=$e(),u=l.a.useState(Xe(r,i)),m=Object(f.a)(u,2),p=m[0],h=m[1];Object(n.useEffect)((function(){h(Xe(r,i))}),[r,i,t]);var g=function(e){h(Object(d.a)({},p,Object(c.a)({},e.target.name,e.target.checked)))};return l.a.createElement(O.a,{open:t,className:"checkbox-selector-dlg"},l.a.createElement(Ye.a,{className:"checkbox-selector-dlg-title"},o),l.a.createElement(Ue.a,null,l.a.createElement("div",{className:s.root},l.a.createElement(me.a,{component:"fieldset",className:s.formControl},l.a.createElement(Ze.a,null,Object.keys(p).map((function(e){return l.a.createElement(Ve.a,{key:e,control:l.a.createElement(Ke.a,{checked:p[e],onChange:g,name:e}),label:e})})))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){var e=[];Object.keys(p).forEach((function(t){p[t]&&e.push(t)})),a(e)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(157);var tt=Object(h.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),at=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function nt(e,t){return!!function(e,t){if(console.log("label===>",e),console.log("value===>",t),console.log("typeof value===>",typeof t),!t||"string"===typeof t&&""===t.trim())return alert('"'.concat(e,'" field cannot be empty')),!1;if(isNaN(t))return alert('"'.concat(e,'" is not a number')),!1;var a=Number(t);return!!Number.isInteger(a)||(alert('"'.concat(e,'" is not an integer number')),!1)}(e,t)&&(!(parseInt(t)<1)||(alert('"'.concat(e,'" is not a positive integer number')),!1))}function lt(e){var t=e.open,a=e.handleClose,o=e.user;te.log("UseSettings()");var r=tt(),i=function(){a(null)},s={notify_planq_list:!1,planq_num_of_cases_per_page:10,qalist_num_of_cases_per_page:10,notify_qa_new:!1,notify_qa_completed_all:!1,notify_aria_rx_change:!1,notify_aria_plan_change:!1,notify_aria_structure_change:!1,notify_for_all_patients:!1,planner:!1,doctor:!1,aria_userid:"",my_machines:le.a?le.a.machine_list.join(","):""},u=Object(n.useState)(s),m=Object(f.a)(u,2),p=m[0],h=m[1],g=Object(n.useState)(!1),y=Object(f.a)(g,2),C=y[0],w=y[1],N=function(e){"checkbox"===e.target.type?h(Object(d.a)({},p,Object(c.a)({},e.target.name,e.target.checked))):h(Object(d.a)({},p,Object(c.a)({},e.target.name,e.target.value))),w(!0)},P=Object(n.useCallback)(Object(z.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("UserSettingsDlg - fetchList()"),o.userid){t.next=4;break}return console.log("fetchData -> User not logged in. Returing...."),t.abrupt("return");case 4:new Ge(e.user.token).getUserByUserId(e.user.userid).then((function(e){return e.json()})).then((function(e){e&&e.settings&&(e.settings.my_machines&&""!==e.settings.my_machines.trim()||le.a&&(e.settings.my_machines=le.a.machine_list.join(",")),h(Object(d.a)({},p,{},e.settings))),w(!1)})).catch((function(e){alert('Failed fetching user data. You may click "Refresh" button in the browser & try again'),alert(JSON.stringify(e))}));case 6:case"end":return t.stop()}}),t)}))),[o,t]);Object(n.useEffect)((function(){console.log("UserSettingsDlg--\x3euseEffect()"),P()}),[t,o,P]);var D=Object(n.useState)(!1),A=Object(f.a)(D,2),M=A[0],x=A[1];return l.a.createElement(O.a,{fullScreen:!0,open:t,onClose:i,TransitionComponent:at},l.a.createElement(me.a,{className:r.formControl},l.a.createElement(_.a,{className:r.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:i,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:r.title},"Use Settings"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("handleApply"),nt("PlanQ - Number of cases per page",p.planq_num_of_cases_per_page)&&nt("QA - Number of cases per page",p.qalist_num_of_cases_per_page)&&(console.log("setting dirty to false"),w(!1),console.log("settings========>",p),a(p))},disabled:!C},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:i},"Cancel")))),l.a.createElement("div",{className:"user-settings-content"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"About Me"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Email: ",o.email),l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Name: ",o.name),l.a.createElement("div",{className:"item-helper-text"},"(If the email/name above is not correct, please contact the administrator)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a planner"),l.a.createElement(We.a,{name:"planner",checked:p.planner,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a doctor"),l.a.createElement(We.a,{name:"doctor",checked:p.doctor,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Machines"),l.a.createElement("div",{className:"item-input"},l.a.createElement("span",null,p.my_machines),l.a.createElement("button",{onClick:function(){return x(!0)}},"..."))),l.a.createElement("div",{className:"item-helper-text"},"(If blank, it means I am interested in all machines)"),l.a.createElement(et,{open:M,handleClose:function(e){if(e){var t=e.join(",");h(Object(d.a)({},p,{my_machines:t})),w(!0)}x(!1)},title:"Select Machines",list:le.a?le.a.machine_list:[],selected:p.my_machines.split(",")})),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"PlanQ"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Send me PlanQ list every morning"),l.a.createElement(We.a,{name:"notify_planq_list",checked:p.notify_planq_list,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of cases per page"),l.a.createElement("input",{name:"planq_num_of_cases_per_page",value:p.planq_num_of_cases_per_page,className:"item-input",onChange:N}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"QA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all new QA creations"),l.a.createElement(We.a,{name:"notify_qa_new",checked:p.notify_qa_new,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all QA completions"),l.a.createElement(We.a,{name:"notify_qa_completed_all",checked:p.notify_qa_completed_all,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of QA items per page"),l.a.createElement("input",{name:"qalist_num_of_cases_per_page",value:p.qalist_num_of_cases_per_page,className:"item-input",onChange:N}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"ARIA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Aria User Id"),l.a.createElement("input",{name:"aria_userid",value:p.aria_userid,className:"item-input",onChange:N})),l.a.createElement("div",{className:"item-helper-text"},"(If ARIA User Id is not entered or incorrect, no ARIA notifiation will be sent)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Prescription")," changes"),l.a.createElement(We.a,{name:"notify_aria_rx_change",checked:p.notify_aria_rx_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Plan")," changes"),l.a.createElement(We.a,{name:"notify_aria_plan_change",checked:p.notify_aria_plan_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Structure")," changes"),l.a.createElement(We.a,{name:"notify_aria_structure_change",checked:p.notify_aria_structure_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for the changes in ",l.a.createElement("u",null,"all monitored patients")),l.a.createElement(We.a,{name:"notify_for_all_patients",checked:p.notify_for_all_patients,className:"item-input",size:"small",onChange:N}),l.a.createElement("div",{className:"item-helper-text"},"(Monitored patients are those in the PlanQ with its newstart date is today or later)"))),"  ")," ",l.a.createElement(j.a,null)))}a(158);var ot=Object(h.a)((function(e){return{root:{},menuButton:{marginRight:2},title:{marginLeft:e.spacing(2),flex:1}}})),rt=Object(g.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return l.a.createElement(Ae.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),ct=Object(g.a)((function(e){return{root:{}}}))(Me.a);function it(e){te.log("Header()");var t=ot(),a=e.user,o=e.update_planlist,r=e.setUser,c=e.set_filter,i=function(){return!(!a||!a.userid)},s=Object(n.useState)(!1),u=Object(f.a)(s,2),m=u[0],p=u[1],h=Object(n.useState)(!1),g=Object(f.a)(h,2),y=g[0],j=g[1],O=Object(n.useState)(!1),w=Object(f.a)(O,2),N=w[0],S=w[1],D=function(){S(!0)},A=Object(n.useState)(!1),M=Object(f.a)(A,2),x=M[0],I=M[1],Y=l.a.useState(null),U=Object(f.a)(Y,2),q=U[0],T=U[1],R=function(){T(null)},F=function(){console.log("add a case"),e.onclick_addplan(),R()},B=function(){j(!0),R()},H=function(e){console.log("updating user settings============>",e),new Ge(e.token).updateUser({userid:e.userid,settings:e.settings}).then((function(e){})).catch((function(e){console.error(e),alert('Failed saving user settings. You may click "Refresh" button of the browser & try again'),alert(JSON.stringify(e))}))},z=Object(n.useState)(!1),J=Object(f.a)(z,2),G=J[0],V=J[1];Object(n.useEffect)((function(){var e=a&&a.settings&&a.settings.planq_search_keyword?a.settings.planq_search_keyword:"";X(e)}),[a]);var Z=Object(n.useState)(""),K=Object(f.a)(Z,2),$=K[0],X=K[1];return l.a.createElement("div",{className:t.root},l.a.createElement(_.a,{position:"static"},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(e){T(e.currentTarget)},disabled:!i()},l.a.createElement(C.a,null)),l.a.createElement(rt,{id:"customized-menu",anchorEl:q,keepMounted:!0,open:Boolean(q),onClose:R},l.a.createElement(ct,{onClick:F},l.a.createElement(L.a,null,l.a.createElement(W.a,{fontSize:"small"})),l.a.createElement(P.a,{primary:"Add Case"})),l.a.createElement(ct,{onClick:function(){console.log("email list to me"),e.onclick_email_planq_list_to_me(),R()}},l.a.createElement(L.a,null,l.a.createElement(Se.a,{fontSize:"small"})),l.a.createElement(P.a,{primary:"Email List to Me"})),l.a.createElement(ct,{onClick:B},l.a.createElement(L.a,null,l.a.createElement(we.a,{fontSize:"small"})),l.a.createElement(P.a,{primary:"Sim List"})),l.a.createElement(Ee,{open:y,handleClose:function(){j(!1)},addplan:e.addplan,user:e.user}),l.a.createElement(ct,{onClick:D},l.a.createElement(L.a,null,l.a.createElement(De.a,{fontSize:"small"})),l.a.createElement(P.a,{primary:"QA List"})),l.a.createElement(Je,{open:N,handleClose:function(){S(!1),R()},user:a})),l.a.createElement(v.a,{variant:"h6",className:t.title},"PlanQ - ",le.a.site),l.a.createElement("div",{className:"search-wriapper"},l.a.createElement("input",{className:"search-box",placeholder:"Search",value:$,onChange:function(e){X(e.target.value)},disabled:!i()}),l.a.createElement(b.a,{color:"inherit",onClick:function(){a.settings.planq_search_keyword=$,H(a),r(a),console.log("handleSearch===============>")},disabled:!i()},"Update")),l.a.createElement(b.a,{color:"inherit",onClick:F,disabled:!i()},"Add"),l.a.createElement(b.a,{color:"inherit",onClick:B,disabled:!i()},"Sim"),l.a.createElement(b.a,{color:"inherit",onClick:D,disabled:!i()},"QA"),l.a.createElement(b.a,{id:"button_filter",color:"inherit",onClick:function(){p(!0)},disabled:!i()},"FILTERS"),l.a.createElement(Q,{open:m,handleClose:function(e){e&&c(e),p(!1)},set_filter:e.set_filter,filter:e.filter}),l.a.createElement(b.a,{color:"inherit",onClick:function(){o()},disabled:!i()},"REFRESH"),i()?l.a.createElement("div",null,l.a.createElement(b.a,{color:"inherit",onClick:function(){V(!0)}},"Settings"),l.a.createElement(lt,{open:G,handleClose:function(e){e&&(a.settings=Object(d.a)({},a.settings,{},e),H(a),r(a)),V(!1)},user:a}),l.a.createElement(b.a,{color:"inherit",onClick:function(){console.log("Logout!"),r({})}},"LOGOUT[",e.user.userid,"]")):l.a.createElement(b.a,{id:"button_login",color:"inherit",onClick:function(){I(!0)}},"LOGIN"),l.a.createElement(je,{loginOpen:x,handleLoginClose:function(){I(!1)},user:a,setUser:r}))))}var st=a(112),ut={root:{margin:0,padding:10,textAlign:"center"}},mt=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement(st.a,{style:ut.root},l.a.createElement(v.a,{component:"p"},"Confidential. Version 1.0.0 (May 2020)"))}}]),t}(n.Component),pt=a(230),dt=a(242),ft=a(227),ht=a(228),gt=a(231),_t=a(110),Et=a.n(_t),vt=a(70),bt=(a(159),Object(g.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(dt.a)),kt=Object(g.a)({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:56,"&$expanded":{minHeight:56}},content:{"&$expanded":{margin:"12px 0"}},expanded:{}})(ft.a),yt=Object(g.a)((function(e){return{root:{padding:e.spacing(2)}}}))(ht.a);function Ct(e){var t=l.a.useState(""),a=Object(f.a)(t,2),n=a[0],o=a[1],r=e.log,c=r.msg.trim(),i=c.substring(1,c.length-1).split(","),s=[];i.forEach((function(e){var t=e.split(" by ");if(2===t.length){var a=t[1].split(" ")[0];s.push(a)}}));var u=Object(vt.a)(new Set(s)).join("/"),m=[];i.forEach((function(e){var t=e.split(" at ");if(2===t.length){var a=t[1].trim();m.push(a)}}));var p=Object(vt.a)(new Set(m)).join("/"),d=[];r.title.toLowerCase().includes("status changed")&&i.forEach((function(e){var t=e.split("->");if(2===t.length){var a=t[1].trim().split(" ")[0];d.push(a)}}));var h,g=Object(vt.a)(new Set(d)).join("/");return 0===g.length?[u,p].join(","):[].join(","),l.a.createElement(bt,{square:!0,expanded:"panel1"===n,onChange:(h="panel1",function(e,t){o(!!t&&h)})},l.a.createElement(kt,{"aria-controls":"panel1d-content",id:"panel1d-header"},l.a.createElement("ul",{className:"log-heading"},l.a.createElement("li",{className:"log-title"},r.title),l.a.createElement("li",{className:"log-who"},u),l.a.createElement("li",{className:"log-status"},g),l.a.createElement("li",{className:"log-time"},p))),l.a.createElement(yt,null,l.a.createElement("ul",null,i.map((function(e){return l.a.createElement("li",{key:Object(ae.a)()},e)})))))}var jt=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/logs",this.token=t}return Object(s.a)(e,[{key:"getLogsOfObject",value:function(e){var t="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"addLogOfObject",value:function(e,t){var a="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:t})}}]),e}(),Ot=Object(h.a)((function(e){return{list:{width:"100%",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),wt=l.a.forwardRef((function(e,t){return l.a.createElement(w.a,Object.assign({direction:"up",ref:t},e))}));function Nt(e){var t=e.open,a=e.handleClose;te.log("AriaActivityList()");var o=Ot(),r=e.object_id,c=l.a.useState([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=function(){te.log("AriaActivityList()->fetchList()->props.user",e.user),new jt(e.user.token).getLogsOfObject(e.object_id).then((function(e){return e.json()})).then((function(e){u(e)})).catch((function(e){console.log("Failed fetching ARIA activity list",e)}))};Object(n.useEffect)((function(){m()}),[r,t]);return l.a.createElement(O.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:wt},l.a.createElement(me.a,{className:o.formControl},l.a.createElement(_.a,{className:o.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:o.title},"Activities"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){m()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),l.a.createElement("div",null,s.map((function(e){return l.a.createElement(Ct,{key:e._id,log:e})}))))}var St={root:{width:"100%"},list:{width:"100%"},LogTextField:{width:"100%"},logToolbar:{width:"100%",borderWidth:1},listitem:{margin:0,padding:0}},Pt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).change_handler=function(e){a.setState({input_text:e.target.value})},a.keyup=function(e){if(13===e.keyCode){var t=e.target.value;a.props.addlog(a.props.planitem,t),a.setState({input_text:""})}},a.state={input_text:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=new X;return l.a.createElement("div",{style:St.root},l.a.createElement(ve.a,{fullWidth:!0,style:St.LogTextField,label:"Log",margin:"normal",variant:"outlined",value:this.state.input_text,placeholder:"Type your log & hit Enter key",InputLabelProps:{shrink:!0},onChange:this.change_handler,onKeyUp:this.keyup}),l.a.createElement("div",{style:St.list},l.a.createElement(A.a,{component:"nav","aria-label":"main mailbox folders"},this.props.planitem.plan.logs&&this.props.planitem.plan.logs.map((function(a){return l.a.createElement(D.a,{button:!0,style:St.listitem,key:a.at},l.a.createElement(P.a,{primary:"[".concat(t.MM_DD(new Date(a.at)),"] ").concat(a.msg)}),l.a.createElement(b.a,{onClick:function(){e.props.removelog(e.props.planitem,a)}},"X"))})))))}}]),t}(n.Component),Dt=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/aria/plansetups",this.token=t}return Object(s.a)(e,[{key:"getAllPlanSetupsPerPatientId",value:function(e){var t="".concat(this.url,"/PlanSetupsPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}}]),e}();a(160);function At(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,i=Object(n.useState)([]),s=Object(f.a)(i,2),u=s[0],m=s[1],p=Object(n.useState)({}),h=Object(f.a)(p,2),g=h[0],_=h[1],E=function(e){_(Object(d.a)({},g,Object(c.a)({},e.target.name,e.target.checked)))};Object(n.useEffect)((function(){console.log("useEffect()"),v(r)}),[r,t]);var v=function(t){(console.log("PlanSetupSelector - fetchList()"),o.userid)?new Dt(e.user.token).getAllPlanSetupsPerPatientId(t).then((function(e){return e.json()})).then((function(e){m(e)})).catch((function(e){alert(JSON.stringify(e))})):console.log("fetchList -> User not logged in. Returing....")};return l.a.createElement(O.a,{open:t,className:"plan-setup-selector-dlg"},l.a.createElement(Ye.a,{className:"plan-setup-selector-dlg-title"},"Select Plan"),l.a.createElement(Ue.a,null,l.a.createElement(me.a,{component:"fieldset"},u.map((function(e){var t=e.CourseId+"/"+e.PlanSetupId;return l.a.createElement(Ve.a,{key:Object(ae.a)(),control:l.a.createElement(Ke.a,{checked:g[t],onChange:E,name:t,color:"primary"}),label:t})})))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){var e=[];Object.keys(g).forEach((function(t){g[t]&&e.push(t)})),a(e.join(","))},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}var Mt=a(237),xt=a(229);a(161);function It(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=Object(n.useState)([]),i=Object(f.a)(c,2),s=i[0],u=i[1],m=Object(n.useState)({}),p=Object(f.a)(m,2),d=p[0],h=p[1];Object(n.useEffect)((function(){console.log("useEffect()"),g(r)}),[r,t]);var g=function(t){(console.log("PlanSetupSelector - fetchList()"),o.userid)?new Dt(e.user.token).getAllPlanSetupsPerPatientId(t).then((function(e){return e.json()})).then((function(e){u(e)})).catch((function(e){alert(JSON.stringify(e))})):console.log("fetchList -> User not logged in. Returing....")};return l.a.createElement(O.a,{open:t,className:"plan-setup-selector-dlg"},l.a.createElement(Ye.a,{className:"plan-setup-selector-dlg-title"},"Select Plan"),l.a.createElement(Ue.a,null,l.a.createElement(me.a,{component:"fieldset"},l.a.createElement(xt.a,{className:"plansetupselector-radiogroup","aria-label":"plansetuplist",name:"plansetuplist",value:d,onChange:function(e){h(e.target.value)}},s.map((function(e){var t=e.CourseId+"/"+e.PlanSetupId;return l.a.createElement(Ve.a,{key:Object(ae.a)(),value:t,control:l.a.createElement(Mt.a,null),label:t})}))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(d)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(162);function Lt(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=["PD","MapCheck","Film"],i=l.a.useState(c[0]),s=Object(f.a)(i,2),u=s[0],m=s[1],p=l.a.useState(""),d=Object(f.a)(p,2),h=d[0],g=d[1],_=Object(n.useState)(!1),E=Object(f.a)(_,2),v=E[0],k=E[1],y=Object(n.useState)({open:!1,title:"",msg:"",error:!1}),C=Object(f.a)(y,2),j=C[0],w=C[1],N=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];w({open:!0,title:e,msg:t,error:a})};return l.a.createElement("div",null,l.a.createElement(O.a,{open:t,className:"add-qa-dlg"},l.a.createElement(Ye.a,{className:"add-qa-dlg-title"},"New QA"),l.a.createElement(Ue.a,null,l.a.createElement(me.a,{component:"fieldset"},l.a.createElement("label",{className:"qa-type-label"}," QA Type:"),l.a.createElement(xt.a,{className:"radiogroup-qa-type",value:u,onChange:function(e){m(e.target.value)}},c.map((function(e){return l.a.createElement(Ve.a,{value:e,key:Object(ae.a)(),control:l.a.createElement(Mt.a,null),label:e})}))),l.a.createElement("label",{className:"qa-plan-label"},"QA Plan:"),l.a.createElement(ve.a,{className:"text-field-qa-plan-name",value:h,InputLabelProps:{shrink:!0},onClick:function(){k(!0)},helperText:"Click to select a QA plan"}),l.a.createElement(It,{open:v,handleClose:function(e){console.log("handlePlanSetupSelectorDlgClose()",e),e&&g(e),k(!1)},user:o,PatientId:r}))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){""!==h?a({type:u,plan:h}):N("Error","Please select a QA plan",!0)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel"))),l.a.createElement(Te,{open:j.open,handleClose:function(){return w({open:!1,title:"",msg:"",error:!1})},title:j.title,msg:j.msg,buttons:"Ok",error:j.error}))}var Yt=l.a.createContext();function Ut(e,t){var a=t.type,n=t.data,l=t.user;switch(a){case"set-list":return n;case"add-item":if(console.log("add-item",n),!l||!l.token)return;new xe(l.token).addQA(n).then((function(e){return e.json()})).then((function(t){var a={qa:t,dirty:!1};return[].concat(Object(vt.a)(e),[a])})).catch((function(e){console.log(e),alert(JSON.stringify(e))}))}}var qt=function(e){var t=e.user,a=Object(n.useReducer)(Ut,[]),o=Object(f.a)(a,2),r=o[0],c=o[1];return Object(n.useEffect)((function(){!function(e){e&&e.token&&new xe(e.token).getQAs().then((function(e){return e.json()})).then((function(e){var t=e.map((function(e){return{qa:e,dirty:!1}}));c({type:"set-list",data:t})})).catch((function(e){console.log(e),alert(JSON.stringify(e))}))}(t)}),[t]),l.a.createElement(Yt.Provider,{value:{qaList:r,qaListDispatch:c}},e.children)};a(163),a(164);function Tt(e){var t=e.open,a=e.handleClose,o=e.title,r=e.initialValue,c=e.searchList,i=Object(n.useState)(r),s=Object(f.a)(i,2),u=s[0],m=s[1],p=l.a.useState([]),d=Object(f.a)(p,2),h=d[0],g=d[1],_=function(e){console.log("item clicked",e.target);var t=e.target.innerText;m(t)};return l.a.createElement(O.a,{open:t},l.a.createElement(Ye.a,{id:"alert-dialog-title"},o),l.a.createElement(Ue.a,null,l.a.createElement("div",{className:"search-wrapper"},l.a.createElement("div",{className:"search-input-wrapper"},l.a.createElement("input",{className:"search-input",type:"text",placeholder:"Search",value:u,onChange:function(e){var t=e.target.value;m(t);var a=c.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())}));g(a)}})),l.a.createElement("div",{className:"matched-list"},h.map((function(e){return l.a.createElement("div",{key:e,onClick:_},e)}))))),l.a.createElement(Le.a,null,l.a.createElement(b.a,{onClick:function(){a(u)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}var Rt=a(218),Ft=a(245),Qt=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/email",this.token=t}return Object(s.a)(e,[{key:"send",value:function(e){return console.log("sending an email",e),fetch("".concat(this.url,"?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"send_dailydigest",value:function(){return fetch("".concat(this.url,"/dailydigest?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})}}]),e}(),Bt={PaperProps:{style:{maxHeight:224,width:250}}};function Ht(e){return e&&""!==e.trim()?e.split(",").filter((function(e){return""!==e.trim()})).map((function(e){return e.split("|")[0]})).map((function(e){return function(e){if(!e.includes("."))return e;var t=e.split(".");return(t[0][0]+t[1][0]).toUpperCase()}(e)})).join(","):""}function zt(e){return e.filter((function(e){return""!==e.trim()}))}var Jt=Object(h.a)((function(e){return{root:{width:"100%"},heading:{fontSize:15},expensionPanelSummary:{backgroundColor:"#f1f1f1",borderWidth:1},PlanLogList:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120}}}));function Wt(e){var t=Jt(),a=e.user,o=e.planitem,r=Object(n.useContext)(Yt).qaListDispatch,i=Object(n.useState)(o.plan),s=Object(f.a)(i,2),u=s[0],m=s[1],p=Object(n.useState)(!1),h=Object(f.a)(p,2),g=h[0],_=h[1],E=function(e){v(e.target.name,e.target.value)},v=function(e,t){m(Object(d.a)({},u,Object(c.a)({},e,t))),_(!0)},k=Object(n.useState)(!1),y=Object(f.a)(k,2),C=y[0],O=y[1],w=function(){O(!C)},N=Object(n.useState)(!1),S=Object(f.a)(N,2),D=S[0],A=S[1],M=Object(n.useState)(!1),x=Object(f.a)(M,2),I=x[0],L=x[1],Y=(Date.parse(u.newstart)-new Date)/1e3/60/60/24/30,U=Object(n.useState)(!1),q=Object(f.a)(U,2),T=q[0],R=q[1],F=Object(n.useState)(!1),Q=Object(f.a)(F,2),B=Q[0],H=Q[1],z=Object(n.useState)(!1),J=Object(f.a)(z,2),W=J[0],G=J[1],V=u&&u.doctors&&a&&a.email&&u.doctors.toLowerCase().includes(a.email.toLowerCase())?"doctors highlight":"doctors",K=u&&u.planners&&a&&a.email&&u.planners.toLowerCase().includes(a.email.toLowerCase())?"planners highlight":"doctors";return l.a.createElement(dt.a,{expanded:C},l.a.createElement(ft.a,{expandIcon:l.a.createElement(Et.a,null),"aria-controls":u._id+"content",id:u._id+"header",className:t.expensionPanelSummary,onClick:w},l.a.createElement("ul",{className:"heading"},l.a.createElement("li",{className:"newstart"},Y<6?Z.MM_DD_DAY(new Date(u.newstart)):"TBD"),l.a.createElement("li",{className:"lastname"},u.case_name.split("-")[0]),l.a.createElement("li",{className:"status"},u.status),l.a.createElement("li",{className:V},Ht(u.doctors)),l.a.createElement("li",{className:K},Ht(u.planners)),l.a.createElement("li",{className:"tx_site"},u.tx_site),l.a.createElement("li",{className:"tx_modality"},u.modality),l.a.createElement("li",{className:"tx_machine"},u.machine),l.a.createElement("li",{className:"note"},u.note))),l.a.createElement(ht.a,null,l.a.createElement(pt.a,{container:!0,direction:"row",justify:"center",alignItems:"center"},l.a.createElement("form",{className:"plan-form",noValidate:!0},l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-casename",label:"Case",name:"case_name",value:u.case_name,InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-newstart",type:"datetime-local",label:"New Start",name:"newstart",defaultValue:Z.YYYY_MM_DDTHH_MM(new Date(u.newstart)),InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-plan-status",select:!0,name:"status",label:"Status",value:u.status,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"status_not_selected",value:""}),le.a&&le.a.plan_status_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-plan-name",label:"Plan Name",value:u.plan_name,InputLabelProps:{shrink:!0},onClick:function(){R(!0)}})),l.a.createElement(At,{open:T,handleClose:function(e){console.log("handlePlanSetupSelectorDlgClose.result=======",e),null!==e&&v("plan_name",e),R(!1)},user:a,PatientId:u.case_name.split("-")[1]}),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-tx-modality",select:!0,label:"Modality",name:"modality",value:u.modality,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"modality_not_selected",value:""}),le.a&&le.a.tx_modality_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(Ft.a,{id:"doctors-label"},"Doctors"),l.a.createElement(pe.a,{labelId:"doctors-label",id:"doctors-checkbox-list",multiple:!0,value:u.doctors.split(","),onChange:function(e){return v("doctors",zt(e.target.value).join(","))},input:l.a.createElement(Rt.a,null),renderValue:function(e){return Ht(e.join(","))},MenuProps:Bt},le.a&&le.a.doctor_list.map((function(e){return l.a.createElement(Me.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:u.doctors.split(",").indexOf(e)>-1}),l.a.createElement(P.a,{primary:e.split("|")[0]}))})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(Ft.a,{id:"planners-label"},"Planners"),l.a.createElement(pe.a,{labelId:"planners-label",id:"planners-checkbox-list",multiple:!0,value:u.planners.split(","),onChange:function(e){return v("planners",zt(e.target.value).join(","))},input:l.a.createElement(Rt.a,null),renderValue:function(e){return Ht(e.join(","))},MenuProps:Bt},le.a.planner_list.map((function(e){return l.a.createElement(Me.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:u.planners.split(",").indexOf(e)>-1}),l.a.createElement(P.a,{primary:e.split("|")[0]}))})))),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-tx-site",label:"Tx Site",name:"tx_site",value:u.tx_site,onChange:E,onClick:function(){return G(!0)},InputLabelProps:{shrink:!0},InputProps:{disabled:!0}})),l.a.createElement(Tt,{open:W,handleClose:function(e){e&&v("tx_site",e),G(!1)},title:"Treatment Site",initialValue:u.tx_site,searchList:le.a.tx_site_list}),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-sim-date",type:"date",label:"Sim",name:"sim",defaultValue:Z.YYYY_MM_DD(new Date(u.sim.replace("Z",""))),InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(me.a,{className:t.formControl},l.a.createElement(ve.a,{className:"text-field-machine",select:!0,name:"machine",label:"Machine",value:u.machine,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"machine_not_selected",value:""}),le.a&&le.a.machine_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(me.a,{className:t.formControl,fullWidth:!0},l.a.createElement(ve.a,{className:"text-field-note",label:"Short Comment",name:"note",value:u.note?u.note:"",fullWidth:!0,variant:"outlined",onChange:E,InputLabelProps:{shrink:!0}}))),l.a.createElement(Pt,{className:t.PlanLogList,planitem:e.planitem,addlog:function(t,a){e.addlog(t,a),_(!0)},removelog:function(t,a){e.removelog(t,a),_(!0)}}))),l.a.createElement(j.a,null),l.a.createElement(gt.a,null,l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",disabled:!g,onClick:function(){e.saveplan_handler({plan:u,dirty:!1}),_(!1),w()}},"Save"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){e.duplicateplan_handler(e.planitem),w()}},"Duplicate"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){L(!0)}},"Delete"),l.a.createElement(Te,{id:"delete_dialog",open:I,title:"Are you sure?",buttons:"Yes|No",handleClose:function(t){"Yes"===t&&e.deleteplan_handler(e.planitem),L(!1)}}),l.a.createElement(b.a,{id:"button_add_qa",size:"small",color:"primary",variant:"outlined",onClick:function(){H(!0)}},"Add QA"),l.a.createElement(Lt,{open:B,handleClose:function(e){if(e){var t={id:Object(ae.a)(),type:e.type,plan:e.plan,result:"",requested_by:"".concat(a.name,"|").concat(a.email,"|").concat(a.userid),requested_on:new Date,completed_by:"",completed_on:null,due_on:new Date(u.newstart),plan_case_name:u.case_name,plan_case_id:u._id,machine:u.machine,notes:""};r({type:"add-item",data:t,user:a})}H(!1)},user:a,PatientId:u.case_name.split("-")[1]}),l.a.createElement(b.a,{id:"button_email_group",size:"small",color:"primary",variant:"outlined",onClick:function(){!function(e,t){console.log("email_plan====>",e);var a=(Date.parse(e.newstart)-new Date)/1e3/60/60/24/30<6?Z.MM_DD_DAY(new Date(e.newstart)):"TBD",n=e.case_name,l=e.status,o=e.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),r=e.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=e.tx_site,i=e.modality,s=e.machine,u=e.note,m=[];m.push("Patient = "+n),m.push("Start Date = "+a),m.push("Status = "+l),m.push("Doctors="+o),m.push("Planners = "+r),m.push("Tx Site = "+c),m.push("Modality = "+i),m.push("Machine = "+s),m.push("Notes = "+u);var p=m.join("\n"),d={from:"radonc.physics@stonybrookmedicine.edu",to:t.email,subject:n.split("-")[0],text:p};new Qt(t.token).send(d)}(u,a)}},"Email Me"),l.a.createElement(b.a,{id:"button_view_auto_activities",size:"small",color:"primary",variant:"outlined",onClick:function(){return A(!0)}},"Activities"),l.a.createElement(Nt,{open:D,handleClose:function(){return A(!1)},object_id:u.case_name.split("-")[1],user:e.user})))}a(165);function Gt(e){var t=e.pagenation,a=e.setPage,n=t.page,o=t.totalCount,r=t.itemsPerPage,c=o%r>0?Math.floor(o/r)+1:Math.floor(o/r);return l.a.createElement(st.a,{className:"planlist-wrapper"},l.a.createElement("div",{className:"planlist"},e.planitems.map((function(t){return l.a.createElement(Wt,{key:t.plan._id,planitem:t,date_change_handler:e.date_change_handler,deleteplan_handler:e.deleteplan_handler,saveplan_handler:e.saveplan_handler,duplicateplan_handler:e.duplicateplan_handler,addlog:e.addlog,removelog:e.removelog,user:e.user,set_planitems_state:e.set_planitems_state})}))),l.a.createElement("div",{className:"planlist-pagenation"},l.a.createElement(Ie.a,{count:c,page:n,onChange:function(e,t){a(t)}}),l.a.createElement("div",{className:"total-count"},"N=",o)))}var Vt=function(){function e(t){Object(i.a)(this,e),this.url=le.a.webservice_url+"/plans",this.token=t}return Object(s.a)(e,[{key:"getAllPlans",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getAllPlans_newstart_gt",value:function(e){e=encodeURIComponent(e);var t="".concat(this.url,"/newstart/gt/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"getAllPlans_newstart_gt_lt",value:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);var a="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"?token=").concat(this.token);return fetch(a)}},{key:"getAllPlans_newstart_gt_lt_skip_limit",value:function(e,t,a,n){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n);var l="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/skip/").concat(a,"/limit/").concat(n,"?token=").concat(this.token);return fetch(l)}},{key:"getAllPlans_newstart_gt_lt_keyword_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_machines_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/machines/").concat(a,"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_keyword_machines_skip_limit",value:function(e,t,a,n,l,o){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l),o=encodeURIComponent(o);var r="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/machines/").concat(n,"/skip/").concat(l,"/limit/").concat(o,"?token=").concat(this.token);return fetch(r)}},{key:"getAllPlans_keyword_skip_limit",value:function(e,t,a){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a);var n="".concat(this.url,"/keyword/").concat(e.trim().toLowerCase(),"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token);return fetch(n)}},{key:"addPlan",value:function(e){return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updatePlan",value:function(e){var t=this.url+"/"+e._id+"?token=".concat(this.token);return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deletePlan",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),Zt=a(232);var Kt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).showMsg=function(e,t){var n,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.setState({msgBox:(n={open:!0,title:e,msg:t},Object(c.a)(n,"msg",t),Object(c.a)(n,"error",l),n)})},a.setPage=function(e){e!==a.pagenation.page&&(a.pagenation.page=e,a.update_planlist())},a.update_planlist_internal=function(e){var t=a.state.user;if(te.log("App--\x3eupdate_planlist()"),!t||!t.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});a.setState({showProgress:!0}),t.settings&&t.settings.planq_num_of_cases_per_page&&(a.pagenation.itemsPerPage=t.settings.planq_num_of_cases_per_page),new ue(a.state.user.token).getEnums().then((function(e){return e.json()})).then((function(t){a.enumList=t,a.enumList.tx_site_list.sort(),e().then((function(e){return e.json()})).then((function(e){a.pagenation.totalCount=e.totalCount;var t=e.list.map((function(e){return{plan:e,dirty:!1}}));a.setState({planitems:t,showProgress:!1})})).catch((function(e){console.error("getAllPlans failed",e),a.showMsg("Error","Failed getting planning data. Please contact the administrator.",!0)}))})).catch((function(e){console.error(),a.showMsg("Error","Failed getting the enumeration data. Please contact the administrator.",!0)}))},a.update_planlist=function(){console.log("update_planlist================>");var e=a.state.user;if(!e||!e.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});var t,n,l=!1;a.enumList?e.settings&&e.settings.my_machines&&(t=e.settings.my_machines.split(","),n=a.enumList.machine_list,t.length!==n.length||t.map((function(e){return e.trim()})).sort().join("")!==n.map((function(e){return e.trim()})).sort().join(""))&&(l=!0):e.settings&&e.settings.my_machines&&(l=!0);var o=e.settings&&e.settings.planq_search_keyword&&""!==e.settings.planq_search_keyword.trim()?e.settings.planq_search_keyword.trim():"";if(""!==o||l)if(""===o&&l){a.update_planlist_internal((function(){var t=Z.YYYY_MM_DD(a.filter.newstart_from),n=Z.YYYY_MM_DD(a.filter.newstart_to),l=e.settings.my_machines,o=a.pagenation,r=o.page,c=o.itemsPerPage,i=(r-1)*c,s=c;return new Vt(a.state.user.token).getAllPlans_newstart_gt_lt_machines_skip_limit(t,n,l,i,s)}))}else if(""===o||l)if(""!==o&&l){a.update_planlist_internal((function(){var t=a.pagenation,n=t.page,l=t.itemsPerPage,r=(n-1)*l,c=l,i=Z.YYYY_MM_DD(a.filter.newstart_from),s=Z.YYYY_MM_DD(a.filter.newstart_to),u=e.settings.my_machines;return console.log("keyword===>",o),console.log("machines===>",u),new Vt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_machines_skip_limit(i,s,o,u,r,c)}))}else console.log("Code should not reach this code block!!!");else{a.update_planlist_internal((function(){var e=a.pagenation,t=e.page,n=e.itemsPerPage,l=(t-1)*n,r=n,c=Z.YYYY_MM_DD(a.filter.newstart_from),i=Z.YYYY_MM_DD(a.filter.newstart_to);return console.log("keyword===>",o),new Vt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_skip_limit(c,i,o,l,r)}))}else{a.update_planlist_internal((function(){var e=Z.YYYY_MM_DD(a.filter.newstart_from),t=Z.YYYY_MM_DD(a.filter.newstart_to),n=a.pagenation,l=n.page,o=n.itemsPerPage,r=(l-1)*o,c=o;return new Vt(a.state.user.token).getAllPlans_newstart_gt_lt_skip_limit(e,t,r,c)}))}},a.onclick_addplan=function(){if(a.state.user.userid){var e=new Date,t={case_name:"NA",sim:e,status:"",newstart:e,plan_name:"",planners:"",doctors:"",tx_site:"",note:"",logs:[]};a.addplan(t)}else console.log("onclick_addplan=> User not Logged In")},a.addplan=function(e){a.state.user&&a.state.user.userid?new Vt(a.state.user.token).addPlan(e).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})):console.log("onclick_addplan=> User not Logged In")},a.onclick_email_planq_list_to_me=function(){if(a.state.user.userid){var e=[];a.state.planitems.forEach((function(t){var a=t.plan,n=(Date.parse(a.newstart)-new Date)/1e3/60/60/24/30<6?Z.MM_DD_DAY(new Date(a.newstart)):"TBD",l=a.case_name,o=a.status,r=a.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=a.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),i=a.tx_site,s="".concat(n,"\t").concat(l,"\t").concat(o,"\t").concat(r,"\t").concat(c,"\t").concat(i);e.push(s)}));var t={from:"radonc.physics@stonybrookmedicine.edu",to:a.state.user.email,subject:"PlanQ List",text:e.join("\n")};new Qt(a.state.user.token).send(t)}else console.log("onclick_email_planq_list_to_me=> User not Logged In")},a.onclick_deleteplan=function(e){a.state.user.userid?new Vt(a.state.user.token).deletePlan(e.plan).then((function(e){return e.json()})).then((function(t){var n=a.state.planitems.filter((function(t){return t.plan._id!==e.plan._id}));a.setState({planitems:n})})):console.log("onclick_deleteplan=> User not Logged In")},a.onclick_saveplan=function(e){if(a.state.user.userid){var t=new Vt(a.state.user.token);console.log("planitem.plan=",e.plan),t.updatePlan(e.plan).then((function(e){return e.json()})).then((function(t){e.dirty=!1,a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_saveplan=> User not Logged In")},a.onclick_duplicateplan=function(e){if(a.state.user.userid){var t={case_name:e.plan.case_name,sim:e.plan.sim,status:"",newstart:e.plan.newstart,plan_name:e.plan.plan_name,planners:e.plan.planners,doctors:e.plan.doctors,tx_site:e.plan.tx_site,machine:e.plan.machine,modality:e.plan.modality,note:e.plan.note,logs:e.plan.logs};new Vt(a.state.user.token).addPlan(t).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_duplicateplan=> User not Logged In")},a.addlog=function(e,t){if(te.log("addlog()"),a.state.user.userid){var n={msg:t,by:"",at:new Date};e.plan.logs.unshift(n),a.setState({planitems:a.state.planitems})}else console.log("addlog=> User not Logged In")},a.removelog=function(e,t){te.log("removelog()"),a.state.user.userid?(e.plan.logs=e.plan.logs.filter((function(e){return e.at!==t.at})),a.setState({planitems:a.state.planitems})):console.log("removelog=> User not Logged In")},a.set_filter=function(e){e&&(a.filter=e,console.log("set_filter=>",e),a.pagenation.page=1,a.update_planlist())},a.setUser=function(e){console.log("setUser()"),e&&e.token?(a.setState({user:e}),a.setPage(1),a.update_planlist()):a.setState({user:{},planitems:[]})},a.set_planitems_state=function(){a.setState({planitems:a.state.planitems})},document.querySelector("title").innerHTML="PlanQ - "+le.a.site,a.state={planitems:[],user:{},showProgress:!1,msgBox:{open:!1,title:"",msg:"",error:!1}},a.pagenation={itemsPerPage:10,page:1,totalCount:0};var n=new Date,l=new Date(n.getFullYear()+2,n.getMonth(),n.getDate());return a.filter={newstart_from:n,newstart_to:l,keyword:""},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){te.log("App--\x3ecomponentDidMount()"),this.update_planlist()}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(qt,{user:this.state.user},l.a.createElement(it,{onclick_addplan:this.onclick_addplan,onclick_email_planq_list_to_me:this.onclick_email_planq_list_to_me,set_filter:this.set_filter,addplan:this.addplan,user:this.state.user,setUser:this.setUser,update_planlist:this.update_planlist,filter:this.filter}),this.state.showProgress&&l.a.createElement(Zt.a,{color:"secondary"}),this.state.user&&this.state.user.userid?l.a.createElement(Gt,{planitems:this.state.planitems,date_change_handler:this.date_change_handler,deleteplan_handler:this.onclick_deleteplan,saveplan_handler:this.onclick_saveplan,duplicateplan_handler:this.onclick_duplicateplan,addlog:this.addlog,removelog:this.removelog,user:this.state.user,set_planitems_state:this.set_planitems_state,pagenation:this.pagenation,setPage:this.setPage}):l.a.createElement("h3",{className:"please-login"},"Please login (use your computer login id/pw)"),l.a.createElement(mt,null)),l.a.createElement(Te,{open:this.state.msgBox.open,handleClose:function(){return e.setState({msgBox:{open:!1,title:"",msg:"",error:!1}})},title:this.state.msgBox.title,msg:this.state.msgBox.msg,buttons:"Ok",error:this.state.msgBox.error}))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(Kt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t){}},[[137,1,2]]]);
//# sourceMappingURL=main.9bdc2c96.chunk.js.map
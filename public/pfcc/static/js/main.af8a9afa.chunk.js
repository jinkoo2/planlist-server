(this["webpackJsonpplanq-client1"]=this["webpackJsonpplanq-client1"]||[]).push([[0],{136:function(e,t,a){e.exports=a(165)},141:function(e,t,a){},142:function(e,t,a){},143:function(e,t,a){},149:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},153:function(e,t,a){},154:function(e,t,a){},155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){},164:function(e,t,a){},165:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(12),r=a.n(o),c=(a(141),a(22)),i=a(13),s=a(14),u=a(64),m=a(59),d=a(65),p=(a(142),a(20)),h=a(6),f=a(202),g=a(4),_=a(207),E=a(208),v=a(56),b=a(209),k=a(112),y=a(105),C=a.n(y),w=a(220),j=a(238),O=a(205),N=a(35),S=a.n(N),D=a(212),P=a(166),A=a(210),M=a(213),x=a(94),I=a.n(x),L=a(211),R=a(24),T=a(232),Y=a(62),U=(a(143),Object(f.a)((function(e){return{root:{},menuButton:{marginRight:2},textField_DateTime:{marginLeft:1,marginRight:1,width:180,textAlign:"center",color:"white"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}))),q=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function F(e){return e instanceof Date&&!isNaN(e)}function B(e){var t=U(),a=e.filter,n=e.handleClose,o=l.a.useState(a.newstart_from),r=Object(h.a)(o,2),c=r[0],i=r[1],s=l.a.useState(a.newstart_to),u=Object(h.a)(s,2),m=u[0],d=u[1],p=l.a.useState(a.keyword),f=Object(h.a)(p,2),g=f[0],y=(f[1],function(){n(null)});return l.a.createElement(R.a,{utils:Y.a},l.a.createElement(j.a,{fullScreen:!0,open:e.open,onClose:e.handleClose,TransitionComponent:q},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:y,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Filters"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){n({newstart_from:c,newstart_to:m,keyword:g})}},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:y},"Close"))),l.a.createElement(A.a,null,l.a.createElement(P.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(D.a,{primary:"New Start From"}),l.a.createElement(M.a,null,l.a.createElement(T.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_from",value:c,onChange:function(e){F(e)?i(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(w.a,null),l.a.createElement(P.a,{button:!0},l.a.createElement(L.a,null," ",l.a.createElement(I.a,null)," "),l.a.createElement(D.a,{primary:"New Start To"}),l.a.createElement(M.a,null,l.a.createElement(T.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-newstart_to",value:m,onChange:function(e){F(e)?d(e):console.log("date is not valid!!!")},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(w.a,null))))}var Q=a(68),H=a.n(Q),z=a(84),W=a(85),G=a.n(W),J=["SUN","MON","TUE","WED","THR","FRI","SAT"];function V(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var K=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"MM_DD_YYYY",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)}},{key:"MM_DD",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2);return"".concat(t,"/").concat(a)}},{key:"MM_DD_DAY",value:function(e){var t=V(e.getMonth()+1,2),a=V(e.getDate(),2),n=J[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")}},{key:"HH_MM_AMPM",value:function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)}},{key:"HH_MM",value:function(e){var t=V(e.getHours(),2),a=V(e.getMinutes(),2);return"".concat(t,":").concat(a)}},{key:"YYYY_MM_DD",value:function(e){var t=e.getFullYear(),a=V(e.getMonth()+1,2),n=V(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)}},{key:"YYYY_MM_DDTHH_MM",value:function(e){return this.YYYY_MM_DD(e)+"T"+this.HH_MM(e)}}]),e}(),Z=(a(149),["SUN","MON","TUE","WED","THR","FRI","SAT"]);function X(e,t){var a=t-e.toString().length+1;return Array(+(a>0&&a)).join("0")+e}var $=function e(){var t=this;Object(i.a)(this,e),this.MM_DD_YYYY=function(e){var t=e.getFullYear(),a=X(e.getMonth()+1,2),n=X(e.getDate(),2);return"".concat(a,"/").concat(n,"/").concat(t)},this.MM_DD=function(e){var t=X(e.getMonth()+1,2),a=X(e.getDate(),2);return"".concat(t,"/").concat(a)},this.MM_DD_DAY=function(e){var t=X(e.getMonth()+1,2),a=X(e.getDate(),2),n=Z[e.getDay()];return"".concat(t,"/").concat(a," [").concat(n,"]")},this.HH_MM_AMPM=function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"PM":"AM";return a=a<10?"0"+a:a,"".concat(t=(t%=12)||12,":").concat(a," ").concat(n)},this.HH_MM=function(e){var t=X(e.getHours(),2),a=X(e.getMinutes(),2);return"".concat(t,":").concat(a)},this.YYYY_MM_DD=function(e){var t=e.getFullYear(),a=X(e.getMonth()+1,2),n=X(e.getDate(),2);return"".concat(t,"-").concat(a,"-").concat(n)},this.YYYY_MM_DDTHH_MM=function(e){return t.YYYY_MM_DD(e)+"T"+t.HH_MM(e)}};a(150);function ee(e){var t=new $,a=e.txItem,n=t.MM_DD_DAY(new Date(a.ScheduledStartTime));return l.a.createElement("div",{className:"tx-item"},l.a.createElement("div",{className:"tx-start-time"},n),l.a.createElement("div",{className:"tx-activity-code"},a.ActivityCode),l.a.createElement("div",null,l.a.createElement("input",{type:"checkbox",id:"vehicle1",name:"vehicle1",onChange:function(t){console.dir(t.target),e.selectionChange(a,t.target.checked)}})))}var te=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"log",value:function(e,t){console.log(e,t)}},{key:"log",value:function(e){console.log(e)}}]),e}(),ae=a(239),ne={webservice_url:"https://roweb1.uhmc.sbuh.stonybrook.edu:3004/api",site:"PFCC",doctor_list:["Kartik.Mani|kartik.mani@stonybrookmedicine.edu|Mani","Samuel.Ryu|samuel.ryu@stonybrookmedicine.edu|Ryu","Alexander.Stessin|alexander.stessin@stonybrookmedicine.edu|Stessin","Edward.Valentine|edward.valentine@stonybrookmedicine.edu|Valentine","Alexander.Slade|alexander.slade@stonybrookmedicine.edu|Slade","Bernard.Newman|bernard.newman@stonybrookmedicine.edu|Newman","John.Roberson|john.roberson@stonybrookmedicine.edu|Roberson","Ewa.Zabrocka|ewa.zabrocka@stonybrookmedicine.edu|Zabrocka","Collin.Noldner|collin.noldner@stonybrookmedicine.edu|Noldner","Mark.Ashamalla|mark.ashamalla@stonybrookmedicine.edu|Ashamalla"],planner_list:["Donna.Serviss|donna.serviss@stonybrookmedicine.edu|Donna","Siming.Lu|siming.lu@stonybrookmedicine.edu|Siming","Xin.Qian|xin.qian@stonybrookmedicine.edu|Xin","Jinkoo.Kim|jinkoo.kim@stonybrookmedicine.edu|Jinkoo","Ting.Hsia|an.hsia@stonybrookmedicine.edu|Ting","Josh.Xu|zhigang.xu@stonybrookmedicine.edu|Josh","Sunny.Ailawadi|sandeep.ailawadi@stonybrookmedicine.edu|Sunny","Maria.Kartsonis|maria.kartsonis@stonybrookmedicine.edu|Maria","Todd.Yoder|todd.yoder@stonybrookmedicine.edu|Todd","Renee.Cattell|renee.cattell@stonybrook.edu|Renee","Gilbert.Chan|gilbert.chan@stonybrookmedicine.edu|Gil","Christine.Oh|christine.oh@stonybrookmedicine.edu|Christine","David.Kahn|david.kahn@stonybrookmedicine.edu|David"],machine_list:["TrueBeamSH"],tx_site_list:["Brain","Brain_Lt","Brain_Rt","Head","Neck","Skull","H&N","Tongue","Base_of_Tongue","Breast","Breast_Lt","Breast_Rt","Lung","Lung_Lt","Lung_Rt","Spine","Spine_C","Spine_T","Spine_L","Sacrum","Pelvis","Pelvis_Lt","Pelvis_Rt","Rectum","Bladder","Esophagus","Vulva","Mediastinum","Chestwall_Lt","Chestwall_Rt","Skin","Anus","Hip","Hip_Lt","Hip_Rt","Whole Body","Prostate","Femur","Femur_Lt","Femur_Rt","Abdomen","Adrenal_Lt","Adrenal_Rt","Thyroid","Parotid_Lt","Parotid_Rt","Scalp","Cheek","Cheek_Lt","Cheek_Rt","Iliac","Ilium_Lt","Ilium_Rt","Sternum","Cervix","Vagina","Ear","Ear_Lt","Ear_Rt","Liver","Pancreas","Lip","Lip_Upper","Lip_Lower","Larynx","CSI","Shoulder","Shoulder_Lt","Shoulder_Rt","Extremity","Kidney","Kidney_Lt","Kidney_Rt","Spleen","Thigh_Lt","Thigh_Rt","Nose","Eye","Eye_Lt","Eye_Rt","Base_of_Skull","TBI","Whole_Brain","Other"],plan_status_list:["Sim Completed","Waiting for MRI","Waiting for PET","Waiting for Patient CD","Need MD Contours","Need MD Ports","Ready to Plan","Planning","Need MD Review","Need MD Approval","Need Physics ICC","Tx Approved","Replan Requested","Cancelled","Need ReSim"],tx_modality_list:["2D/3D","IMRT","ELECTRON","SRT","SRS","SBRT_LUNG","SBRT_SPINE","SBRT_LIVER","SBRT_PROST","SBRT_OTHER","TBI","HDR_VC","HDR_T&O","HDR_SKIN","HDR_PROST","HDR_OTHER","LDR_I131","LDR_XOFIGO","LDR_OTHER"],sim_list:[{name:"CT Simulation SH",aria_resourceser:"5832",site:"PFCC"},{name:"CT Simulation",aria_resourceser:"115",site:"SBUH"}]},le=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/aria/scheduled_activities",this.token=t}return Object(s.a)(e,[{key:"getScheduledActivitiesPerResourceSer",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerResourceSer/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}},{key:"getAllScheduledActivitiesPerPatientId",value:function(e){var t="".concat(this.url,"/ScheduledActivitiesPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}},{key:"getScheduledActivitiesPerPatientId",value:function(e,t,a){var n="".concat(this.url,"/ScheduledActivitiesPerPatientId/").concat(e,"/").concat(t,"/").concat(a,"?token=").concat(this.token);return fetch(n,{method:"GET"})}}]),e}(),oe=Object(f.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),re=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function ce(e){te.log("ScheduledActivityList()");var t=oe(),a=e.open,o=e.handleClose,r=e.user,c=e.simItem,i=l.a.useState([]),s=Object(h.a)(i,2),u=s[0],m=s[1],d=function(t,a){if(console.log("ScheduledActivityList - fetchList()"),r.userid){var n=new le(e.user.token),l=new Date(a),o=new Date;o.setDate(l.getDate()+365);var c="".concat(l.getMonth()+1,"-").concat(l.getDate(),"-").concat(l.getFullYear()),i="".concat(o.getMonth()+1,"-").concat(o.getDate(),"-").concat(o.getFullYear());n.getScheduledActivitiesPerPatientId(t,c,i).then((function(e){return e.json()})).then((function(e){var t=e.filter((function(e){return e.ActivityCategoryCode.toLowerCase().includes("treatment")}));m(t)})).catch((function(e){alert("Failed fetching treatment list!")}))}else console.log("fetchList -> User not logged in. Returing....")};Object(n.useEffect)((function(){console.log("useEffect"),d(c.PatientId,c.ScheduledStartTime)}),[c.PatientId]);var p=[],f=function(e,t){t?p.push(e):p=p.filter((function(t){return t!==e}))};return l.a.createElement(j.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:re},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"Treatment List"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("adding a case!"),0!==p.length?(p.forEach((function(t){var a=new Date(t.ScheduledStartTime.replace("Z","")),n={case_name:"".concat(c.LastName,"-").concat(c.PatientId),sim:new Date(c.ScheduledStartTime.replace("Z","")),status:"Sim Completed",newstart:a,plan_name:"",planners:"",doctors:"",tx_site:"",note:c.ActivityNote,logs:[]};e.addplan(n)})),alert("".concat(p.length," items havev been added to PlanQ")),p=[],o()):alert("Please select items to add to the plan Q")}},"ADD TO PLANQ"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleClose},"CANCEL"))),u.map((function(e){return l.a.createElement(ee,{key:Object(ae.a)(),txItem:e,selectionChange:f})})))}function ie(e){var t=e.scheduleItem,a=t.ScheduledStartTime,o=t.LastName,r=t.PatientId,c=t.ActivityCode,i=t.ScheduledActivityCode,s=t.ActivityNote,u=Object(n.useState)(!1),m=Object(h.a)(u,2),d=m[0],p=m[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"item"},l.a.createElement("ul",{className:"schedule_item"},l.a.createElement("li",{className:"ScheduledStartTime"},K.MM_DD_DAY(new Date(a.replace("Z","")))),l.a.createElement("li",{className:"LastName"},o),l.a.createElement("li",{className:"PatientId"},r),l.a.createElement("li",{className:"ActivityCode"},c),l.a.createElement("li",{className:"ScheduledActivityCode"},i),l.a.createElement("li",{className:"ActivityNote"},s)),l.a.createElement(b.a,{variant:"outlined",color:"primary",size:"small",className:"add_button",endIcon:l.a.createElement(G.a,null),onClick:function(){p(!0)}},"PlanQ"),l.a.createElement(ce,{open:d,handleClose:function(){p(!1)},user:e.user,simItem:e.scheduleItem,addplan:e.addplan})),l.a.createElement(w.a,null))}var se=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/enums",this.token=t}return Object(s.a)(e,[{key:"getEnums",value:function(){var e="".concat(this.url,"?token=").concat(this.token);return fetch(e)}},{key:"getEnums_prop",value:function(e){var t="".concat(this.url,"/").concat(e,"?token=").concat(this.token);return fetch(t)}}]),e}(),ue=a(219),me=a(235),de=Object(f.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),pe=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function he(e,t){var a=new Date(e);return a.setDate(a.getDate()+t),a}function fe(e){return l.a.createElement("h1",null,e.msg)}function ge(e){var t=e.list,a=e.addplan,n=e.user;return l.a.createElement(A.a,null,t.map((function(e,t){return l.a.createElement(ie,{key:Object(ae.a)(),scheduleItem:e,addplan:a,user:n})})))}function _e(e){var t=e.open,a=e.handleClose,o=e.addplan,r=e.user;te.log("SimSchedule()");for(var c=de(),i=l.a.useState(ne.sim_list[0].aria_resourceser),s=Object(h.a)(i,2),u=s[0],m=s[1],d=l.a.useState(""),p=Object(h.a)(d,2),f=(p[0],p[1]),g=new Date,y=[],C=0;C<7;C++){var w=new Date;w.setDate(g.getDate()-C);var O="".concat(w.getMonth()+1,"-").concat(w.getDate(),"-").concat(w.getFullYear());y.push(O)}var N=l.a.useState(y[0]),D=Object(h.a)(N,2),P=D[0],A=D[1],M=l.a.useState([]),x=Object(h.a)(M,2),I=x[0],L=x[1],T=function(){return!!r.userid},U=function(){var e=Object(z.a)(H.a.mark((function e(){var t,a,n,l,o,c,i,s,m,d,p,h;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("SimSchedule--\x3efetchList()"),T()){e.next=4;break}return console.log("fetchList -> User not logged in. Returing...."),e.abrupt("return");case 4:return t=new le(r.token),a=u,n=P.split("-"),l=parseInt(n[2]),o=parseInt(n[0]),c=parseInt(n[1]),i=new Date(l,o-1,c),s=he(i,1),m="".concat(i.getMonth()+1,"-").concat(i.getDate(),"-").concat(i.getFullYear()),d="".concat(s.getMonth()+1,"-").concat(s.getDate(),"-").concat(s.getFullYear()),e.next=16,t.getScheduledActivitiesPerResourceSer(a,m,d);case 16:if(401!==(p=e.sent).status){e.next=21;break}f("Please login"),e.next=26;break;case 21:return e.next=23,p.json();case 23:h=e.sent,L(h),f("");case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){console.log("useEffect()"),U()}),[u,P,t]);return l.a.createElement(R.a,{utils:Y.a},l.a.createElement(j.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:pe},l.a.createElement(ue.a,{className:c.formControl},l.a.createElement(_.a,{className:c.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:c.title},"CT Sim"),l.a.createElement(ue.a,{className:c.formControl},l.a.createElement(me.a,{native:!0,value:u,onChange:function(e){m(e.target.value)},inputProps:{name:"resourceSer",id:"resourceSer-native-simple"}},ne.sim_list.map((function(e){return l.a.createElement("option",{value:e.aria_resourceser,key:Object(ae.a)()},e.name)})))),l.a.createElement(ue.a,{className:c.formControl},l.a.createElement(me.a,{native:!0,value:P,onChange:function(e){A(e.target.value)},inputProps:{name:"simDate",id:"simDate-native-simple"}},y.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){U()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),T()?l.a.createElement(ge,{list:I,user:r,addplan:o}):l.a.createElement(fe,{msg:"please login"})))}var Ee=a(242),ve=a(240),be=a(234);a(151);function ke(e){return l.a.createElement(be.a,Object.assign({elevation:6,variant:"filled"},e))}var ye=Object(f.a)((function(e){return{root:{},appBar:{position:"relative"},title:{flex:1},formControl:{margin:e.spacing(1)},button:{margin:e.spacing(1)},alert:{width:"100%","& > * + *":{marginTop:e.spacing(0)}}}}));function Ce(e){te.log("Login()");var t=ye(),a=l.a.useState(""),n=Object(h.a)(a,2),o=n[0],r=n[1],c=l.a.useState(""),i=Object(h.a)(c,2),s=i[0],u=i[1],m=l.a.useState(""),d=Object(h.a)(m,2),p=d[0],f=d[1],g=l.a.useState(!1),k=Object(h.a)(g,2),y=k[0],C=k[1],w=function(e,t){"clickaway"!==t&&C(!1)},O=function(){var t={userid:o,password:s},a=ne.webservice_url+"/users/authenticate",n=new XMLHttpRequest;n.open("POST",a,!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var t=JSON.parse(n.responseText);e.setUser(t),e.handleLoginClose(),u(""),C(!1)}else{f("Login Failed. Try again. Use your computer login ID and PW."),C(!0),u("")}},n.send(JSON.stringify(t))};return l.a.createElement(j.a,{className:"login-dialog",open:e.loginOpen,onClose:e.handleLoginClose},l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(v.a,{variant:"h6",className:t.title},"Login"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:e.handleLoginClose},"CLOSE")))),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{id:"textfield_userid",className:t.textField,label:"User Id",value:o,onChange:function(e){r(e.target.value)}})),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{id:"textfield_password",className:t.textField,label:"Password",type:"password",value:s,onKeyUp:function(e){13===e.keyCode&&O()},onChange:function(e){u(e.target.value)}})),l.a.createElement(ve.a,{open:y,autoHideDuration:6e3,onClose:w},l.a.createElement(ke,{onClose:w,severity:"error"},p)),l.a.createElement(b.a,{variant:"contained",color:"primary",className:t.button,onClick:O},"Submit"))}var we=a(107),je=a.n(we),Oe=a(106),Ne=a.n(Oe),Se=a(108),De=a.n(Se),Pe=a(110),Ae=a(225),Me=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/qalist",this.token=t}return Object(s.a)(e,[{key:"getQAs",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getPendingQAs",value:function(){return fetch(this.url+"/notcompleted?token=".concat(this.token))}},{key:"getCompletedQAs",value:function(){return fetch(this.url+"/completed?token=".concat(this.token))}},{key:"getQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getPendingQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/notcompleted/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getCompletedQAs_skip_limit",value:function(e,t){return e=encodeURIComponent(e),t=encodeURIComponent(t),fetch("".concat(this.url,"/completed/skip/").concat(e,"/limit/").concat(t,"?token=").concat(this.token))}},{key:"getQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getPendingQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/notcompleted/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"getCompletedQAs_machines_skip_limit",value:function(e,t,a){return e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),fetch("".concat(this.url,"/completed/machines/").concat(e,"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token))}},{key:"addQA",value:function(e){return fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updateQA",value:function(e,t){var a=this.url+"/"+e._id+"?token=".concat(this.token);return t&&(a+=t),console.log("url==>",a),fetch(a,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deleteQA",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),xe=a(233),Ie=(a(152),a(153),a(215)),Le=a(221),Re=a(214),Te=a(222);a(154);function Ye(e){var t=e.open,a=e.handleClose,n=e.title,o=e.msg,r=e.buttons,c=e.error?"simple-dlg-error-title":"simple-dlg-info-title";return l.a.createElement(j.a,{open:t,className:"simple-dlg"},l.a.createElement(Le.a,{className:c},n),o&&l.a.createElement(Re.a,null,l.a.createElement(Te.a,{id:"alert-dialog-msg"},o)),l.a.createElement(Ie.a,null,r.includes("Yes")&&l.a.createElement(b.a,{onClick:function(){a("Yes")},color:"primary"},"Yes"),r.includes("No")&&l.a.createElement(b.a,{onClick:function(){a("No")},color:"primary"},"No"),r.includes("Ok")&&l.a.createElement(b.a,{onClick:function(){a("Ok")},color:"primary"},"Ok"),r.includes("Cancel")&&l.a.createElement(b.a,{onClick:function(){a("Cancel")},color:"primary"},"Cancel")))}a(155);function Ue(e){var t=e.open,a=e.handleClose,o=function(e){var t=Object(n.useState)(e),a=Object(h.a)(t,2),l=a[0],o=a[1];return[l,function(e){o(Object(p.a)({},l,Object(c.a)({},e.target.name,e.target.value)))}]}({PD:3,DTA:2,G:95}),r=Object(h.a)(o,2),i=r[0],s=r[1];return l.a.createElement(j.a,{open:t},l.a.createElement("div",{className:"gamma-title"},"Gamma Result"),l.a.createElement(Re.a,null,l.a.createElement("div",{className:"gamma-wrapper"},"Gamma: [",l.a.createElement("select",{id:"PD",name:"PD",onChange:s,value:i.PD},l.a.createElement("option",{value:"1"},"1 %"),l.a.createElement("option",{value:"2"},"2 %"),l.a.createElement("option",{value:"3"},"3 %"),l.a.createElement("option",{value:"4"},"4 %"),l.a.createElement("option",{value:"5"},"5 %")),"/",l.a.createElement("select",{id:"DTA",name:"DTA",onChange:s,value:i.DTA},l.a.createElement("option",{value:"1"},"1 mm"),l.a.createElement("option",{value:"2"},"2 mm"),l.a.createElement("option",{value:"3"},"3 mm"),l.a.createElement("option",{value:"4"},"4 mm"),l.a.createElement("option",{value:"5"},"5 mm")),"] =>",l.a.createElement("input",{id:"G",name:"G",onChange:s,value:i.G}),"%")),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){a(i)},color:"primary",autoFocus:!0},"OK"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}function qe(e){console.log("QAListItem()");var t=e.qaitem,a=e.user,o=e.save_qa,r=e.delete_qa,c=t.qa,i=(t.dirty,c.due_on),s=c.plan_case_name,u=c.plan,m=c.type,d=c.result,f=c.machine,g=c.requested_by,_=(c.requested_on,c.completed_by),E=(c.completed_on,c.notes),v=new $,b=Object(n.useState)({result:d,notes:E}),k=Object(h.a)(b,2),y=k[0],C=k[1],w=Object(n.useState)(!1),j=Object(h.a)(w,2),O=j[0],N=j[1],S=Object(n.useState)(""===c.completed_by.trim()&&""!==c.result.trim()),D=Object(h.a)(S,2),P=D[0],A=D[1],M=Object(n.useState)(!1),x=Object(h.a)(M,2),I=x[0],L=x[1],R=Object(n.useState)(!1),T=Object(h.a)(R,2),Y=T[0],U=T[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"qa_item"},l.a.createElement("div",{className:"qa-due"},v.MM_DD_DAY(new Date(i))),l.a.createElement("div",{className:"qa-plan_case_name"},s),l.a.createElement("div",{className:"qa-plan"},u),l.a.createElement("div",{className:"qa-type"},m),l.a.createElement("div",{className:"qa-machine"},f),l.a.createElement("div",{className:"qa-requested_by"},g.split("|")[0]),l.a.createElement("div",{className:"qa-result-wrapper"},l.a.createElement("div",{className:"qa-result"},y.result),l.a.createElement("button",{className:"open-gamma-dlg",onClick:function(){U(!0)}},"...")),l.a.createElement("div",null,l.a.createElement("input",{name:"notes",value:y.notes,onChange:function(e){"notes"===e.target.name&&(C(Object(p.a)({},y,{notes:e.target.value})),N(!0))},placeholder:"Notes"})),l.a.createElement("div",{className:"qa-completed_by"},_.split("|")[0]),l.a.createElement("div",{className:"button-container"},l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.result=y.result,c.notes=y.notes,o(c),N(!1)},disabled:!O}," Save ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){c.completed_on=new Date,c.completed_by="".concat(a.name,"|").concat(a.email,"|").concat(a.userid),c.result=y.result,c.notes=y.notes,o(c,"&action=completed"),N(!1),A(!1)},disabled:!P}," Complete ")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){L(!0)}},"x")))),l.a.createElement(Ye,{id:"delete_confirm_dialog",open:I,title:"Are you sure?",buttons:"Yes|no",handleClose:function(e){"Yes"===e&&r(t.qa),L(!1)}}),l.a.createElement(Ue,{id:"gamma_dialog",open:Y,handleClose:function(e){if(e){var t="G(".concat(e.PD,"%,").concat(e.DTA,"mm)=").concat(e.G,"%");C(Object(p.a)({},y,{result:t})),N(!0),A(!0)}U(!1)}}))}var Fe=Object(f.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),Be=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function Qe(e){return l.a.createElement("h1",null,e.msg)}function He(e){var t=e.list,a=e.delete_qa,n=e.save_qa,o=e.user;return l.a.createElement(A.a,null,t.map((function(e,t){return l.a.createElement(qe,{key:Object(ae.a)(),qaitem:e,delete_qa:a,save_qa:n,user:o})})))}function ze(e){var t=Fe(),a=e.open,o=e.handleClose,r=e.user,c=Object(n.useState)([]),i=Object(h.a)(c,2),s=i[0],u=i[1],m=["Pending","Completed","All"],d=Object(n.useState)(m[0]),p=Object(h.a)(d,2),f=p[0],g=p[1],y=Object(n.useState)(1),C=Object(h.a)(y,2),w=C[0],O=C[1],N=Object(n.useState)(0),D=Object(h.a)(N,2),P=D[0],A=D[1],M=r&&r.settings&&r.settings.qalist_num_of_cases_per_page?r.settings.qalist_num_of_cases_per_page:10,x=P%M>0?Math.floor(P/M)+1:Math.floor(P/M),I=function(){r&&r.userid?function(e,t,a){var n=(t-1)*a,l=a;if(r&&r.token){var o=new Me(r.token);if(r.settings&&r.settings.my_machines&&""!==r.settings.my_machines.trim())switch(e){case"All":return o.getQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Pending":return o.getPendingQAs_machines_skip_limit(r.settings.my_machines,n,l);case"Completed":return o.getCompletedQAs_machines_skip_limit(r.settings.my_machines,n,l);default:console.error("Unknown status")}else switch(e){case"All":return o.getQAs_skip_limit(n,l);case"Pending":return o.getPendingQAs_skip_limit(n,l);case"Completed":return o.getCompletedQAs_skip_limit(n,l);default:console.error("Unknown status")}}}(f,w,M).then((function(e){return e.json()})).then((function(e){var t=e.list.map((function(e){return{qa:e,dirty:!1}}));u(t),A(e.totalCount)})).catch((function(e){return console.log(e)})):console.log("user not logged in yet")};Object(n.useEffect)((function(){I()}),[a,r,f,w]);var L=function(){return!!r.userid};return l.a.createElement(R.a,{utils:Y.a},l.a.createElement(j.a,{fullScreen:!0,open:a,onClose:o,TransitionComponent:Be},l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(_.a,{className:t.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:o,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:t.title},"QA List"),l.a.createElement("div",{className:"qa-status-wrapper"},l.a.createElement("label",{htmlFor:"qa-status"},"STATUS:"),l.a.createElement("select",{id:"qa-status",onChange:function(e){console.log("status",e.target.value),g(e.target.value)},value:f},m.map((function(e){return l.a.createElement("option",{value:e,key:Object(ae.a)()},e)})))),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){I()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:o},"close")))),L()?l.a.createElement(He,{list:s,delete_qa:function(e){L()&&new Me(r.token).deleteQA(e).then((function(e){return e.json()})).then((function(t){if(1===t.deletedCount){var a=s.filter((function(t){return t.qa._id!==e._id}));u(a),A(P-1)}else console.error("delete qa failed. Either none deleted or more than 1 QAs deleted.")})).catch((function(e){console.log(e),alert('Failed deleting the QA. You may click the "Refresh" button of the brower and try again')}))},save_qa:function(e,t){r&&r.token&&new Me(r.token).updateQA(e,t).then((function(e){return e.json()})).then((function(e){1===e.nModified?u(s):(console.error("save qa failed. Either none saved or more than 1 QAs saved."),alert("Saving QA failed!"))})).catch((function(e){console.log(e),alert("Saving QA failed!")}))},user:r}):l.a.createElement(Qe,{msg:"please login"}),l.a.createElement("div",{className:"qalist-pagenation"},l.a.createElement(xe.a,{count:x,page:w,onChange:function(e,t){O(t)}}),l.a.createElement("div",{className:"total-count"},"N=",P))))}var We=a(224),Ge=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/users",this.token=t}return Object(s.a)(e,[{key:"getAllUsers",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getUserByUserId",value:function(e){var t="".concat(this.url,"/userid/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"updateUser",value:function(e){console.log("updating a user",e);var t="".concat(this.url,"/userid/").concat(e.userid,"?token=").concat(this.token);return console.log("url==>",t),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}]),e}(),Je=a(223),Ve=a(168),Ke=a(237),Ze=Object(f.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3)}}}));function Xe(e,t){var a={};return e.forEach((function(e){a[e]=t.indexOf(e)>-1})),a}function $e(e){console.log("CheckBoxSelectorDlg()");var t=e.open,a=e.handleClose,o=e.title,r=e.list,i=e.selected,s=Ze(),u=l.a.useState(Xe(r,i)),m=Object(h.a)(u,2),d=m[0],f=m[1];Object(n.useEffect)((function(){f(Xe(r,i))}),[r,i,t]);var g=function(e){f(Object(p.a)({},d,Object(c.a)({},e.target.name,e.target.checked)))};return l.a.createElement(j.a,{open:t,className:"checkbox-selector-dlg"},l.a.createElement(Le.a,{className:"checkbox-selector-dlg-title"},o),l.a.createElement(Re.a,null,l.a.createElement("div",{className:s.root},l.a.createElement(ue.a,{component:"fieldset",className:s.formControl},l.a.createElement(Ve.a,null,Object.keys(d).map((function(e){return l.a.createElement(Je.a,{key:e,control:l.a.createElement(Ke.a,{checked:d[e],onChange:g,name:e}),label:e})})))))),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){var e=[];Object.keys(d).forEach((function(t){d[t]&&e.push(t)})),a(e)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(156);var et=Object(f.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),tt=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function at(e,t){return!!function(e,t){if(console.log("label===>",e),console.log("value===>",t),console.log("typeof value===>",typeof t),!t||"string"===typeof t&&""===t.trim())return alert('"'.concat(e,'" field cannot be empty')),!1;if(isNaN(t))return alert('"'.concat(e,'" is not a number')),!1;var a=Number(t);return!!Number.isInteger(a)||(alert('"'.concat(e,'" is not an integer number')),!1)}(e,t)&&(!(parseInt(t)<1)||(alert('"'.concat(e,'" is not a positive integer number')),!1))}function nt(e){var t=e.open,a=e.handleClose,o=e.user;te.log("UseSettings()");var r=et(),i=function(){a(null)},s={notify_planq_list:!1,planq_num_of_cases_per_page:10,qalist_num_of_cases_per_page:10,notify_qa_new:!1,notify_qa_completed_all:!1,notify_aria_rx_change:!1,notify_aria_plan_change:!1,notify_aria_structure_change:!1,notify_for_all_patients:!1,planner:!1,doctor:!1,aria_userid:"",my_machines:ne?ne.machine_list.join(","):""},u=Object(n.useState)(s),m=Object(h.a)(u,2),d=m[0],f=m[1],g=Object(n.useState)(!1),y=Object(h.a)(g,2),C=y[0],O=y[1],N=function(e){"checkbox"===e.target.type?f(Object(p.a)({},d,Object(c.a)({},e.target.name,e.target.checked))):f(Object(p.a)({},d,Object(c.a)({},e.target.name,e.target.value))),O(!0)},D=Object(n.useCallback)(Object(z.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("UserSettingsDlg - fetchList()"),o.userid){t.next=4;break}return console.log("fetchData -> User not logged in. Returing...."),t.abrupt("return");case 4:new Ge(e.user.token).getUserByUserId(e.user.userid).then((function(e){return e.json()})).then((function(e){e&&e.settings&&(e.settings.my_machines&&""!==e.settings.my_machines.trim()||ne&&(e.settings.my_machines=ne.machine_list.join(",")),f(Object(p.a)({},d,{},e.settings))),O(!1)})).catch((function(e){alert("Failed fetching user data!")}));case 6:case"end":return t.stop()}}),t)}))),[o,t]);Object(n.useEffect)((function(){console.log("UserSettingsDlg--\x3euseEffect()"),D()}),[t,o,D]);var P=Object(n.useState)(!1),A=Object(h.a)(P,2),M=A[0],x=A[1];return l.a.createElement(j.a,{fullScreen:!0,open:t,onClose:i,TransitionComponent:tt},l.a.createElement(ue.a,{className:r.formControl},l.a.createElement(_.a,{className:r.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:i,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:r.title},"Use Settings"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){console.log("handleApply"),at("PlanQ - Number of cases per page",d.planq_num_of_cases_per_page)&&at("QA - Number of cases per page",d.qalist_num_of_cases_per_page)&&(console.log("setting dirty to false"),O(!1),console.log("settings========>",d),a(d))},disabled:!C},"Apply"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:i},"Cancel")))),l.a.createElement("div",{className:"user-settings-content"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"About Me"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Email: ",o.email),l.a.createElement("div",{className:"user-settings-item-wrapper"},"My Name: ",o.name),l.a.createElement("div",{className:"item-helper-text"},"(If the email/name above is not correct, please contact the administrator)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a planner"),l.a.createElement(We.a,{name:"planner",checked:d.planner,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"I am a doctor"),l.a.createElement(We.a,{name:"doctor",checked:d.doctor,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Machines"),l.a.createElement("div",{className:"item-input"},l.a.createElement("span",null,d.my_machines),l.a.createElement("button",{onClick:function(){return x(!0)}},"..."))),l.a.createElement("div",{className:"item-helper-text"},"(If blank, it means I am interested in all machines)"),l.a.createElement($e,{open:M,handleClose:function(e){if(e){var t=e.join(",");f(Object(p.a)({},d,{my_machines:t})),O(!0)}x(!1)},title:"Select Machines",list:ne?ne.machine_list:[],selected:d.my_machines.split(",")})),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"PlanQ"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Send me PlanQ list every morning"),l.a.createElement(We.a,{name:"notify_planq_list",checked:d.notify_planq_list,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of cases per page"),l.a.createElement("input",{name:"planq_num_of_cases_per_page",value:d.planq_num_of_cases_per_page,className:"item-input",onChange:N}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"QA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all new QA creations"),l.a.createElement(We.a,{name:"notify_qa_new",checked:d.notify_qa_new,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for all QA completions"),l.a.createElement(We.a,{name:"notify_qa_completed_all",checked:d.notify_qa_completed_all,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Number of QA items per page"),l.a.createElement("input",{name:"qalist_num_of_cases_per_page",value:d.qalist_num_of_cases_per_page,className:"item-input",onChange:N}))),"  ")," ",l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-title"},"ARIA"),l.a.createElement("div",{className:"card-content"},l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"My Aria User Id"),l.a.createElement("input",{name:"aria_userid",value:d.aria_userid,className:"item-input",onChange:N})),l.a.createElement("div",{className:"item-helper-text"},"(If ARIA User Id is not entered or incorrect, no ARIA notifiation will be sent)"),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Prescription")," changes"),l.a.createElement(We.a,{name:"notify_aria_rx_change",checked:d.notify_aria_rx_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Plan")," changes"),l.a.createElement(We.a,{name:"notify_aria_plan_change",checked:d.notify_aria_plan_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for ",l.a.createElement("u",null,"Structure")," changes"),l.a.createElement(We.a,{name:"notify_aria_structure_change",checked:d.notify_aria_structure_change,className:"item-input",size:"small",onChange:N})),l.a.createElement("div",{className:"user-settings-item-wrapper"},l.a.createElement("label",{className:"item-label"},"Notify me for the changes in ",l.a.createElement("u",null,"all monitored patients")),l.a.createElement(We.a,{name:"notify_for_all_patients",checked:d.notify_for_all_patients,className:"item-input",size:"small",onChange:N}),l.a.createElement("div",{className:"item-helper-text"},"(Monitored patients are those in the PlanQ with its newstart date is today or later)"))),"  ")," ",l.a.createElement(w.a,null)))}a(157);var lt=Object(f.a)((function(e){return{root:{},menuButton:{marginRight:2},title:{marginLeft:e.spacing(2),flex:1}}})),ot=Object(g.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return l.a.createElement(Pe.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),rt=Object(g.a)((function(e){return{root:{}}}))(Ae.a);function ct(e){te.log("Header()");var t=lt(),a=e.user,o=e.update_planlist,r=e.setUser,c=e.set_filter,i=function(){return!(!a||!a.userid)},s=Object(n.useState)(!1),u=Object(h.a)(s,2),m=u[0],d=u[1],f=Object(n.useState)(!1),g=Object(h.a)(f,2),y=g[0],w=g[1],j=Object(n.useState)(!1),O=Object(h.a)(j,2),N=O[0],S=O[1],P=function(){S(!0)},A=Object(n.useState)(!1),M=Object(h.a)(A,2),x=M[0],I=M[1],R=l.a.useState(null),T=Object(h.a)(R,2),Y=T[0],U=T[1],q=function(){U(null)},F=function(){console.log("add a case"),e.onclick_addplan(),q()},Q=function(){w(!0),q()},H=function(e){console.log("updating user settings============>",e),new Ge(e.token).updateUser({userid:e.userid,settings:e.settings}).then((function(e){})).catch((function(e){console.error(e),alert("Failed saving user settings.")}))},z=Object(n.useState)(!1),W=Object(h.a)(z,2),J=W[0],V=W[1];Object(n.useEffect)((function(){var e=a&&a.settings&&a.settings.planq_search_keyword?a.settings.planq_search_keyword:"";$(e)}),[a]);var K=Object(n.useState)(""),Z=Object(h.a)(K,2),X=Z[0],$=Z[1];return l.a.createElement("div",{className:t.root},l.a.createElement(_.a,{position:"static"},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:function(e){U(e.currentTarget)},disabled:!i()},l.a.createElement(C.a,null)),l.a.createElement(ot,{id:"customized-menu",anchorEl:Y,keepMounted:!0,open:Boolean(Y),onClose:q},l.a.createElement(rt,{onClick:F},l.a.createElement(L.a,null,l.a.createElement(G.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Add Case"})),l.a.createElement(rt,{onClick:function(){console.log("email list to me"),e.onclick_email_planq_list_to_me(),q()}},l.a.createElement(L.a,null,l.a.createElement(Ne.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Email List to Me"})),l.a.createElement(rt,{onClick:Q},l.a.createElement(L.a,null,l.a.createElement(je.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"Sim List"})),l.a.createElement(_e,{open:y,handleClose:function(){w(!1)},addplan:e.addplan,user:e.user}),l.a.createElement(rt,{onClick:P},l.a.createElement(L.a,null,l.a.createElement(De.a,{fontSize:"small"})),l.a.createElement(D.a,{primary:"QA List"})),l.a.createElement(ze,{open:N,handleClose:function(){S(!1),q()},user:a})),l.a.createElement(v.a,{variant:"h6",className:t.title},"PlanQ - ",ne.site),l.a.createElement("div",{className:"search-wriapper"},l.a.createElement("input",{className:"search-box",placeholder:"Search",value:X,onChange:function(e){$(e.target.value)},disabled:!i()}),l.a.createElement(b.a,{color:"inherit",onClick:function(){a.settings.planq_search_keyword=X,H(a),r(a),console.log("handleSearch===============>")},disabled:!i()},"Update")),l.a.createElement(b.a,{color:"inherit",onClick:F,disabled:!i()},"Add"),l.a.createElement(b.a,{color:"inherit",onClick:Q,disabled:!i()},"Sim"),l.a.createElement(b.a,{color:"inherit",onClick:P,disabled:!i()},"QA"),l.a.createElement(b.a,{id:"button_filter",color:"inherit",onClick:function(){d(!0)},disabled:!i()},"FILTERS"),l.a.createElement(B,{open:m,handleClose:function(e){e&&c(e),d(!1)},set_filter:e.set_filter,filter:e.filter}),l.a.createElement(b.a,{color:"inherit",onClick:function(){o()},disabled:!i()},"REFRESH"),i()?l.a.createElement("div",null,l.a.createElement(b.a,{color:"inherit",onClick:function(){V(!0)}},"Settings"),l.a.createElement(nt,{open:J,handleClose:function(e){e&&(a.settings=Object(p.a)({},a.settings,{},e),H(a),r(a)),V(!1)},user:a}),l.a.createElement(b.a,{color:"inherit",onClick:function(){console.log("Logout!"),r({})}},"LOGOUT[",e.user.userid,"]")):l.a.createElement(b.a,{id:"button_login",color:"inherit",onClick:function(){I(!0)}},"LOGIN"),l.a.createElement(Ce,{loginOpen:x,handleLoginClose:function(){I(!1)},user:a,setUser:r}))))}var it=a(111),st={root:{margin:0,padding:10,textAlign:"center"}},ut=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return l.a.createElement(it.a,{style:st.root},l.a.createElement(v.a,{component:"p"},"Confidential. Version 1.0.0 (May 2020)"))}}]),t}(n.Component),mt=a(229),dt=a(241),pt=a(226),ht=a(227),ft=a(230),gt=a(109),_t=a.n(gt),Et=a(69),vt=(a(158),Object(g.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(dt.a)),bt=Object(g.a)({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:56,"&$expanded":{minHeight:56}},content:{"&$expanded":{margin:"12px 0"}},expanded:{}})(pt.a),kt=Object(g.a)((function(e){return{root:{padding:e.spacing(2)}}}))(ht.a);function yt(e){var t=l.a.useState(""),a=Object(h.a)(t,2),n=a[0],o=a[1],r=e.log,c=r.msg.trim(),i=c.substring(1,c.length-1).split(","),s=[];i.forEach((function(e){var t=e.split(" by ");if(2===t.length){var a=t[1].split(" ")[0];s.push(a)}}));var u=Object(Et.a)(new Set(s)).join("/"),m=[];i.forEach((function(e){var t=e.split(" at ");if(2===t.length){var a=t[1].trim();m.push(a)}}));var d=Object(Et.a)(new Set(m)).join("/"),p=[];r.title.toLowerCase().includes("status changed")&&i.forEach((function(e){var t=e.split("->");if(2===t.length){var a=t[1].trim().split(" ")[0];p.push(a)}}));var f,g=Object(Et.a)(new Set(p)).join("/");return 0===g.length?[u,d].join(","):[].join(","),l.a.createElement(vt,{square:!0,expanded:"panel1"===n,onChange:(f="panel1",function(e,t){o(!!t&&f)})},l.a.createElement(bt,{"aria-controls":"panel1d-content",id:"panel1d-header"},l.a.createElement("ul",{className:"log-heading"},l.a.createElement("li",{className:"log-title"},r.title),l.a.createElement("li",{className:"log-who"},u),l.a.createElement("li",{className:"log-status"},g),l.a.createElement("li",{className:"log-time"},d))),l.a.createElement(kt,null,l.a.createElement("ul",null,i.map((function(e){return l.a.createElement("li",{key:Object(ae.a)()},e)})))))}var Ct=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/logs",this.token=t}return Object(s.a)(e,[{key:"getLogsOfObject",value:function(e){var t="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"addLogOfObject",value:function(e,t){var a="".concat(this.url,"/object_id/").concat(e,"?token=").concat(this.token);return fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:t})}}]),e}(),wt=Object(f.a)((function(e){return{list:{width:"100%",backgroundColor:e.palette.background.paper},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,backgroundColor:"white"}}})),jt=l.a.forwardRef((function(e,t){return l.a.createElement(O.a,Object.assign({direction:"up",ref:t},e))}));function Ot(e){var t=e.open,a=e.handleClose,o=e.object_id,r=e.min_object_id_length;te.log("AriaActivityList()");var c=wt(),i=l.a.useState([]),s=Object(h.a)(i,2),u=s[0],m=s[1],d=function(){if(te.log("AriaActivityList()->fetchList()->props.user",e.user),!o||o.trim().length<r)return console.log("object_id (".concat(o,") is too short(min_length=").concat(r,") ")),void m([]);new Ct(e.user.token).getLogsOfObject(o).then((function(e){return e.json()})).then((function(e){m(e)})).catch((function(e){console.log("Failed fetching ARIA activity list",e)}))};Object(n.useEffect)((function(){d()}),[o,t]);return l.a.createElement(j.a,{fullScreen:!0,open:t,onClose:a,TransitionComponent:jt},l.a.createElement(ue.a,{className:c.formControl},l.a.createElement(_.a,{className:c.appBar},l.a.createElement(E.a,null,l.a.createElement(k.a,{edge:"start",color:"inherit",onClick:a,"aria-label":"close"},l.a.createElement(S.a,null)),l.a.createElement(v.a,{variant:"h6",className:c.title},"Activities"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:function(){d()}},"refresh"),l.a.createElement(b.a,{autoFocus:!0,color:"inherit",onClick:a},"close")))),l.a.createElement("div",null,u.map((function(e){return l.a.createElement(yt,{key:e._id,log:e})}))))}var Nt={root:{width:"100%"},list:{width:"100%"},LogTextField:{width:"100%"},logToolbar:{width:"100%",borderWidth:1},listitem:{margin:0,padding:0}},St=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).change_handler=function(e){a.setState({input_text:e.target.value})},a.keyup=function(e){if(13===e.keyCode){var t=e.target.value;a.props.addlog(a.props.planitem,t),a.setState({input_text:""})}},a.state={input_text:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=new $;return l.a.createElement("div",{style:Nt.root},l.a.createElement(Ee.a,{fullWidth:!0,style:Nt.LogTextField,label:"Log",margin:"normal",variant:"outlined",value:this.state.input_text,placeholder:"Type your log & hit Enter key",InputLabelProps:{shrink:!0},onChange:this.change_handler,onKeyUp:this.keyup}),l.a.createElement("div",{style:Nt.list},l.a.createElement(A.a,{component:"nav","aria-label":"main mailbox folders"},this.props.planitem.plan.logs&&this.props.planitem.plan.logs.map((function(a){return l.a.createElement(P.a,{button:!0,style:Nt.listitem,key:a.at},l.a.createElement(D.a,{primary:"[".concat(t.MM_DD(new Date(a.at)),"] ").concat(a.msg)}),l.a.createElement(b.a,{onClick:function(){e.props.removelog(e.props.planitem,a)}},"X"))})))))}}]),t}(n.Component),Dt=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/aria/plansetups",this.token=t}return Object(s.a)(e,[{key:"getAllPlanSetupsPerPatientId",value:function(e){var t="".concat(this.url,"/PlanSetupsPerPatientIdAll/").concat(e,"?token=").concat(this.token);return fetch(t,{method:"GET"})}}]),e}();a(159);function Pt(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,i=e.min_patientId_Length,s=Object(n.useState)([]),u=Object(h.a)(s,2),m=u[0],d=u[1],f=Object(n.useState)({}),g=Object(h.a)(f,2),_=g[0],E=g[1],v=function(e){E(Object(p.a)({},_,Object(c.a)({},e.target.name,e.target.checked)))};Object(n.useEffect)((function(){console.log("useEffect()"),k(r)}),[r,t]);var k=function(t){if(console.log("PlanSetupSelector - fetchList()"),o.userid){if(!t||t.trim().length<i)return console.log("Patient Id length is too short (min_length=".concat(i,")")),void d([]);new Dt(e.user.token).getAllPlanSetupsPerPatientId(t).then((function(e){return e.json()})).then((function(e){d(e)})).catch((function(e){alert("Failed fetching plan list!")}))}else console.log("fetchList -> User not logged in. Returing....")};return l.a.createElement(j.a,{open:t,className:"plan-setup-selector-dlg"},l.a.createElement(Le.a,{className:"plan-setup-selector-dlg-title"},"Select Plan"),l.a.createElement(Re.a,null,l.a.createElement(ue.a,{component:"fieldset"},m.map((function(e){var t=e.CourseId+"/"+e.PlanSetupId;return l.a.createElement(Je.a,{key:Object(ae.a)(),control:l.a.createElement(Ke.a,{checked:_[t],onChange:v,name:t,color:"primary"}),label:t})})))),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){var e=[];Object.keys(_).forEach((function(t){_[t]&&e.push(t)})),a(e.join(","))},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}var At=a(236),Mt=a(228);a(160);function xt(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=Object(n.useState)([]),i=Object(h.a)(c,2),s=i[0],u=i[1],m=Object(n.useState)({}),d=Object(h.a)(m,2),p=d[0],f=d[1];Object(n.useEffect)((function(){console.log("useEffect()"),g(r)}),[r,t]);var g=function(t){(console.log("PlanSetupSelector - fetchList()"),o.userid)?new Dt(e.user.token).getAllPlanSetupsPerPatientId(t).then((function(e){return e.json()})).then((function(e){u(e)})).catch((function(e){alert("Failed fetching plan list!")})):console.log("fetchList -> User not logged in. Returing....")};return l.a.createElement(j.a,{open:t,className:"plan-setup-selector-dlg"},l.a.createElement(Le.a,{className:"plan-setup-selector-dlg-title"},"Select Plan"),l.a.createElement(Re.a,null,l.a.createElement(ue.a,{component:"fieldset"},l.a.createElement(Mt.a,{className:"plansetupselector-radiogroup","aria-label":"plansetuplist",name:"plansetuplist",value:p,onChange:function(e){f(e.target.value)}},s.map((function(e){var t=e.CourseId+"/"+e.PlanSetupId;return l.a.createElement(Je.a,{key:Object(ae.a)(),value:t,control:l.a.createElement(At.a,null),label:t})}))))),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){a(p)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}a(161);function It(e){var t=e.open,a=e.handleClose,o=e.user,r=e.PatientId,c=["PD","MapCheck","Film"],i=l.a.useState(c[0]),s=Object(h.a)(i,2),u=s[0],m=s[1],d=l.a.useState(""),p=Object(h.a)(d,2),f=p[0],g=p[1],_=Object(n.useState)(!1),E=Object(h.a)(_,2),v=E[0],k=E[1],y=Object(n.useState)({open:!1,title:"",msg:"",error:!1}),C=Object(h.a)(y,2),w=C[0],O=C[1],N=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];O({open:!0,title:e,msg:t,error:a})};return l.a.createElement("div",null,l.a.createElement(j.a,{open:t,className:"add-qa-dlg"},l.a.createElement(Le.a,{className:"add-qa-dlg-title"},"New QA"),l.a.createElement(Re.a,null,l.a.createElement(ue.a,{component:"fieldset"},l.a.createElement("label",{className:"qa-type-label"}," QA Type:"),l.a.createElement(Mt.a,{className:"radiogroup-qa-type",value:u,onChange:function(e){m(e.target.value)}},c.map((function(e){return l.a.createElement(Je.a,{value:e,key:Object(ae.a)(),control:l.a.createElement(At.a,null),label:e})}))),l.a.createElement("label",{className:"qa-plan-label"},"QA Plan:"),l.a.createElement(Ee.a,{className:"text-field-qa-plan-name",value:f,InputLabelProps:{shrink:!0},onClick:function(){k(!0)},helperText:"Click to select a QA plan"}),l.a.createElement(xt,{open:v,handleClose:function(e){console.log("handlePlanSetupSelectorDlgClose()",e),e&&g(e),k(!1)},user:o,PatientId:r}))),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){""!==f?a({type:u,plan:f}):N("Error","Please select a QA plan",!0)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel"))),l.a.createElement(Ye,{open:w.open,handleClose:function(){return O({open:!1,title:"",msg:"",error:!1})},title:w.title,msg:w.msg,buttons:"Ok",error:w.error}))}var Lt=l.a.createContext();function Rt(e,t){var a=t.type,n=t.data,l=t.user;switch(a){case"set-list":return n;case"add-item":if(console.log("add-item",n),!l||!l.token)return;new Me(l.token).addQA(n).then((function(e){return e.json()})).then((function(t){var a={qa:t,dirty:!1};return[].concat(Object(Et.a)(e),[a])})).catch((function(e){console.log(e)}))}}var Tt=function(e){var t=e.user,a=Object(n.useReducer)(Rt,[]),o=Object(h.a)(a,2),r=o[0],c=o[1];return Object(n.useEffect)((function(){!function(e){e&&e.token&&new Me(e.token).getQAs().then((function(e){return e.json()})).then((function(e){var t=e.map((function(e){return{qa:e,dirty:!1}}));c({type:"set-list",data:t})})).catch((function(e){console.log(e),alert("Failed fetching QA list!")}))}(t)}),[t]),l.a.createElement(Lt.Provider,{value:{qaList:r,qaListDispatch:c}},e.children)};a(162),a(163);function Yt(e){var t=e.open,a=e.handleClose,o=e.title,r=e.initialValue,c=e.searchList,i=Object(n.useState)(r),s=Object(h.a)(i,2),u=s[0],m=s[1],d=l.a.useState([]),p=Object(h.a)(d,2),f=p[0],g=p[1],_=function(e){console.log("item clicked",e.target);var t=e.target.innerText;m(t)};return l.a.createElement(j.a,{open:t},l.a.createElement(Le.a,{id:"alert-dialog-title"},o),l.a.createElement(Re.a,null,l.a.createElement("div",{className:"search-wrapper"},l.a.createElement("div",{className:"search-input-wrapper"},l.a.createElement("input",{className:"search-input",type:"text",placeholder:"Search",value:u,onChange:function(e){var t=e.target.value;m(t);var a=c.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())}));g(a)}})),l.a.createElement("div",{className:"matched-list"},f.map((function(e){return l.a.createElement("div",{key:e,onClick:_},e)}))))),l.a.createElement(Ie.a,null,l.a.createElement(b.a,{onClick:function(){a(u)},color:"primary",autoFocus:!0},"Ok"),l.a.createElement(b.a,{onClick:function(){a(null)},color:"primary"},"Cancel")))}var Ut=a(217),qt=a(244),Ft=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/email",this.token=t}return Object(s.a)(e,[{key:"send",value:function(e){return console.log("sending an email",e),fetch("".concat(this.url,"?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"send_dailydigest",value:function(){return fetch("".concat(this.url,"/dailydigest?token=").concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})}}]),e}(),Bt={PaperProps:{style:{maxHeight:224,width:250}}};function Qt(e){if(!e.includes("."))return e;var t=e.split(".");return(t[0][0]+t[1][0]).toUpperCase()}function Ht(e){if(!e||""===e.trim())return"";var t=e.split(",").filter((function(e){return""!==e.trim()})),a=[];return t.forEach((function(e){var t=e.split("|");2===t.length?a.push(Qt(t[0])):a.push(t[2])})),a.join(",")}var zt=Object(f.a)((function(e){return{root:{width:"100%"},heading:{fontSize:15},expensionPanelSummary:{backgroundColor:"#f1f1f1",borderWidth:1},PlanLogList:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120}}}));function Wt(e){var t=zt(),a=e.user,o=e.planitem,r=Object(n.useContext)(Lt).qaListDispatch;console.log("==plan item==",o);var i=Object(n.useState)(o.plan),s=Object(h.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(!1),f=Object(h.a)(d,2),g=f[0],_=f[1],E=function(e){if("newstart"===e.target.name){var t=new Date(e.target.value);console.log("newstart changed, d=",t),v(e.target.name,t)}else v(e.target.name,e.target.value)},v=function(e,t){m(Object(p.a)({},u,Object(c.a)({},e,t))),_(!0)},k=Object(n.useState)(!1),y=Object(h.a)(k,2),C=y[0],j=y[1],O=function(){j(!C)},N=Object(n.useState)(!1),S=Object(h.a)(N,2),P=S[0],A=S[1],M=Object(n.useState)(!1),x=Object(h.a)(M,2),I=x[0],L=x[1],R=(Date.parse(u.newstart)-new Date)/1e3/60/60/24/30,T=Object(n.useState)(!1),Y=Object(h.a)(T,2),U=Y[0],q=Y[1],F=Object(n.useState)(!1),B=Object(h.a)(F,2),Q=B[0],H=B[1],z=Object(n.useState)(!1),W=Object(h.a)(z,2),G=W[0],J=W[1],V=u&&u.doctors&&a&&a.email&&u.doctors.toLowerCase().includes(a.email.toLowerCase())?"doctors highlight":"doctors",Z=u&&u.planners&&a&&a.email&&u.planners.toLowerCase().includes(a.email.toLowerCase())?"planners highlight":"doctors";return l.a.createElement(dt.a,{expanded:C},l.a.createElement(pt.a,{expandIcon:l.a.createElement(_t.a,null),"aria-controls":u._id+"content",id:u._id+"header",className:t.expensionPanelSummary,onClick:O},l.a.createElement("ul",{className:"heading"},l.a.createElement("li",{className:"newstart"},R<6?K.MM_DD_DAY(new Date(u.newstart)):"TBD"),l.a.createElement("li",{className:"lastname"},u.case_name.split("-")[0]),l.a.createElement("li",{className:"status"},u.status),l.a.createElement("li",{className:V},Ht(u.doctors)),l.a.createElement("li",{className:Z},Ht(u.planners)),l.a.createElement("li",{className:"tx_site"},u.tx_site),l.a.createElement("li",{className:"tx_modality"},u.modality),l.a.createElement("li",{className:"tx_machine"},u.machine),l.a.createElement("li",{className:"note"},u.note))),l.a.createElement(ht.a,null,l.a.createElement(mt.a,{container:!0,direction:"row",justify:"center",alignItems:"center"},l.a.createElement("form",{className:"plan-form",noValidate:!0},l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-casename",label:"Case",name:"case_name",value:u.case_name,InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-newstart",type:"datetime-local",label:"New Start",name:"newstart",defaultValue:K.YYYY_MM_DDTHH_MM(new Date(u.newstart)),InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-plan-status",select:!0,name:"status",label:"Status",value:u.status,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"status_not_selected",value:""}),ne&&ne.plan_status_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-plan-name",label:"Plan Name",value:u.plan_name,InputLabelProps:{shrink:!0},onClick:function(){q(!0)}})),l.a.createElement(Pt,{open:U,handleClose:function(e){console.log("handlePlanSetupSelectorDlgClose.result=======",e),null!==e&&v("plan_name",e),q(!1)},user:a,PatientId:u.case_name.split("-")[1],min_patientId_Length:8}),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-tx-modality",select:!0,label:"Modality",name:"modality",value:u.modality,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"modality_not_selected",value:""}),ne&&ne.tx_modality_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(qt.a,{id:"doctors-label"},"Doctors"),l.a.createElement(me.a,{labelId:"doctors-label",id:"doctors-checkbox-list",multiple:!0,value:u.doctors.split(","),onChange:function(e){var t=e.target.value.filter((function(e){return e.split("|").length>2}));v("doctors",t.join(","))},input:l.a.createElement(Ut.a,null),renderValue:function(e){return Ht(e.join(","))},MenuProps:Bt},ne&&ne.doctor_list.map((function(e){return l.a.createElement(Ae.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:u.doctors.includes(e.split("|")[1])}),l.a.createElement(D.a,{primary:e.split("|")[0]}))})))),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(qt.a,{id:"planners-label"},"Planners"),l.a.createElement(me.a,{labelId:"planners-label",id:"planners-checkbox-list",multiple:!0,value:u.planners.split(","),onChange:function(e){var t=e.target.value.filter((function(e){return e.split("|").length>2}));v("planners",t.join(","))},input:l.a.createElement(Ut.a,null),renderValue:function(e){return Ht(e.join(","))},MenuProps:Bt},ne.planner_list.map((function(e){return l.a.createElement(Ae.a,{key:e,value:e},l.a.createElement(Ke.a,{checked:u.planners.includes(e.split("|")[1])}),l.a.createElement(D.a,{primary:e.split("|")[0]}))})))),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-tx-site",label:"Tx Site",name:"tx_site",value:u.tx_site,onChange:E,onClick:function(){return J(!0)},InputLabelProps:{shrink:!0},InputProps:{disabled:!0}})),l.a.createElement(Yt,{open:G,handleClose:function(e){e&&v("tx_site",e),J(!1)},title:"Treatment Site",initialValue:u.tx_site,searchList:ne.tx_site_list}),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-sim-date",type:"date",label:"Sim",name:"sim",defaultValue:K.YYYY_MM_DD(new Date(u.sim.replace("Z",""))),InputLabelProps:{shrink:!0},onChange:E})),l.a.createElement(ue.a,{className:t.formControl},l.a.createElement(Ee.a,{className:"text-field-machine",select:!0,name:"machine",label:"Machine",value:u.machine,onChange:E,InputLabelProps:{shrink:!0},SelectProps:{native:!0}},l.a.createElement("option",{key:"machine_not_selected",value:""}),ne&&ne.machine_list.map((function(e){return l.a.createElement("option",{key:e,value:e},e)})))),l.a.createElement(ue.a,{className:t.formControl,fullWidth:!0},l.a.createElement(Ee.a,{className:"text-field-note",label:"Short Comment",name:"note",value:u.note?u.note:"",fullWidth:!0,variant:"outlined",onChange:E,InputLabelProps:{shrink:!0}}))),l.a.createElement(St,{className:t.PlanLogList,planitem:e.planitem,addlog:function(t,a){e.addlog(t,a),_(!0)},removelog:function(t,a){e.removelog(t,a),_(!0)}}))),l.a.createElement(w.a,null),l.a.createElement(ft.a,null,l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",disabled:!g,onClick:function(){e.saveplan_handler({plan:u,dirty:!1}),_(!1),O()}},"Save"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){e.duplicateplan_handler(e.planitem),O()}},"Duplicate"),l.a.createElement(b.a,{size:"small",color:"primary",variant:"outlined",onClick:function(){L(!0)}},"Delete"),l.a.createElement(Ye,{id:"delete_dialog",open:I,title:"Are you sure?",buttons:"Yes|No",handleClose:function(t){"Yes"===t&&e.deleteplan_handler(e.planitem),L(!1)}}),l.a.createElement(b.a,{id:"button_add_qa",size:"small",color:"primary",variant:"outlined",onClick:function(){H(!0)}},"Add QA"),l.a.createElement(It,{open:Q,handleClose:function(e){if(e){var t={id:Object(ae.a)(),type:e.type,plan:e.plan,result:"",requested_by:"".concat(a.name,"|").concat(a.email,"|").concat(a.userid),requested_on:new Date,completed_by:"",completed_on:null,due_on:new Date(u.newstart),plan_case_name:u.case_name,plan_case_id:u._id,machine:u.machine,notes:""};r({type:"add-item",data:t,user:a})}H(!1)},user:a,PatientId:u.case_name.split("-")[1]}),l.a.createElement(b.a,{id:"button_email_group",size:"small",color:"primary",variant:"outlined",onClick:function(){!function(e,t){console.log("email_plan====>",e);var a=(Date.parse(e.newstart)-new Date)/1e3/60/60/24/30<6?K.MM_DD_DAY(new Date(e.newstart)):"TBD",n=e.case_name,l=e.status,o=e.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),r=e.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=e.tx_site,i=e.modality,s=e.machine,u=e.note,m=[];m.push("Patient = "+n),m.push("Start Date = "+a),m.push("Status = "+l),m.push("Doctors="+o),m.push("Planners = "+r),m.push("Tx Site = "+c),m.push("Modality = "+i),m.push("Machine = "+s),m.push("Notes = "+u);var d=m.join("\n"),p={from:"radonc.physics@stonybrookmedicine.edu",to:t.email,subject:n.split("-")[0],text:d};new Ft(t.token).send(p)}(u,a)}},"Email Me"),l.a.createElement(b.a,{id:"button_view_auto_activities",size:"small",color:"primary",variant:"outlined",onClick:function(){return A(!0)}},"Activities"),l.a.createElement(Ot,{open:P,handleClose:function(){return A(!1)},object_id:u.case_name.split("-")[1],user:e.user,min_object_id_length:8})))}a(164);function Gt(e){var t=e.pagenation,a=e.setPage,n=t.page,o=t.totalCount,r=t.itemsPerPage,c=o%r>0?Math.floor(o/r)+1:Math.floor(o/r);return l.a.createElement(it.a,{className:"planlist-wrapper"},l.a.createElement("div",{className:"planlist"},e.planitems.map((function(t){return l.a.createElement(Wt,{key:t.plan._id,planitem:t,date_change_handler:e.date_change_handler,deleteplan_handler:e.deleteplan_handler,saveplan_handler:e.saveplan_handler,duplicateplan_handler:e.duplicateplan_handler,addlog:e.addlog,removelog:e.removelog,user:e.user,set_planitems_state:e.set_planitems_state})}))),l.a.createElement("div",{className:"planlist-pagenation"},l.a.createElement(xe.a,{count:c,page:n,onChange:function(e,t){a(t)}}),l.a.createElement("div",{className:"total-count"},"N=",o)))}var Jt=function(){function e(t){Object(i.a)(this,e),this.url=ne.webservice_url+"/plans",this.token=t}return Object(s.a)(e,[{key:"getAllPlans",value:function(){return fetch(this.url+"?token=".concat(this.token))}},{key:"getAllPlans_newstart_gt",value:function(e){e=encodeURIComponent(e);var t="".concat(this.url,"/newstart/gt/").concat(e,"?token=").concat(this.token);return fetch(t)}},{key:"getAllPlans_newstart_gt_lt",value:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);var a="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"?token=").concat(this.token);return fetch(a)}},{key:"getAllPlans_newstart_gt_lt_skip_limit",value:function(e,t,a,n){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n);var l="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/skip/").concat(a,"/limit/").concat(n,"?token=").concat(this.token);return fetch(l)}},{key:"getAllPlans_newstart_gt_lt_keyword_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_machines_skip_limit",value:function(e,t,a,n,l){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l);var o="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/machines/").concat(a,"/skip/").concat(n,"/limit/").concat(l,"?token=").concat(this.token);return fetch(o)}},{key:"getAllPlans_newstart_gt_lt_keyword_machines_skip_limit",value:function(e,t,a,n,l,o){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a),n=encodeURIComponent(n),l=encodeURIComponent(l),o=encodeURIComponent(o);var r="".concat(this.url,"/newstart/gt/").concat(e,"/lt/").concat(t,"/keyword/").concat(a.trim().toLowerCase(),"/machines/").concat(n,"/skip/").concat(l,"/limit/").concat(o,"?token=").concat(this.token);return fetch(r)}},{key:"getAllPlans_keyword_skip_limit",value:function(e,t,a){e=encodeURIComponent(e),t=encodeURIComponent(t),a=encodeURIComponent(a);var n="".concat(this.url,"/keyword/").concat(e.trim().toLowerCase(),"/skip/").concat(t,"/limit/").concat(a,"?token=").concat(this.token);return fetch(n)}},{key:"addPlan",value:function(e){return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(this.url+"?token=".concat(this.token),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"updatePlan",value:function(e){var t=this.url+"/"+e._id+"?token=".concat(this.token);return e.keywords="",e.keywords=Object.values(e).filter((function(e){return"string"===typeof e})).filter((function(e){return e.length>0})).filter((function(e){return e.length!=="2019-11-12T00:00:00.000Z".length})).join("|").toLowerCase(),fetch(t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}},{key:"deletePlan",value:function(e){var t=this.url+"/"+e._id;return fetch(t+"?token=".concat(this.token),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json"}})}}]),e}(),Vt=a(231);var Kt=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).showMsg=function(e,t){var n,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.setState({msgBox:(n={open:!0,title:e,msg:t},Object(c.a)(n,"msg",t),Object(c.a)(n,"error",l),n)})},a.setPage=function(e){e!==a.pagenation.page&&(a.pagenation.page=e,a.update_planlist())},a.update_planlist_internal=function(e){var t=a.state.user;if(te.log("App--\x3eupdate_planlist()"),!t||!t.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});a.setState({showProgress:!0}),t.settings&&t.settings.planq_num_of_cases_per_page&&(a.pagenation.itemsPerPage=t.settings.planq_num_of_cases_per_page),new se(a.state.user.token).getEnums().then((function(e){return e.json()})).then((function(t){a.enumList=t,a.enumList.tx_site_list.sort(),e().then((function(e){return e.json()})).then((function(e){a.pagenation.totalCount=e.totalCount;var t=e.list.map((function(e){return{plan:e,dirty:!1}}));a.setState({planitems:t,showProgress:!1})})).catch((function(e){console.error("getAllPlans failed",e),a.showMsg("Error","Failed getting planning data. Please contact the administrator.",!0)}))})).catch((function(e){console.error(),a.showMsg("Error","Failed getting the enumeration data. Please contact the administrator.",!0)}))},a.update_planlist=function(){console.log("update_planlist================>");var e=a.state.user;if(!e||!e.token)return console.log("update_planlist=>user not logged in yet"),void a.setState({planitems:[]});var t,n,l=!1;a.enumList?e.settings&&e.settings.my_machines&&(t=e.settings.my_machines.split(","),n=a.enumList.machine_list,t.length!==n.length||t.map((function(e){return e.trim()})).sort().join("")!==n.map((function(e){return e.trim()})).sort().join(""))&&(l=!0):e.settings&&e.settings.my_machines&&(l=!0);var o=e.settings&&e.settings.planq_search_keyword&&""!==e.settings.planq_search_keyword.trim()?e.settings.planq_search_keyword.trim():"";if(""!==o||l)if(""===o&&l){a.update_planlist_internal((function(){var t=K.YYYY_MM_DD(a.filter.newstart_from),n=K.YYYY_MM_DD(a.filter.newstart_to),l=e.settings.my_machines,o=a.pagenation,r=o.page,c=o.itemsPerPage,i=(r-1)*c,s=c;return new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_machines_skip_limit(t,n,l,i,s)}))}else if(""===o||l)if(""!==o&&l){a.update_planlist_internal((function(){var t=a.pagenation,n=t.page,l=t.itemsPerPage,r=(n-1)*l,c=l,i=K.YYYY_MM_DD(a.filter.newstart_from),s=K.YYYY_MM_DD(a.filter.newstart_to),u=e.settings.my_machines;return console.log("keyword===>",o),console.log("machines===>",u),new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_machines_skip_limit(i,s,o,u,r,c)}))}else console.log("Code should not reach this code block!!!");else{a.update_planlist_internal((function(){var e=a.pagenation,t=e.page,n=e.itemsPerPage,l=(t-1)*n,r=n,c=K.YYYY_MM_DD(a.filter.newstart_from),i=K.YYYY_MM_DD(a.filter.newstart_to);return console.log("keyword===>",o),new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_keyword_skip_limit(c,i,o,l,r)}))}else{a.update_planlist_internal((function(){var e=K.YYYY_MM_DD(a.filter.newstart_from),t=K.YYYY_MM_DD(a.filter.newstart_to),n=a.pagenation,l=n.page,o=n.itemsPerPage,r=(l-1)*o,c=o;return new Jt(a.state.user.token).getAllPlans_newstart_gt_lt_skip_limit(e,t,r,c)}))}},a.onclick_addplan=function(){if(a.state.user.userid){var e=new Date,t={case_name:"NA",sim:e,status:"",newstart:e,plan_name:"",planners:"",doctors:"",tx_site:"",note:"",logs:[]};a.addplan(t)}else console.log("onclick_addplan=> User not Logged In")},a.addplan=function(e){a.state.user&&a.state.user.userid?new Jt(a.state.user.token).addPlan(e).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})):console.log("onclick_addplan=> User not Logged In")},a.onclick_email_planq_list_to_me=function(){if(a.state.user.userid){var e=[];a.state.planitems.forEach((function(t){var a=t.plan,n=(Date.parse(a.newstart)-new Date)/1e3/60/60/24/30<6?K.MM_DD_DAY(new Date(a.newstart)):"TBD",l=a.case_name,o=a.status,r=a.doctors.split(",").map((function(e){return e.split("|")[0]})).join("/"),c=a.planners.split(",").map((function(e){return e.split("|")[0]})).join("/"),i=a.tx_site,s="".concat(n,"\t").concat(l,"\t").concat(o,"\t").concat(r,"\t").concat(c,"\t").concat(i);e.push(s)}));var t={from:"radonc.physics@stonybrookmedicine.edu",to:a.state.user.email,subject:"PlanQ List",text:e.join("\n")};new Ft(a.state.user.token).send(t)}else console.log("onclick_email_planq_list_to_me=> User not Logged In")},a.onclick_deleteplan=function(e){a.state.user.userid?new Jt(a.state.user.token).deletePlan(e.plan).then((function(e){return e.json()})).then((function(t){var n=a.state.planitems.filter((function(t){return t.plan._id!==e.plan._id}));a.setState({planitems:n})})):console.log("onclick_deleteplan=> User not Logged In")},a.onclick_saveplan=function(e){if(a.state.user.userid){var t=new Jt(a.state.user.token);console.log("planitem.plan=",e.plan),console.log("===============>",e.plan),t.updatePlan(e.plan).then((function(e){return e.json()})).then((function(t){e.dirty=!1,a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_saveplan=> User not Logged In")},a.onclick_duplicateplan=function(e){if(a.state.user.userid){var t={case_name:e.plan.case_name,sim:e.plan.sim,status:"",newstart:e.plan.newstart,plan_name:e.plan.plan_name,planners:e.plan.planners,doctors:e.plan.doctors,tx_site:e.plan.tx_site,machine:e.plan.machine,modality:e.plan.modality,note:e.plan.note,logs:e.plan.logs};new Jt(a.state.user.token).addPlan(t).then((function(e){return e.json()})).then((function(e){var t={plan:e,dirty:!1};a.state.planitems.unshift(t),a.state.planitems.sort((function(e,t){return new Date(e.plan.newstart)>new Date(t.plan.newstart)?1:-1})),a.setState({planitems:a.state.planitems})})).catch((function(e){console.log(e)}))}else console.log("onclick_duplicateplan=> User not Logged In")},a.addlog=function(e,t){if(te.log("addlog()"),a.state.user.userid){var n={msg:t,by:"",at:new Date};e.plan.logs.unshift(n),a.setState({planitems:a.state.planitems})}else console.log("addlog=> User not Logged In")},a.removelog=function(e,t){te.log("removelog()"),a.state.user.userid?(e.plan.logs=e.plan.logs.filter((function(e){return e.at!==t.at})),a.setState({planitems:a.state.planitems})):console.log("removelog=> User not Logged In")},a.set_filter=function(e){e&&(a.filter=e,console.log("set_filter=>",e),a.pagenation.page=1,a.update_planlist())},a.setUser=function(e){console.log("setUser()"),e&&e.token?(a.setState({user:e}),a.setPage(1),a.update_planlist()):a.setState({user:{},planitems:[]})},a.set_planitems_state=function(){a.setState({planitems:a.state.planitems})},document.querySelector("title").innerHTML="PlanQ - "+ne.site,a.state={planitems:[],user:{},showProgress:!1,msgBox:{open:!1,title:"",msg:"",error:!1}},a.pagenation={itemsPerPage:10,page:1,totalCount:0};var n=new Date,l=new Date(n.getFullYear()+2,n.getMonth(),n.getDate());return a.filter={newstart_from:n,newstart_to:l,keyword:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){te.log("App--\x3ecomponentDidMount()"),this.update_planlist()}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Tt,{user:this.state.user},l.a.createElement(ct,{onclick_addplan:this.onclick_addplan,onclick_email_planq_list_to_me:this.onclick_email_planq_list_to_me,set_filter:this.set_filter,addplan:this.addplan,user:this.state.user,setUser:this.setUser,update_planlist:this.update_planlist,filter:this.filter}),this.state.showProgress&&l.a.createElement(Vt.a,{color:"secondary"}),this.state.user&&this.state.user.userid?l.a.createElement(Gt,{planitems:this.state.planitems,date_change_handler:this.date_change_handler,deleteplan_handler:this.onclick_deleteplan,saveplan_handler:this.onclick_saveplan,duplicateplan_handler:this.onclick_duplicateplan,addlog:this.addlog,removelog:this.removelog,user:this.state.user,set_planitems_state:this.set_planitems_state,pagenation:this.pagenation,setPage:this.setPage}):l.a.createElement("h3",{className:"please-login"},"Please login (use your computer login id/pw)"),l.a.createElement(ut,null)),l.a.createElement(Ye,{open:this.state.msgBox.open,handleClose:function(){return e.setState({msgBox:{open:!1,title:"",msg:"",error:!1}})},title:this.state.msgBox.title,msg:this.state.msgBox.msg,buttons:"Ok",error:this.state.msgBox.error}))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(Kt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[136,1,2]]]);
//# sourceMappingURL=main.af8a9afa.chunk.js.map